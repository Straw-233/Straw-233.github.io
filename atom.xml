<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Straw</title>
  
  <subtitle>Straw_blog</subtitle>
  <link href="https://straw-233.github.io/atom.xml" rel="self"/>
  
  <link href="https://straw-233.github.io/"/>
  <updated>2024-11-12T11:05:50.377Z</updated>
  <id>https://straw-233.github.io/</id>
  
  <author>
    <name>Straw</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vm-master</title>
    <link href="https://straw-233.github.io/2024/11/12/vm-master/"/>
    <id>https://straw-233.github.io/2024/11/12/vm-master/</id>
    <published>2024-11-12T10:51:54.351Z</published>
    <updated>2024-11-12T11:05:50.377Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VM-master"><a href="#VM-master" class="headerlink" title="VM-master"></a>VM-master</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>â€‹ä¹‹å‰å‡ºé¢˜çš„æ—¶å€™ï¼Œæƒ³åœ¨githubä¸Šæ‰¾ä¸ªå¥½ç‚¹çš„vmæ¿å­ï¼Œä½†æ˜¯è¿™æ ·çš„èµ„æºå¥½å°‘å¥½å°‘ï¼Œå°±çœ‹åˆ°ä¸ªå¤–å›½çš„åº“å†™çš„ï¼Œæˆ‘ç”¨è¿™ä¸ªæ”¹ç¼–äº†ä¸€ä»½ç®€å•ç‚¹çš„ï¼Œå‡ºäº†2024newstaræ–°ç”Ÿèµ›çš„vmé¢˜ã€‚ï¼ˆè™½ç„¶è¢«å°ç™»éé¢„æœŸäº†ï¼Œåº”è¯¥åŠ ä¸ªå‰ååŠ å‡é¢„é˜²å•å­—èŠ‚çˆ†ç ´çš„ï¼‰</p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdint&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">VirtualMachine</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> MEM_SIZE = <span class="number">256</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> NUM_REGISTERS = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> MEMORY[MEM_SIZE] = &#123;<span class="number">0</span>&#125;; <span class="comment">// å†…å­˜</span></span><br><span class="line"><span class="type">uint8_t</span> REGISTERS[NUM_REGISTERS] = &#123;<span class="number">0</span>&#125;; <span class="comment">// å¯„å­˜å™¨</span></span><br><span class="line"><span class="type">uint8_t</span>* COMMANDS; <span class="comment">// ç¨‹åºæŒ‡ä»¤</span></span><br><span class="line"><span class="type">int</span> PC = <span class="number">0</span>; <span class="comment">// ç¨‹åºè®¡æ•°å™¨</span></span><br><span class="line"><span class="type">bool</span> ZF = <span class="literal">false</span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="type">bool</span> running = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">while</span> (running) &#123;</span><br><span class="line"><span class="type">uint8_t</span> opcode = COMMANDS[PC];</span><br><span class="line"><span class="keyword">switch</span> (opcode) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x01</span>: <span class="comment">// LOAD_IMM reg, imm</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> imm = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line">REGISTERS[reg] = imm;</span><br><span class="line">PC += <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x02</span>: <span class="comment">// LOAD_ADDR reg, addr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> addr = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line"><span class="type">uint8_t</span> reg2 = COMMANDS[PC + <span class="number">3</span>];</span><br><span class="line">REGISTERS[reg1] = MEMORY[addr+REGISTERS[reg2]];</span><br><span class="line">PC += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x03</span>: <span class="comment">// STORE_ADDR addr, reg, reg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> addr = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line"><span class="type">uint8_t</span> reg2 = COMMANDS[PC + <span class="number">3</span>];</span><br><span class="line">MEMORY[addr+REGISTERS[reg1]] = REGISTERS[reg2];</span><br><span class="line">PC += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x04</span>: <span class="comment">// ADD reg1, reg2, dest</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> reg2 = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line"><span class="type">uint8_t</span> dest = COMMANDS[PC + <span class="number">3</span>];</span><br><span class="line">REGISTERS[dest] = REGISTERS[reg1] + REGISTERS[reg2];</span><br><span class="line">PC += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x05</span>: <span class="comment">// MOD reg1, reg2, dest</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> imm = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line"><span class="type">uint8_t</span> dest = COMMANDS[PC + <span class="number">3</span>];</span><br><span class="line">REGISTERS[dest] = REGISTERS[reg1] % imm;</span><br><span class="line">PC += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x06</span>: <span class="comment">// XOR reg1, reg2, dest</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> reg2 = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line"><span class="type">uint8_t</span> dest = COMMANDS[PC + <span class="number">3</span>];</span><br><span class="line">REGISTERS[dest] = REGISTERS[reg1] ^ REGISTERS[reg2];</span><br><span class="line">PC += <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x07</span>: <span class="comment">// INC reg</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line">REGISTERS[reg]++;</span><br><span class="line">PC += <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x08</span>: <span class="comment">// CMP reg1, imm</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg1 = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> imm = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line">ZF = (REGISTERS[reg1] == imm);</span><br><span class="line">PC += <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x09</span>: <span class="comment">// JMP addr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> addr = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line">PC = addr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x0A</span>: <span class="comment">// JZ addr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> addr = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (ZF) &#123;</span><br><span class="line">PC = addr;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">PC += <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0x0B</span>: <span class="comment">// LOAD_ADDR reg, R(addr)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint8_t</span> reg = COMMANDS[PC + <span class="number">1</span>];</span><br><span class="line"><span class="type">uint8_t</span> addr = COMMANDS[PC + <span class="number">2</span>];</span><br><span class="line">REGISTERS[reg] = MEMORY[REGISTERS[addr]];</span><br><span class="line">PC += <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0xFF</span>: <span class="comment">// HALT</span></span><br><span class="line">&#123;</span><br><span class="line">running = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">std::cerr &lt;&lt; <span class="string">&quot;Unknown opcode: &quot;</span> &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(opcode) &lt;&lt; std::endl;</span><br><span class="line">running = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> array[<span class="number">128</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> __attribute__((constructor)) <span class="built_in">before_main</span>() &#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++) &#123;</span><br><span class="line">array[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">srand</span>(<span class="number">0x114514</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">127</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line"><span class="type">int</span> j = <span class="built_in">rand</span>() % (i + <span class="number">1</span>);</span><br><span class="line"><span class="type">int</span> temp = array[i];</span><br><span class="line">array[i] = array[j];</span><br><span class="line">array[j] = temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> program[] = &#123;</span><br><span class="line"><span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,           <span class="comment">// LOAD_IMM R0, 0   ; i = 0</span></span><br><span class="line"><span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x18</span>,            <span class="comment">// CMP R0, 0x18     ; æ¯”è¾ƒ i &lt; 24</span></span><br><span class="line"><span class="number">0x0A</span>, <span class="number">35</span>,                   <span class="comment">// JZ end_loop      ; å¦‚æœ i &gt;= 24ï¼Œè·³åˆ° end_loop</span></span><br><span class="line"><span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x80</span>, <span class="number">0x00</span>,     <span class="comment">// LOAD_ADDR R1, 0x80+R0  ; flag[i]</span></span><br><span class="line"><span class="number">0x04</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,     <span class="comment">// ADD R1, R0, R1   ; R1 = flag[i] + i</span></span><br><span class="line"><span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x80</span>, <span class="number">0x01</span>,     <span class="comment">// MOD R1, 128, R1  ; R1 = (flag[i] + i) % 128</span></span><br><span class="line"><span class="number">0x0B</span>, <span class="number">0x02</span>, <span class="number">0x01</span>,           <span class="comment">// LOAD_ADDR R2, R1 ; R2 = array[(flag[i] + i) % 128]</span></span><br><span class="line"><span class="number">0x06</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x02</span>,     <span class="comment">// XOR R2, R0, R2   ; R2 = R2 ^ i</span></span><br><span class="line"><span class="number">0x03</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x02</span>,     <span class="comment">// STORE_ADDR 0x80+R0, R2  ; flag[i] = R2</span></span><br><span class="line"><span class="number">0x07</span>, <span class="number">0x00</span>,                 <span class="comment">// INC R0           ; i++</span></span><br><span class="line"><span class="number">0x09</span>, <span class="number">0x03</span>,                 <span class="comment">// JMP loop         ; å›åˆ°å¾ªç¯å¼€å§‹</span></span><br><span class="line"><span class="number">0xFF</span>                        <span class="comment">// HALT             ; åœæ­¢æ‰§è¡Œ</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">VirtualMachine vm;</span><br><span class="line"></span><br><span class="line"><span class="type">uint8_t</span> flag[<span class="number">25</span>];</span><br><span class="line"><span class="type">uint8_t</span> pw[<span class="number">24</span>]=&#123;<span class="number">0x28</span>,<span class="number">0x79</span>,<span class="number">0x17</span>,<span class="number">0x4</span>,<span class="number">0xc</span>,<span class="number">0x73</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x50</span>,<span class="number">0x39</span>,<span class="number">0x7e</span>,<span class="number">0x24</span>,<span class="number">0x51</span>,<span class="number">0x17</span>,<span class="number">0x44</span>,<span class="number">0x25</span>,<span class="number">0x6</span>,<span class="number">0x70</span>,<span class="number">0x4d</span>,<span class="number">0x40</span>,<span class="number">0x79</span>,<span class="number">0x35</span>,<span class="number">0x73</span>,<span class="number">0x21</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\033[31mCongratulations on persevering until the fifth week of the Newstar CTF!!!\033[0m\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\033[32mWhether or not you can create this VM, I believe it can give you something.\033[0m\n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\033[33m\033[44mPlease input your flag:\033[0m&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%24s&quot;</span>,flag);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">getchar</span>() != <span class="string">&#x27;\n&#x27;</span>) </span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å°†æ•°ç»„å†™å…¥è™šæ‹Ÿæœºå†…å­˜</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++) &#123;</span><br><span class="line">vm.MEMORY[i] = array[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++) &#123;</span><br><span class="line">vm.MEMORY[<span class="number">128</span> + i] = flag[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vm.COMMANDS = program;  <span class="comment">// åŠ è½½ç¨‹åº</span></span><br><span class="line">vm.<span class="built_in">run</span>();               <span class="comment">// æ‰§è¡Œç¨‹åº</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> jd=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">24</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(vm.MEMORY[<span class="number">128</span> + i]==pw[i])</span><br><span class="line">&#123;</span><br><span class="line">jd++;</span><br><span class="line"><span class="comment">//printf(&quot;%déªŒè¯æˆåŠŸ\n&quot;,jd);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(jd==<span class="number">24</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;yes&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//std::cout &lt;&lt; &quot;flag[&quot; &lt;&lt; i &lt;&lt; &quot;]: 0x&quot; &lt;&lt; std::hex &lt;&lt; static_cast&lt;int&gt;(vm.MEMORY[128 + i]) &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//printf(&quot;%x,&quot;,vm.MEMORY[128 + i]);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>â€‹æƒ³è¦å‡ºéš¾ç‚¹çš„è¯å°±ç›´æ¥å¤šåŠ æŒ‡ä»¤caseï¼Œæƒ³è¦ä¸è¢«éé¢„æœŸè®°å¾—åˆ«å•å­—èŠ‚åŠ å¯†ï¼ŒåŠ å¯†ä½¿ç”¨æ¢è¡¨ã€‚VMè¿™å¨å²ï¼Œå°±åº”è¯¥è€è€å®å®å†™opcodeæ‰è¡ŒğŸ¤¯ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VM-master&quot;&gt;&lt;a href=&quot;#VM-master&quot; class=&quot;headerlink&quot; title=&quot;VM-master&quot;&gt;&lt;/a&gt;VM-master&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘</title>
    <link href="https://straw-233.github.io/2024/11/11/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/"/>
    <id>https://straw-233.github.io/2024/11/11/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/</id>
    <published>2024-11-11T10:53:32.140Z</published>
    <updated>2024-11-12T10:45:07.380Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘"><a href="#æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘" class="headerlink" title="æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘"></a>æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>â€‹        æœ€è¿‘æ‰“äº†å¥½å‡ åœºå¤§æ¯”èµ›ï¼Œæ„Ÿè§‰æ¯åœºéƒ½ä¼šæœ‰å¥‡æ€ªçš„æ¸¸æˆé€†å‘å‡ºæ¥ï¼Œæœ‰c++å†™çš„ï¼Œæœ‰pythonå†™çš„ï¼Œæœ‰c#å†™çš„ï¼Œè—flagçš„æ–¹å¼ä¹Ÿæ˜¯å¤šç§å¤šæ ·å•Šï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ï¼Œæ¥ä¸ªæ€»ç»“ä¹Ÿå½“å¤ç°èµ›é¢˜äº†ã€‚æƒ³æŠŠæ­¤ç¯‡å½“ä¸ºæ¸¸æˆé€†å‘çš„æ€»ç« ã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/%E5%A5%B6%E9%BE%99.gif" alt="å¥¶é¾™"></p><h2 id="2024å¼ºç½‘æ‹Ÿæ€-challenge"><a href="#2024å¼ºç½‘æ‹Ÿæ€-challenge" class="headerlink" title="2024å¼ºç½‘æ‹Ÿæ€-challenge"></a>2024å¼ºç½‘æ‹Ÿæ€-challenge</h2><p>â€‹ä¸€ä¸ªåƒè±†äººçš„æ¸¸æˆï¼Œgithubä¸Šæ‰¾åˆ°äº†æºç <a href="https://github.com/NJU-TJL/PacManX">NJU-TJL&#x2F;PacManX: åŸºäºC++æ§åˆ¶å°ï¼ˆWindowså¹³å°ï¼‰çš„ä¸€ä¸ªåƒè±†äººå°æ¸¸æˆ</a>ã€‚å¾ˆç²¾å¦™çš„è®¾è®¡ï¼Œå»äº†ç¬¦å·è¡¨ï¼Œå¢åŠ æ•´ä¸ªæ¸¸æˆé€†å‘çš„éš¾åº¦ï¼Œè¯¥é¢˜ä¸æ˜¯æ­£å¸¸çš„é€šå…³æ¸¸æˆç»™flagçš„é‚£ç§ï¼Œå°†å…³é”®ç‚¹è—åˆ°äº†é€€å‡ºå‡½æ•°é‚£ï¼Œä¹Ÿæ˜¯æˆ‘ç©ç€ç©ç€å‘ç°çš„ã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/1.png" alt="1"></p><p>ç›´æ¥å¯¹exitå‡½æ•°è¿›è¡Œç´¢å¼•æ‰¾å…³é”®å‡½æ•°</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/2.png" alt="2"></p><p>åˆšå¥½å¯¹åº”çš„æ˜¯è¯»å…¥escé”®ç„¶åæ‰§è¡Œsub_140014EB5();ç„¶åé€€å‡º</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/4.png" alt="4"></p><p>è¿™é‡Œé¢æœ‰ä¸ªæ˜æ˜¾çš„å­—ç¬¦ä¸²æ··æ·†ï¼Œé˜²æ­¢è¢«F12ç›´æ¥ç´¢å¼•åˆ°</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/5.png" alt="5"></p><p>æ•´ä½“é‡æ–°åˆ†æä¸€ä¸‹å°±æ˜¯</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/6.png" alt="6"></p><p>â€‹å¾ˆæ¸…æ™°äº†ï¼Œåœ¨ä½ çš„æ³¨å†Œè¡¨é‡Œè¯»flagï¼Œç„¶åå¯¹.dataæ–‡ä»¶è¿›è¡Œè§£å¯†æˆä¸ºä¸€ä¸ªps1ï¼Œæ‰§è¡Œååˆ é™¤</p><p>â€‹é‚£æˆ‘å…ˆæŠŠflagå†™æ³¨å†Œè¡¨é‡Œï¼Œç„¶ååˆ›ä¸ªgame.ps1æ–‡ä»¶ï¼Œè®¾ç½®æƒé™ä¸å¯æ‰§è¡Œä¸å¯è¯»ï¼Œåªèƒ½å†™å…¥ï¼Œè¿™æ ·è¿è¡Œåœ¨åˆ é™¤å‰å°±ä¼šæŠ¥é”™ï¼Œç•™ä¸‹ä¸€ä¸ªgame.tmp</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/7.png" alt="7"></p><p>ç”¨powerdecodeå»æ··æ·†</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">Layer <span class="number">4</span> - Plainscript</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$plaintextBytes</span>,</span><br><span class="line">        <span class="variable">$keyBytes</span></span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># Initialize S and KSA</span></span><br><span class="line">    <span class="variable">$S</span> = <span class="number">0</span>..<span class="number">255</span></span><br><span class="line">    <span class="variable">$j</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="number">256</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$j</span> = (<span class="variable">$j</span> + <span class="variable">$S</span>[<span class="variable">$i</span>] + <span class="variable">$keyBytes</span>[<span class="variable">$i</span> % <span class="variable">$keyBytes</span><span class="type">.Length</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$temp</span> = <span class="variable">$S</span>[<span class="variable">$i</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$i</span>] = <span class="variable">$S</span>[<span class="variable">$j</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$j</span>] = <span class="variable">$temp</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PRGA and encryption</span></span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$j</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">$ciphertextBytes</span> = <span class="selector-tag">@</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$plaintextBytes</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$i</span> = (<span class="variable">$i</span> + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$j</span> = (<span class="variable">$j</span> + <span class="variable">$S</span>[<span class="variable">$i</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$temp</span> = <span class="variable">$S</span>[<span class="variable">$i</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$i</span>] = <span class="variable">$S</span>[<span class="variable">$j</span>]</span><br><span class="line">        <span class="variable">$S</span>[<span class="variable">$j</span>] = <span class="variable">$temp</span></span><br><span class="line">        <span class="variable">$t</span> = (<span class="variable">$S</span>[<span class="variable">$i</span>] + <span class="variable">$S</span>[<span class="variable">$j</span>]) % <span class="number">256</span></span><br><span class="line">        <span class="variable">$ciphertextBytes</span> += (<span class="variable">$plaintextBytes</span>[<span class="variable">$k</span>] <span class="operator">-bxor</span> <span class="variable">$S</span>[<span class="variable">$t</span>])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Return ciphertext as a string</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ciphertextBytes</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene1</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x6f, <span class="number">0</span>x77, <span class="number">0</span>x65, <span class="number">0</span>x72)</span><br><span class="line">    <span class="variable">$encryptedText</span> = <span class="selector-tag">@</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$encryptedText</span> = enenenenene <span class="literal">-plaintextBytes</span> <span class="variable">$inputbyte</span> <span class="literal">-keyBytes</span> <span class="variable">$key</span>;</span><br><span class="line">        <span class="variable">$key</span> = enenenenene <span class="literal">-plaintextBytes</span> <span class="variable">$key</span> <span class="literal">-keyBytes</span> <span class="variable">$encryptedText</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$encryptedText</span> + <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene2</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x30, <span class="number">0</span>x77, <span class="number">0</span>x65, <span class="number">0</span>x72)</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] = <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] + <span class="variable">$key</span>[<span class="variable">$k</span> % <span class="variable">$key</span><span class="type">.Length</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$inputbyte</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">enenenenene3</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(</span><br><span class="line">        <span class="variable">$inputbyte</span></span><br><span class="line">    )</span><br><span class="line">    <span class="variable">$key</span> = <span class="selector-tag">@</span>(<span class="number">0</span>x70, <span class="number">0</span>x30, <span class="number">0</span>x77, <span class="number">0</span>x33, <span class="number">0</span>x72)</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$inputbyte</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] = <span class="variable">$inputbyte</span>[<span class="variable">$k</span>] * <span class="variable">$key</span>[<span class="variable">$k</span> % <span class="variable">$key</span><span class="type">.Length</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$inputbyte</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$registryPath</span> = <span class="string">&#x27;HKCU:\Software\PacManX&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$valueName</span> = <span class="string">&#x27;MYFLAG&#x27;</span></span><br><span class="line"><span class="variable">$value</span> = <span class="built_in">Get-ItemPropertyValue</span> <span class="variable">$registryPath</span> <span class="variable">$valueName</span></span><br><span class="line"><span class="variable">$plaintext</span> = <span class="selector-tag">@</span>(<span class="variable">$value</span>) | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_</span></span><br><span class="line">    <span class="variable">$plaintext</span> = <span class="selector-tag">@</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> <span class="operator">-lt</span> <span class="variable">$input</span>.Length; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$plaintext</span> += [<span class="built_in">int</span>][<span class="built_in">char</span>]<span class="variable">$input</span>[<span class="variable">$i</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$plaintext</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$plaintext</span>.Length <span class="operator">-ne</span> <span class="number">36</span>) &#123;</span><br><span class="line">    <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line">    <span class="keyword">exit</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$encrypted1Text</span> = enENenenene2 <span class="literal">-inputbyte</span> (enenenENene2 <span class="literal">-inputbyte</span> (enenenenene3 <span class="literal">-inputbyte</span> (Enenenenene2 <span class="literal">-inputbyte</span> (enenenenene2 <span class="literal">-inputbyte</span> (enenenenene2 <span class="literal">-inputbyte</span> (enenenenene1 <span class="literal">-input</span> <span class="variable">$plaintext</span>))))))</span><br><span class="line"><span class="variable">$result</span> = <span class="selector-tag">@</span>(<span class="number">38304</span>, <span class="number">8928</span>, <span class="number">43673</span>, <span class="number">25957</span> , <span class="number">67260</span>, <span class="number">47152</span>, <span class="number">16656</span>, <span class="number">62832</span> , <span class="number">19480</span> , <span class="number">66690</span>, <span class="number">40432</span>, <span class="number">15072</span> , <span class="number">63427</span> , <span class="number">28558</span> , <span class="number">54606</span>, <span class="number">47712</span> , <span class="number">18240</span> , <span class="number">68187</span> , <span class="number">18256</span>, <span class="number">63954</span> , <span class="number">48384</span>, <span class="number">14784</span>, <span class="number">60690</span> , <span class="number">21724</span> , <span class="number">53238</span> , <span class="number">64176</span> , <span class="number">9888</span> , <span class="number">54859</span> , <span class="number">23050</span> , <span class="number">58368</span> , <span class="number">46032</span> , <span class="number">15648</span> , <span class="number">64260</span> , <span class="number">17899</span> , <span class="number">52782</span> , <span class="number">51968</span> , <span class="number">12336</span> , <span class="number">69377</span> , <span class="number">27844</span> , <span class="number">43206</span> , <span class="number">63616</span>)</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">0</span>; <span class="variable">$k</span> <span class="operator">-lt</span> <span class="variable">$result</span>.Length; <span class="variable">$k</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$encrypted1Text</span>[<span class="variable">$k</span>] <span class="operator">-ne</span> <span class="variable">$result</span>[<span class="variable">$k</span>]) &#123;</span><br><span class="line">        <span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line">        <span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Set-Content</span> <span class="literal">-Path</span> <span class="string">&quot;log.txt&quot;</span> <span class="literal">-Value</span> <span class="string">&quot;RIGHT&quot;</span></span><br></pre></td></tr></table></figure><p>rc4+ç®€å•ä¹˜åŠ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">pw=[<span class="number">38304</span>, <span class="number">8928</span>, <span class="number">43673</span>, <span class="number">25957</span> , <span class="number">67260</span>, <span class="number">47152</span>, <span class="number">16656</span>, <span class="number">62832</span> , <span class="number">19480</span> , <span class="number">66690</span>, <span class="number">40432</span>, <span class="number">15072</span> , <span class="number">63427</span> , <span class="number">28558</span> , <span class="number">54606</span>, <span class="number">47712</span> , <span class="number">18240</span> , <span class="number">68187</span> , <span class="number">18256</span>, <span class="number">63954</span> , <span class="number">48384</span>, <span class="number">14784</span>, <span class="number">60690</span> , <span class="number">21724</span> , <span class="number">53238</span> , <span class="number">64176</span> , <span class="number">9888</span> , <span class="number">54859</span> , <span class="number">23050</span> , <span class="number">58368</span> , <span class="number">46032</span> , <span class="number">15648</span> , <span class="number">64260</span> , <span class="number">17899</span> , <span class="number">52782</span> , <span class="number">51968</span> , <span class="number">12336</span> , <span class="number">69377</span> , <span class="number">27844</span> , <span class="number">43206</span> , <span class="number">63616</span>]</span><br><span class="line">key=[<span class="number">0x70</span>, <span class="number">0x6f</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>]</span><br><span class="line">key1=[<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x65</span>, <span class="number">0x72</span>]</span><br><span class="line">key2=[<span class="number">0x70</span>, <span class="number">0x30</span>, <span class="number">0x77</span>, <span class="number">0x33</span>, <span class="number">0x72</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pw)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>((pw[i]-<span class="number">2</span>*key1[i%<span class="number">5</span>])/key2[i%<span class="number">5</span>])-<span class="number">3</span>*key1[i%<span class="number">5</span>]),end=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pw2=[<span class="number">0x4</span>,<span class="number">0x28</span>,<span class="number">0x8</span>,<span class="number">0xca</span>,<span class="number">0xf6</span>,<span class="number">0x53</span>,<span class="number">0xc9</span>,<span class="number">0xa9</span>,<span class="number">0x4b</span>,<span class="number">0xf1</span>,<span class="number">0x17</span>,<span class="number">0xa8</span>,<span class="number">0xae</span>,<span class="number">0xfd</span>,<span class="number">0x87</span>,<span class="number">0x58</span>,<span class="number">0xea</span>,<span class="number">0xd6</span>,<span class="number">0x33</span>,<span class="number">0xd9</span>,<span class="number">0x5e</span>,<span class="number">0xa2</span>,<span class="number">0x97</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xeb</span>,<span class="number">0x3c</span>,<span class="number">0x66</span>,<span class="number">0x91</span>,<span class="number">0xa8</span>,<span class="number">0x49</span>,<span class="number">0xb4</span>,<span class="number">0xb5</span>,<span class="number">0x2c</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>]</span><br><span class="line">key3=[<span class="number">0x6f</span>,<span class="number">0xe0</span>,<span class="number">0xef</span>,<span class="number">0x23</span>,<span class="number">0xe6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4</span>(<span class="params">key, data</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % key_length]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i] </span><br><span class="line"></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    output = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i] </span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        output.append(byte ^ S[t]) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pw2))</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">    key3=rc4(pw2,key3)</span><br><span class="line">    pw2=rc4(key3,pw2)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> key3:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>()  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> pw2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#73412036-7d8c-437b-9026-0c2ca1b7f79d</span></span><br></pre></td></tr></table></figure><h2 id="2024å¼ºç½‘æ¯-æ–¯å†…å…‹"><a href="#2024å¼ºç½‘æ¯-æ–¯å†…å…‹" class="headerlink" title="2024å¼ºç½‘æ¯-æ–¯å†…å…‹"></a>2024å¼ºç½‘æ¯-æ–¯å†…å…‹</h2><p>ä¸€é“ç”¨cè¯­è¨€å®ç°çš„ç®€å•çš„è´ªåƒè›‡ï¼Œæ²¡æ‰¾åˆ°æºç ï¼Œä½†æ˜¯å¾ˆç®€å•ï¼Œæ„Ÿè§‰æ˜¯å‡ºé¢˜äººè‡ªå·±å†™çš„ã€‚å…¶å®åˆ°å¤´æ¥æ˜¯ä¸ªsmcã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/1.1.png" alt="1.1"></p><p>ç®€å•åˆ†æå®Œä¸»å‡½æ•°æµç¨‹ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹ sub_1400111FE(ï¼‰  å’Œsub_14001112C(); </p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/1.2.png" alt="1.2"></p><p>æœ€ä¸Šé¢ä¼šåˆ¤æ–­ä½ çš„é”®ç›˜è¾“å…¥æœ‰æ²¡æœ‰å˜ï¼Œæ¥å†³å®šæ˜¯å¦è¿›è¡Œä¸‹é¢æ“ä½œï¼Œç„¶åä¸‹é¢ä¼šæ ¹æ®ä½ é”®ç›˜ä¸åŒçš„è¾“å…¥ï¼Œè¿›è¡Œsmcæ®µä¸åŒçš„æ“ä½œã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/1.3.png" alt="1.3"></p><p>ç„¶åçœ‹å¦ä¸€ä¸ªå‡½æ•°çš„å¦å¤–ä¸€æ®µ</p><p>è¿™è¾¹ä¼šå¯¹smcçš„é‚£æ®µä»£ç è¿›è¡Œæ ¡éªŒï¼Œæ¯æ¬¡åƒåˆ°æœå­å¯¹æ¯”md5çš„å€¼ï¼Œå½“è¿˜åŸæˆæ­£ç¡®çš„ä»£ç æ®µåï¼Œä½œä¸ºä¸€ä¸ªå‡½æ•°å¯¹æœ€å¼€å§‹ä½ çš„è¾“å…¥è¿›è¡Œæ“ä½œã€‚ä½†æ˜¯md5ä¸å¯é€†ï¼Œä½œè€…ä¹Ÿç»™å‡ºäº†è¦æˆ‘ä»¬æ±‚æœ€ä¼˜è·¯å¾„ï¼Œæ“ä½œæ•°æœ€å°‘ï¼Œæœå­çš„ä½ç½®å‡ºç°ä¹Ÿæ˜¯ä¸ªä¼ªéšæœºï¼Œæ‰€ä»¥å°±æ˜¯ä¸€é“ç®—æ³•é¢˜ã€‚ç®—æ³•ä¸ä¼šä¸€ç‚¹ï¼Œcpä¸€ä¸‹carboçš„ä»£ç ï¼Œè™½ç„¶ä»–ä¹Ÿæ˜¯chatçš„ã€‚[æ‚å˜´ç¬‘]</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;bits/stdc++.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;md5.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;defs.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">    UP,     <span class="comment">// W</span></span><br><span class="line">    DOWN,   <span class="comment">// S</span></span><br><span class="line">    LEFT,   <span class="comment">// A</span></span><br><span class="line">    RIGHT   <span class="comment">// D</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">State</span> &#123;</span><br><span class="line">    <span class="type">int</span> x, y;           <span class="comment">// è›‡å¤´ä½ç½®</span></span><br><span class="line">    Direction dir;      <span class="comment">// å½“å‰æ–¹å‘</span></span><br><span class="line">    string path;        <span class="comment">// è·¯å¾„</span></span><br><span class="line">    <span class="type">int</span> fruitIndex;     <span class="comment">// å½“å‰è¦åƒçš„æœå­ç´¢å¼•</span></span><br><span class="line">    <span class="type">int</span> steps;          <span class="comment">// æ­¥æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">State</span>(<span class="type">int</span> x, <span class="type">int</span> y, Direction d, string p, <span class="type">int</span> f, <span class="type">int</span> s)</span><br><span class="line">            : <span class="built_in">x</span>(x), <span class="built_in">y</span>(y), <span class="built_in">dir</span>(d), <span class="built_in">path</span>(p), <span class="built_in">fruitIndex</span>(f), <span class="built_in">steps</span>(s) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> State&amp; other) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x != other.x) <span class="keyword">return</span> x &lt; other.x;</span><br><span class="line">        <span class="keyword">if</span> (y != other.y) <span class="keyword">return</span> y &lt; other.y;</span><br><span class="line">        <span class="keyword">if</span> (dir != other.dir) <span class="keyword">return</span> dir &lt; other.dir;</span><br><span class="line">        <span class="keyword">return</span> fruitIndex &lt; other.fruitIndex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SnakePathFinder</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> SIZE = <span class="number">20</span>;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; fruits;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; x &lt; SIZE &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; SIZE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Direction <span class="title">getOppositeDirection</span><span class="params">(Direction dir)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> UP: <span class="keyword">return</span> DOWN;</span><br><span class="line">            <span class="keyword">case</span> DOWN: <span class="keyword">return</span> UP;</span><br><span class="line">            <span class="keyword">case</span> LEFT: <span class="keyword">return</span> RIGHT;</span><br><span class="line">            <span class="keyword">case</span> RIGHT: <span class="keyword">return</span> LEFT;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> UP;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">char</span> <span class="title">getDirectionChar</span><span class="params">(Direction dir)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> UP: <span class="keyword">return</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> DOWN: <span class="keyword">return</span> <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> LEFT: <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">            <span class="keyword">case</span> RIGHT: <span class="keyword">return</span> <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;W&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">moveInDirection</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, Direction dir)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span>(dir) &#123;</span><br><span class="line">            <span class="keyword">case</span> UP: <span class="keyword">return</span> &#123;x<span class="number">-1</span>, y&#125;;</span><br><span class="line">            <span class="keyword">case</span> DOWN: <span class="keyword">return</span> &#123;x+<span class="number">1</span>, y&#125;;</span><br><span class="line">            <span class="keyword">case</span> LEFT: <span class="keyword">return</span> &#123;x, y<span class="number">-1</span>&#125;;</span><br><span class="line">            <span class="keyword">case</span> RIGHT: <span class="keyword">return</span> &#123;x, y+<span class="number">1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;x, y&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼˜åŒ–åçš„å¯å‘å¼ä¼°è®¡å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">estimateRemainingSteps</span><span class="params">(<span class="type">const</span> State&amp; state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (state.fruitIndex &gt;= fruits.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> totalEstimate = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> currentX = state.x;</span><br><span class="line">        <span class="type">int</span> currentY = state.y;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—åˆ°æ‰€æœ‰å‰©ä½™æœå­çš„æœ€å°è·ç¦»ä¹‹å’Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = state.fruitIndex; i &lt; fruits.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="type">int</span> dx = <span class="built_in">abs</span>(currentX - fruits[i].first);</span><br><span class="line">            <span class="type">int</span> dy = <span class="built_in">abs</span>(currentY - fruits[i].second);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è€ƒè™‘è½¬å‘çš„ä»£ä»·</span></span><br><span class="line">            <span class="keyword">if</span> (i == state.fruitIndex) &#123;</span><br><span class="line">                <span class="type">bool</span> needHorizontalMove = (currentY != fruits[i].second);</span><br><span class="line">                <span class="type">bool</span> needVerticalMove = (currentX != fruits[i].first);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (needHorizontalMove &amp;&amp; needVerticalMove) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœéœ€è¦åŒæ—¶åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ç§»åŠ¨ï¼Œè‡³å°‘éœ€è¦ä¸€æ¬¡è½¬å‘</span></span><br><span class="line">                    <span class="keyword">if</span> ((state.dir == LEFT || state.dir == RIGHT) &amp;&amp; needVerticalMove) &#123;</span><br><span class="line">                        totalEstimate += <span class="number">1</span>;  <span class="comment">// è€ƒè™‘è½¬å‘çš„ä»£ä»·</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> ((state.dir == UP || state.dir == DOWN) &amp;&amp; needHorizontalMove) &#123;</span><br><span class="line">                        totalEstimate += <span class="number">1</span>;  <span class="comment">// è€ƒè™‘è½¬å‘çš„ä»£ä»·</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            totalEstimate += dx + dy;  <span class="comment">// æ›¼å“ˆé¡¿è·ç¦»</span></span><br><span class="line">            currentX = fruits[i].first;</span><br><span class="line">            currentY = fruits[i].second;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> totalEstimate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">SnakePathFinder</span>(<span class="type">const</span> vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&amp; fruitSequence) &#123;</span><br><span class="line">        fruits = fruitSequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">findOptimalPath</span><span class="params">(<span class="type">int</span> startX, <span class="type">int</span> startY, Direction startDir)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ŒæŒ‰ç…§ä¼°è®¡çš„æ€»æ­¥æ•°æ’åº</span></span><br><span class="line">        <span class="keyword">auto</span> cmp = [](<span class="type">const</span> State&amp; a, <span class="type">const</span> State&amp; b) &#123;</span><br><span class="line">            <span class="built_in">return</span> (a.steps + a.path.<span class="built_in">length</span>()) &gt; (b.steps + b.path.<span class="built_in">length</span>());</span><br><span class="line">        &#125;;</span><br><span class="line">        priority_queue&lt;State, vector&lt;State&gt;, <span class="keyword">decltype</span>(cmp)&gt; <span class="built_in">pq</span>(cmp);</span><br><span class="line"></span><br><span class="line">        set&lt;State&gt; visited;</span><br><span class="line">        <span class="function">State <span class="title">initial</span><span class="params">(startX, startY, startDir, <span class="string">&quot;&quot;</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        pq.<span class="built_in">push</span>(initial);</span><br><span class="line">        visited.<span class="built_in">insert</span>(initial);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            State current = pq.<span class="built_in">top</span>();</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœæ‰€æœ‰æœå­éƒ½è¢«åƒæ‰</span></span><br><span class="line">            <span class="keyword">if</span>(current.fruitIndex &gt;= fruits.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> current.path;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœåˆ°è¾¾å½“å‰ç›®æ ‡æœå­</span></span><br><span class="line">            <span class="keyword">if</span>(current.x == fruits[current.fruitIndex].first &amp;&amp;</span><br><span class="line">               current.y == fruits[current.fruitIndex].second) &#123;</span><br><span class="line">                State nextState = current;</span><br><span class="line">                nextState.fruitIndex++;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(visited.<span class="built_in">find</span>(nextState) == visited.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                    pq.<span class="built_in">push</span>(nextState);</span><br><span class="line">                    visited.<span class="built_in">insert</span>(nextState);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°è¯•æ‰€æœ‰å¯èƒ½çš„æ–¹å‘</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">                Direction newDir = <span class="built_in">static_cast</span>&lt;Direction&gt;(i);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ä¸èƒ½ç›´æ¥è°ƒå¤´</span></span><br><span class="line">                <span class="keyword">if</span>(newDir == <span class="built_in">getOppositeDirection</span>(current.dir)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">auto</span> [newX, newY] = <span class="built_in">moveInDirection</span>(current.x, current.y, newDir);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(!<span class="built_in">isValid</span>(newX, newY)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                string newPath = current.path;</span><br><span class="line">                <span class="keyword">if</span>(newDir != current.dir) &#123;</span><br><span class="line">                    newPath += <span class="built_in">getDirectionChar</span>(newDir);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="function">State <span class="title">newState</span><span class="params">(newX, newY, newDir, newPath,</span></span></span><br><span class="line"><span class="params"><span class="function">                               current.fruitIndex, current.steps + <span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(visited.<span class="built_in">find</span>(newState) == visited.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                    pq.<span class="built_in">push</span>(newState);</span><br><span class="line">                    visited.<span class="built_in">insert</span>(newState);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No path found&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> map_data_orig[<span class="number">1152</span>] = &#123;</span><br><span class="line">        <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0xB0</span>, <span class="number">0x38</span>, <span class="number">0x6D</span>,</span><br><span class="line">        <span class="number">0xEE</span>, <span class="number">0x3F</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xF0</span>, <span class="number">0x38</span>, <span class="number">0x2C</span>, <span class="number">0x79</span>, <span class="number">0xF6</span>, <span class="number">0x34</span>, <span class="number">0xE9</span>, <span class="number">0x89</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0xAC</span>, <span class="number">0x7F</span>, <span class="number">0x35</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x6D</span>, <span class="number">0x77</span>, <span class="number">0xF6</span>, <span class="number">0xB6</span>, <span class="number">0x38</span>, <span class="number">0x6D</span>, <span class="number">0x78</span>, <span class="number">0xF6</span>, <span class="number">0xB6</span>,</span><br><span class="line">        <span class="number">0x2B</span>, <span class="number">0x18</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3B</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0xEF</span>, <span class="number">0x4E</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0x7D</span>, <span class="number">0xF6</span>,</span><br><span class="line">        <span class="number">0x33</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0xE8</span>, <span class="number">0xF6</span>, <span class="number">0x2B</span>, <span class="number">0x27</span>,</span><br><span class="line">        <span class="number">0xA3</span>, <span class="number">0x1D</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x38</span>, <span class="number">0x89</span>,</span><br><span class="line">        <span class="number">0xE3</span>, <span class="number">0xC3</span>, <span class="number">0xCA</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xC4</span>, <span class="number">0xB0</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0xB3</span>, <span class="number">0x67</span>, <span class="number">0xE3</span>, <span class="number">0x16</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xD4</span>, <span class="number">0xB0</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>,</span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0xB6</span>, <span class="number">0xD3</span>, <span class="number">0xB6</span>, <span class="number">0xA9</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xE4</span>, <span class="number">0xB0</span>, <span class="number">0xF8</span>,</span><br><span class="line">        <span class="number">0x04</span>, <span class="number">0x38</span>, <span class="number">0x89</span>, <span class="number">0xD8</span>, <span class="number">0xC7</span>, <span class="number">0x33</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xB4</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0xED</span>, <span class="number">0xB5</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xC4</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xC4</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0xED</span>, <span class="number">0xB5</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xD4</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0xED</span>, <span class="number">0xB5</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xE4</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xE4</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0xED</span>, <span class="number">0xB5</span>, <span class="number">0xD4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0xFE</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0x6F</span>, <span class="number">0x14</span>, <span class="number">0x4C</span>, <span class="number">0xEC</span>, <span class="number">0xFE</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x2F</span>, <span class="number">0xC0</span>, <span class="number">0x2C</span>, <span class="number">0xEC</span>, <span class="number">0xFE</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xCC</span>, <span class="number">0x6C</span>, <span class="number">0xFE</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB6</span>, <span class="number">0x24</span>, <span class="number">0xCC</span>, <span class="number">0x72</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xB4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xC4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0xD2</span>, <span class="number">0xF4</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>, <span class="number">0xC4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF9</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>,</span><br><span class="line">        <span class="number">0xC4</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xE9</span>, <span class="number">0xF4</span>, <span class="number">0xCC</span>, <span class="number">0xE2</span>, <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0xED</span>,</span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0xF8</span>, <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x04</span>,</span><br><span class="line">        <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xB4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>,</span><br><span class="line">        <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF6</span>, <span class="number">0x4C</span>, <span class="number">0x69</span>, <span class="number">0xF4</span>, <span class="number">0xE4</span>, <span class="number">0x40</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xC4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0xD2</span>, <span class="number">0xF4</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF9</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xE9</span>, <span class="number">0xF4</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0xCC</span>, <span class="number">0xE2</span>, <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0xE1</span>,</span><br><span class="line">        <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0xED</span>, <span class="number">0x38</span>, <span class="number">0xF8</span>, <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>,</span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xC4</span>, <span class="number">0x2C</span>,</span><br><span class="line">        <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>, <span class="number">0x00</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x6F</span>, <span class="number">0x14</span>, <span class="number">0x4C</span>, <span class="number">0xEC</span>, <span class="number">0x00</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x2F</span>, <span class="number">0xC0</span>, <span class="number">0x2C</span>, <span class="number">0xEC</span>, <span class="number">0x00</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0x6C</span>, <span class="number">0x00</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB6</span>, <span class="number">0x24</span>, <span class="number">0xCC</span>, <span class="number">0x72</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xD4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>,</span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0xD2</span>, <span class="number">0xF4</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>,</span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x4A</span>, <span class="number">0xE1</span>, <span class="number">0xE4</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xE9</span>, <span class="number">0xF4</span>, <span class="number">0xCC</span>, <span class="number">0xE2</span>, <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>,</span><br><span class="line">        <span class="number">0xF9</span>, <span class="number">0xED</span>, <span class="number">0x38</span>, <span class="number">0xF8</span>, <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0xE4</span>,</span><br><span class="line">        <span class="number">0x79</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>,</span><br><span class="line">        <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF6</span>, <span class="number">0x4C</span>, <span class="number">0x69</span>, <span class="number">0xF4</span>, <span class="number">0xE4</span>, <span class="number">0x40</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0x3B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xE4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>,</span><br><span class="line">        <span class="number">0xD4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0xD2</span>, <span class="number">0xF4</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xE1</span>,</span><br><span class="line">        <span class="number">0xD4</span>, <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x04</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0x5B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x4A</span>, <span class="number">0xE1</span>, <span class="number">0xD4</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x05</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xE9</span>, <span class="number">0xF4</span>, <span class="number">0xD0</span>, <span class="number">0x62</span>, <span class="number">0x64</span>, <span class="number">0xCC</span>, <span class="number">0xE2</span>, <span class="number">0xE4</span>,</span><br><span class="line">        <span class="number">0x4C</span>, <span class="number">0xE1</span>, <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0xED</span>, <span class="number">0x38</span>, <span class="number">0xF8</span>, <span class="number">0x4C</span>, <span class="number">0xE8</span>, <span class="number">0xF4</span>, <span class="number">0xF8</span>, <span class="number">0xE4</span>, <span class="number">0xE0</span>, <span class="number">0xA8</span>, <span class="number">0x4C</span>, <span class="number">0xC1</span>,</span><br><span class="line">        <span class="number">0xE3</span>, <span class="number">0x60</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>,</span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x52</span>, <span class="number">0x54</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0x2F</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>,</span><br><span class="line">        <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xB4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>,</span><br><span class="line">        <span class="number">0x4C</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0xE3</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xB4</span>, <span class="number">0x2C</span>,</span><br><span class="line">        <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xC4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xE4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0xE3</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xC4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xE4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xB4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>,</span><br><span class="line">        <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0xE3</span>, <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>,</span><br><span class="line">        <span class="number">0xE4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x3B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0xC0</span>, <span class="number">0xC4</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0x4C</span>, <span class="number">0x79</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0x4C</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0xE3</span>,</span><br><span class="line">        <span class="number">0xD0</span>, <span class="number">0x2B</span>, <span class="number">0xF4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x38</span>, <span class="number">0x4A</span>, <span class="number">0x50</span>, <span class="number">0xD4</span>, <span class="number">0x2C</span>, <span class="number">0xF8</span>, <span class="number">0x85</span>, <span class="number">0x37</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>,</span><br><span class="line">        <span class="number">0x42</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3D</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x52</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xBE</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x62</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x51</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x6F</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3D</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x7F</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0x5B</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x12</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x8D</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x22</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x65</span>, <span class="number">0xA0</span>,</span><br><span class="line">        <span class="number">0xEC</span>, <span class="number">0x32</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xA7</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xBF</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x4D</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xCF</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xAC</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xDF</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xF8</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xEF</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0xB4</span>, <span class="number">0x06</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xFF</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xE9</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x8F</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x3B</span>,</span><br><span class="line">        <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0x9F</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xA3</span>, <span class="number">0xA0</span>, <span class="number">0xEC</span>, <span class="number">0xAF</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x31</span>, <span class="number">0xB0</span>, <span class="number">0xEC</span>,</span><br><span class="line">        <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x6F</span>, <span class="number">0x14</span>, <span class="number">0x4C</span>, <span class="number">0xEC</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>,</span><br><span class="line">        <span class="number">0x2F</span>, <span class="number">0xC0</span>, <span class="number">0x2C</span>, <span class="number">0xEC</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xCC</span>, <span class="number">0x6C</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB5</span>, <span class="number">0x68</span>,</span><br><span class="line">        <span class="number">0xE6</span>, <span class="number">0x38</span>, <span class="number">0xCA</span>, <span class="number">0xEC</span>, <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x24</span>, <span class="number">0x1B</span>, <span class="number">0xF8</span>, <span class="number">0x04</span>, <span class="number">0x37</span>, <span class="number">0x38</span>, <span class="number">0xCA</span>, <span class="number">0x6D</span>,</span><br><span class="line">        <span class="number">0xF5</span>, <span class="number">0xC4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x24</span>, <span class="number">0x1B</span>, <span class="number">0x7D</span>, <span class="number">0x85</span>, <span class="number">0x42</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0xB4</span>, <span class="number">0x63</span>, <span class="number">0xD0</span>, <span class="number">0xF7</span>, <span class="number">0xF4</span>,</span><br><span class="line">        <span class="number">0xD3</span>, <span class="number">0xC0</span>, <span class="number">0x6F</span>, <span class="number">0xF4</span>, <span class="number">0x6F</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0xC4</span>, <span class="number">0x38</span>, <span class="number">0x4C</span>, <span class="number">0x3F</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span>, <span class="number">0xBD</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">uint8 *map_data;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tmp_map[<span class="number">1152</span>]=&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">std::string <span class="title">charArrayToHex</span><span class="params">(uint8* input, <span class="type">size_t</span> size)</span> </span>&#123;</span><br><span class="line">    std::stringstream hexStream;</span><br><span class="line">    hexStream &lt;&lt; std::hex &lt;&lt; std::<span class="built_in">setfill</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        hexStream &lt;&lt; std::<span class="built_in">setw</span>(<span class="number">2</span>) &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">int</span>&gt;(<span class="built_in">static_cast</span>&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt;(input[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hexStream.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">1152</span>;</span><br><span class="line"></span><br><span class="line">    map_data = (uint8 *) <span class="built_in">malloc</span>(n);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> rounds = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        rounds++;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">srand</span>(<span class="number">0xDEADBEEF</span>);</span><br><span class="line">        <span class="built_in">memcpy</span>(map_data, map_data_orig, n);</span><br><span class="line">        <span class="comment">// æµ‹è¯•ç”¨ä¾‹</span></span><br><span class="line">        vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; fruits;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; rounds; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> y = <span class="built_in">rand</span>() % <span class="number">20</span>;</span><br><span class="line">            <span class="type">int</span> x = <span class="built_in">rand</span>() % <span class="number">20</span>;</span><br><span class="line">            fruits.<span class="built_in">push_back</span>(&#123;x, y&#125;);</span><br><span class="line"><span class="comment">//            cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; y &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function">SnakePathFinder <span class="title">pathFinder</span><span class="params">(fruits)</span></span>;</span><br><span class="line"></span><br><span class="line">        vector&lt;uint8&gt; v;</span><br><span class="line"></span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">0x11</span>);</span><br><span class="line">        v.<span class="built_in">push_back</span>(<span class="number">0x12</span>);</span><br><span class="line"></span><br><span class="line">        string path = pathFinder.<span class="built_in">findOptimalPath</span>(<span class="number">10</span>, <span class="number">10</span>, RIGHT);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">char</span> p : path) &#123;</span><br><span class="line">            <span class="keyword">if</span>(p == <span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    map_data[i] += <span class="number">30</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p == <span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    tmp_map[i] = map_data[i];</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    map_data[i] = tmp_map[(i+<span class="number">6</span>)%n];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p == <span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">                    map_data[i]=(map_data[i]&gt;&gt;<span class="number">5</span>)|(map_data[i]&lt;&lt;<span class="number">3</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p == <span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">                    map_data[i]-=<span class="number">102</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        MD5 md5 = <span class="built_in">MD5</span>(map_data, n);</span><br><span class="line">        string hexd = md5.<span class="built_in">toStr</span>();</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;round:&quot;</span> &lt;&lt; rounds &lt;&lt; <span class="string">&quot; way: &quot;</span> &lt;&lt; path &lt;&lt; <span class="string">&quot; md5: &quot;</span> &lt;&lt; hexd &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (hexd == <span class="string">&quot;9c06c08f882d7981e91d663364ce5e2e&quot;</span>) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;found it&quot;</span> &lt;&lt;  <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">charArrayToHex</span>(map_data, n);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;nop\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rounds &gt; <span class="number">1000</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“åƒåˆ°ç¬¬åä¸ªæœå­çš„æ—¶å€™å°±å‡ºäº†ï¼Œå¾—åˆ°æ­£ç¡®çš„ä»£ç ç‰‡æ®µï¼Œå°±æ˜¯ä¸€ä¸ªé­”æ”¹xtea</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> enc[<span class="number">4</span>] = &#123;<span class="number">0x98d9a098</span>,</span><br><span class="line">                           <span class="number">0x711b97ba</span>,</span><br><span class="line">                           <span class="number">0x2f44819b</span>,</span><br><span class="line">                           <span class="number">0xdf37b855</span>&#125;;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">4</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;<span class="number">0x63313357</span>,</span><br><span class="line">                           <span class="number">0x2e336d30</span>,</span><br><span class="line">                           <span class="number">0x51203220</span>,</span><br><span class="line">                           <span class="number">0x38734257</span>&#125;;</span><br><span class="line">    <span class="type">int</span> i, j;</span><br><span class="line">    <span class="type">long</span> sum = <span class="number">0</span>, delta = <span class="number">0x9E3779B9</span>;</span><br><span class="line">    enc[<span class="number">2</span>] ^= enc[<span class="number">1</span>];</span><br><span class="line">    enc[<span class="number">3</span>] ^= enc[<span class="number">0</span>];</span><br><span class="line">    enc[<span class="number">1</span>] ^= enc[<span class="number">3</span>];</span><br><span class="line">    enc[<span class="number">0</span>] ^= enc[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        sum = (<span class="number">32</span> * delta * (i / <span class="number">2</span> + <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">            enc[i + <span class="number">1</span>] -= (((enc[i] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * enc[i])) + enc[i]) ^ (key[((sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>)] + sum);<span class="comment">//å®¹æ˜“é­”æ”¹</span></span><br><span class="line">            sum -= delta;</span><br><span class="line">            enc[i] -= (((enc[i + <span class="number">1</span>] &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * enc[i + <span class="number">1</span>])) + enc[i + <span class="number">1</span>]) ^ (key[(sum &amp; <span class="number">3</span>)] + sum);<span class="comment">//å®¹æ˜“é­”æ”¹</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= <span class="number">3</span>; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (enc[i] &gt;&gt; (j * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag&#123;G0@d_Snake&#125;</span></span><br></pre></td></tr></table></figure><h2 id="DLS2XLS"><a href="#DLS2XLS" class="headerlink" title="DLS2XLS"></a>DLS2XLS</h2><p>â€‹ä¸€ä¸ªç½—æ€»æ­£åœ¨ç©çš„ä¸€ä¸ªå¾ˆè€çš„æ¸¸æˆï¼Œä»–ç»™äº†æˆ‘å‡ ä¸ªæ¸¸æˆæ•°æ®è¦æˆ‘è¿˜åŸæ•°æ®ï¼Œè¿˜ç»™äº†æˆ‘ä¸€ä¸ªè€å¤–å†™çš„ä¸€ä¸ªæ•°æ®è½¬æ¢çš„exeï¼Œä½†æ˜¯æ˜¯ç”¨c#å†™çš„ï¼Œç›´æ¥é€†c#äº†ã€‚</p><p>â€‹ç¨‹åºè¦å…ˆè¯»å…¥ä¸€ä¸ªcfgçš„æ ¼å¼æ–‡ä»¶ï¼Œç„¶åå†è¿˜åŸdfsï¼Œé€†å‘è¿™ä¸ªç¨‹åºæ‰¾åˆ°å…³é”®ä»£ç æ®µã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/2.1.png" alt="2.1"></p><p>å¯ä»¥å‘ç°dfsæ–‡ä»¶å…·æœ‰ä¸€ä¸ª0x89å­—èŠ‚çš„æ–‡ä»¶å¤´ï¼Œç„¶ååé¢12å­—èŠ‚éƒ½æ˜¯ä¸€æ®µæ€»çš„æ•°æ®ï¼Œç”¨æ¥å’Œcfgè¿›è¡Œå¯¹æ¯”åŒ¹é…ã€‚</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/2.2.png" alt="2.2"></p><p>ç„¶åæ ¹æ®cfgæ–‡ä»¶é‡Œçš„æ•°æ®ç±»å‹ï¼Œåˆ†æˆä¸€ä¸ªm*nçš„è¡¨æ ¼ï¼Œè¿›è¡Œæ•°æ®çš„è½¬æ¢ã€‚</p><p>ç”±æ­¤å¯ä»¥æ¨å‡ºæ¸¸æˆæ•°æ®æ ¼å¼</p><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/2.3.png" alt="2.3"></p><p>æ•°æ®éƒ½æ˜¯ä»¥intå°ç«¯åºè¾“å…¥çš„</p><p>çº¢è‰²ï¼šæ¯æ®µæ•°æ®çš„å¤§å°</p><p>è“è‰²ï¼šæ¯æ®µæ•°æ®æœ‰å‡ ä¸ªç±»å‹</p><p>ç»¿è‰²ï¼šä¸€å…±æœ‰å¤šå°‘è¿™æ ·çš„æ•°æ®</p><p>äºæ˜¯å¯ä»¥æ¨¡ä»¿é‚£ä¸ªç¨‹åºå†™ä¸ªè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> fnmatch</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_cfg_file</span>(<span class="params">directory, filename</span>):</span><br><span class="line">    filename = filename.lower()</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory): </span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> fnmatch.fnmatch(file.lower(), <span class="string">f&quot;<span class="subst">&#123;filename&#125;</span>.cfg&quot;</span>):</span><br><span class="line">                <span class="keyword">return</span> os.path.join(root, file)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_dfs_file</span>(<span class="params">directory, filename</span>):</span><br><span class="line">    filename = filename.lower()</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory): </span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> fnmatch.fnmatch(file.lower(), <span class="string">f&quot;<span class="subst">&#123;filename&#125;</span>.dfs&quot;</span>):</span><br><span class="line">                <span class="keyword">return</span> os.path.join(root, file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_file_line</span>(<span class="params">file_path,i</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            content = file.readlines()</span><br><span class="line">            <span class="keyword">return</span> content[i]</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;è¯»å–cfgæ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_dfs_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            content = file.read()</span><br><span class="line">            <span class="keyword">return</span> content</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;è¯»å–dfsæ–‡ä»¶æ—¶å‘ç”Ÿé”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">an_cfg</span>(<span class="params">text</span>):</span><br><span class="line">    result = []</span><br><span class="line">    </span><br><span class="line">    types = text.split(<span class="string">&#x27;;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> data_type <span class="keyword">in</span> types:</span><br><span class="line">        <span class="keyword">if</span> data_type.startswith(<span class="string">&#x27;int32&#x27;</span>):</span><br><span class="line">            result.append(<span class="number">4</span>)</span><br><span class="line">        <span class="keyword">elif</span> data_type.startswith(<span class="string">&#x27;int16&#x27;</span>):</span><br><span class="line">            result.append(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">elif</span> data_type.startswith(<span class="string">&#x27;int8&#x27;</span>):</span><br><span class="line">            result.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> data_type.startswith(<span class="string">&#x27;wstring&#x27;</span>):</span><br><span class="line">            <span class="comment"># è§£æå‡º wstring åçš„æ•°å­—éƒ¨åˆ†</span></span><br><span class="line">            length = <span class="built_in">int</span>(data_type.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            result.append(length)</span><br><span class="line">        <span class="keyword">elif</span> data_type.startswith(<span class="string">&#x27;string&#x27;</span>):</span><br><span class="line">            <span class="comment"># è§£æå‡º string åçš„æ•°å­—éƒ¨åˆ†</span></span><br><span class="line">            length = <span class="built_in">int</span>(data_type.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            result.append(length)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;Text_SkillTable&quot;</span><span class="comment">#æ–‡ä»¶å</span></span><br><span class="line">current_directory = os.path.dirname(os.path.abspath(__file__))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cfgdirectory = current_directory+<span class="string">&#x27;\cfg&#x27;</span> </span><br><span class="line">cfg_file_path = find_cfg_file(cfgdirectory, filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> cfg_file_path:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°cfgæ–‡ä»¶ï¼š<span class="subst">&#123;cfg_file_path&#125;</span>&quot;</span>)</span><br><span class="line">    cfg_content = read_file_line(cfg_file_path,-<span class="number">1</span>)<span class="comment">#è¯»å…¥æ•°æ®ç±»å‹</span></span><br><span class="line">    cfg_top =read_file_line(cfg_file_path,-<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(cfg_content,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">type</span>=an_cfg(cfg_content)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;size =&quot;</span>,<span class="built_in">sum</span>(<span class="built_in">type</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°å¯¹åº”çš„.cfg æ–‡ä»¶&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">dfsdirectory = current_directory+<span class="string">&#x27;\dfs&#x27;</span> </span><br><span class="line">dfs_file_path = find_dfs_file(dfsdirectory, filename)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> dfs_file_path:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°dfsæ–‡ä»¶ï¼š<span class="subst">&#123;dfs_file_path&#125;</span>&quot;</span>)</span><br><span class="line">    dfs_content = read_dfs_file(dfs_file_path)</span><br><span class="line">    d_size=<span class="built_in">int</span>.from_bytes(dfs_content[<span class="number">0x89</span>:<span class="number">0x8c</span>],<span class="string">&quot;little&quot;</span>)</span><br><span class="line">    col=<span class="built_in">int</span>.from_bytes(dfs_content[<span class="number">0x8d</span>:<span class="number">0x90</span>],<span class="string">&quot;little&quot;</span>)</span><br><span class="line">    n=<span class="built_in">int</span>.from_bytes(dfs_content[<span class="number">0x91</span>:<span class="number">0x94</span>],<span class="string">&quot;little&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;size =&quot;</span>,d_size)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;col =&quot;</span>,col)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°å¯¹åº”çš„.dfs æ–‡ä»¶&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(d_size!=<span class="built_in">sum</span>(<span class="built_in">type</span>)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;dfsæ–‡ä»¶ä¸cfgæ–‡ä»¶ä¸åŒ¹é…&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">type</span>)==col):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å°è¯•è§£å¯†...&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ä¸€å…±&#123;&#125;åˆ—&quot;</span>.<span class="built_in">format</span>(col))</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(cfg_top)</span><br><span class="line">            <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                text=dfs_content[<span class="number">0x95</span>+o*d_size:<span class="number">0x95</span>+(o+<span class="number">1</span>)*d_size]</span><br><span class="line">                <span class="comment"># print(text)</span></span><br><span class="line">                tmp=<span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">type</span>:</span><br><span class="line">                    <span class="keyword">if</span> t&lt;=<span class="number">8</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(text[tmp:tmp+t],<span class="string">&quot;little&quot;</span>),end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        t=d_size-tmp</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, t-<span class="number">2</span>, <span class="number">2</span>):</span><br><span class="line">                            <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>.from_bytes(text[tmp+i:tmp+i+<span class="number">2</span>], <span class="string">&quot;little&quot;</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>()</span><br><span class="line">                    tmp=tmp+t</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æˆåŠŸåŒ¹é…å¼€å§‹è§£å¯†...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cfg_top)</span><br><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    text=dfs_content[<span class="number">0x95</span>+o*d_size:<span class="number">0x95</span>+(o+<span class="number">1</span>)*d_size]</span><br><span class="line">    <span class="comment"># print(text)</span></span><br><span class="line">    tmp=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">type</span>:</span><br><span class="line">        <span class="keyword">if</span> t&lt;=<span class="number">8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(text[tmp:tmp+t],<span class="string">&quot;little&quot;</span>),end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, t-<span class="number">2</span>, <span class="number">2</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>.from_bytes(text[tmp+i:tmp+i+<span class="number">2</span>], <span class="string">&quot;little&quot;</span>)),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        tmp=tmp+t</span><br><span class="line">    <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure><p><img src="/../img/%E6%B5%85%E8%B0%88%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/2.4.png" alt="2.4"></p><p>â€‹ç”¨pythonç®€å•è¿˜åŸäº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰è®¸å¤šæ•°æ®åŒ¹é…ä¸ä¸Šï¼Œåšäº†ä¸ªå°è¯•è§£å¯†çš„ï¼Œæ„Ÿè§‰è‚¯å®šæ˜¯è€ç½—ç»™çš„æ•°æ®ç»“æ„æ–‡ä»¶æœ‰é—®é¢˜</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>â€‹æ¸¸æˆé€†å‘ä¹Ÿæ˜¯é€†å‘çš„ä¸€å¤§ç±»ï¼Œè¿˜æœªæ€»ç»“çš„pythonç³»åˆ—ä¸unityç³»åˆ—éƒ½æ˜¯é€†å‘çš„å¤§å¤´ï¼Œæˆå‹çš„ç»“æ„å’Œå¼€å‘ç³»ç»Ÿï¼Œä¼šè®©é€†å‘æ›´éš¾å•Šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘&quot;&gt;&lt;a href=&quot;#æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘&quot; class=&quot;headerlink&quot; title=&quot;æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘&quot;&gt;&lt;/a&gt;æµ…è°ˆctfä¸­çš„æ¸¸æˆé€†å‘&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;head</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>swift-reå¸¸è§çš„åŠ å¯†è§£å¯†</title>
    <link href="https://straw-233.github.io/2024/10/09/swift-re%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/"/>
    <id>https://straw-233.github.io/2024/10/09/swift-re%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/</id>
    <published>2024-10-09T12:29:28.255Z</published>
    <updated>2024-10-13T10:41:57.709Z</updated>
    
    <content type="html"><![CDATA[<h1 id="swift-reå¸¸è§çš„åŠ å¯†è§£å¯†"><a href="#swift-reå¸¸è§çš„åŠ å¯†è§£å¯†" class="headerlink" title="swift-reå¸¸è§çš„åŠ å¯†è§£å¯†"></a>swift-reå¸¸è§çš„åŠ å¯†è§£å¯†</h1><p>åœ¨xcodeé‡Œç”¨swiftå†™äº†ç‚¹åŠ å¯†è§£å¯†ï¼Œä»¥åéƒ½æ”¾ç€è¿™é‡Œäº†ã€‚ã€‚</p><h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RC4</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> state <span class="operator">=</span> [<span class="type">UInt8</span>](repeating: <span class="number">0</span>, count: <span class="number">256</span>)</span><br><span class="line">    <span class="keyword">init</span>(<span class="params">key</span>: [<span class="type">UInt8</span>]) &#123;</span><br><span class="line">        <span class="keyword">var</span> j:<span class="type">Int</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">256</span> &#123;</span><br><span class="line">            state[i] <span class="operator">=</span> <span class="type">UInt8</span>(i)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">256</span> &#123;</span><br><span class="line">            j <span class="operator">=</span> (j <span class="operator">+</span> <span class="type">Int</span>(state[i]) <span class="operator">+</span> <span class="type">Int</span>(key[i <span class="operator">%</span> key.count])) <span class="operator">%</span> <span class="number">256</span></span><br><span class="line">            state.swapAt(i, j)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">encrypt</span>(<span class="params">data</span>: <span class="keyword">inout</span> [<span class="type">UInt8</span>])&#123;</span><br><span class="line">        <span class="keyword">var</span> x: <span class="type">Int</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">var</span> y: <span class="type">Int</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span>data.count &#123;</span><br><span class="line">            x <span class="operator">=</span> (x <span class="operator">+</span> <span class="number">1</span>) <span class="operator">%</span> <span class="number">256</span></span><br><span class="line">            y <span class="operator">=</span> (y <span class="operator">+</span> <span class="type">Int</span>(state[x])) <span class="operator">%</span> <span class="number">256</span></span><br><span class="line">            <span class="keyword">let</span> temp <span class="operator">=</span> state[x]</span><br><span class="line">            state[x]<span class="operator">=</span>state[y]</span><br><span class="line">            state[y]<span class="operator">=</span>temp</span><br><span class="line">            <span class="keyword">let</span> t <span class="operator">=</span> state[(<span class="type">Int</span>(state[x]) <span class="operator">+</span> <span class="type">Int</span>(state[y])) <span class="operator">%</span> <span class="number">256</span>]</span><br><span class="line">            data[i] <span class="operator">=</span> data[i] <span class="operator">^</span> t</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> key: [<span class="type">UInt8</span>] <span class="operator">=</span> <span class="type">Array</span>(<span class="string">&quot;qwq&quot;</span>.utf8)</span><br><span class="line"><span class="keyword">let</span> rc4<span class="operator">=</span><span class="type">RC4</span>(key: key)</span><br><span class="line"><span class="keyword">var</span> text: [<span class="type">UInt8</span>] <span class="operator">=</span> <span class="type">Array</span>(<span class="string">&quot;straw&quot;</span>.utf8)</span><br><span class="line">rc4.encrypt(data: <span class="operator">&amp;</span>text)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span>text.count&#123;</span><br><span class="line">    <span class="keyword">var</span> texthex<span class="operator">=</span><span class="type">String</span>(format: <span class="string">&quot;0x%02x&quot;</span>, text[i])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(texthex)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h2><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">var</span> flag: <span class="type">String</span> <span class="operator">=</span> <span class="string">&quot;liufeiyu&quot;</span></span><br><span class="line"><span class="keyword">var</span> hexArray:[<span class="type">UInt8</span>?]<span class="operator">=</span>[]</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> flag&#123;</span><br><span class="line">    hexArray.append(ch.asciiValue)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> v0:<span class="type">UInt32</span></span><br><span class="line"><span class="keyword">var</span> v1:<span class="type">UInt32</span></span><br><span class="line"><span class="keyword">var</span> sum:<span class="type">UInt32</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="comment">//print(hexArray)</span></span><br><span class="line"><span class="keyword">var</span> <span class="type">I32Array</span>:[<span class="type">UInt32</span>]<span class="operator">=</span>[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0</span>, to: hexArray.count, by: <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> byte1 <span class="operator">=</span> <span class="type">UInt32</span>(hexArray[i]<span class="operator">!</span>)</span><br><span class="line">    <span class="keyword">let</span> byte2 <span class="operator">=</span> <span class="type">UInt32</span>(hexArray[i <span class="operator">+</span> <span class="number">1</span>]<span class="operator">!</span>) <span class="operator">&lt;&lt;</span> <span class="number">8</span></span><br><span class="line">    <span class="keyword">let</span> byte3 <span class="operator">=</span> <span class="type">UInt32</span>(hexArray[i <span class="operator">+</span> <span class="number">2</span>]<span class="operator">!</span>) <span class="operator">&lt;&lt;</span> <span class="number">16</span></span><br><span class="line">    <span class="keyword">let</span> byte4 <span class="operator">=</span> <span class="type">UInt32</span>(hexArray[i <span class="operator">+</span> <span class="number">3</span>]<span class="operator">!</span>) <span class="operator">&lt;&lt;</span> <span class="number">24</span></span><br><span class="line">    <span class="type">I32Array</span>.append(byte1 <span class="operator">|</span> byte2 <span class="operator">|</span> byte3 <span class="operator">|</span> byte4)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="type">I32Array</span>)</span><br><span class="line"><span class="keyword">let</span> key: [<span class="type">UInt32</span>] <span class="operator">=</span> [<span class="number">0x1</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0x5</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="type">I32Array</span>.count<span class="operator">/</span><span class="number">2</span>&#123;</span><br><span class="line">    v0<span class="operator">=</span><span class="type">I32Array</span>[<span class="number">2</span><span class="operator">*</span>i]</span><br><span class="line">    v1<span class="operator">=</span><span class="type">I32Array</span>[<span class="number">2</span><span class="operator">*</span>i<span class="operator">+</span><span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">_</span> <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">32</span> &#123;</span><br><span class="line">        sum <span class="operator">=</span> <span class="type">UInt32</span>((<span class="type">UInt64</span>(sum) <span class="operator">+</span> <span class="type">UInt64</span>(<span class="number">0x9e3779b9</span>)) <span class="operator">&amp;</span> <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        v0 <span class="operator">&amp;+=</span> <span class="type">UInt32</span>((((<span class="type">UInt64</span>(v1) <span class="operator">&lt;&lt;</span> <span class="number">4</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">0</span>])) <span class="operator">^</span> (<span class="type">UInt64</span>(v1) <span class="operator">+</span> <span class="type">UInt64</span>(sum)) <span class="operator">^</span> ((<span class="type">UInt64</span>(v1) <span class="operator">&gt;&gt;</span> <span class="number">5</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">1</span>])))<span class="operator">&amp;</span><span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        v1 <span class="operator">&amp;+=</span> <span class="type">UInt32</span>((((<span class="type">UInt64</span>(v0) <span class="operator">&lt;&lt;</span> <span class="number">4</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">2</span>])) <span class="operator">^</span> (<span class="type">UInt64</span>(v0) <span class="operator">+</span> <span class="type">UInt64</span>(sum)) <span class="operator">^</span> ((<span class="type">UInt64</span>(v0) <span class="operator">&gt;&gt;</span> <span class="number">5</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">3</span>])))<span class="operator">&amp;</span><span class="number">0xFFFFFFFF</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">I32Array</span>[<span class="number">2</span><span class="operator">*</span>i]<span class="operator">=</span>v0</span><br><span class="line">    <span class="type">I32Array</span>[<span class="number">2</span><span class="operator">*</span>i<span class="operator">+</span><span class="number">1</span>]<span class="operator">=</span>v1</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="type">I32Array</span>)</span><br></pre></td></tr></table></figure><p>è¿˜æ²¡åŒ…è£…ï¼Œç­‰åé¢æœ‰æ—¶é—´åŒ…è£…ä¸€ä¸‹</p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"><span class="keyword">let</span> key: [<span class="type">UInt32</span>] <span class="operator">=</span> [<span class="number">0x1</span>,<span class="number">0x1</span>,<span class="number">0x4</span>,<span class="number">0x5</span>]</span><br><span class="line"><span class="keyword">var</span> pw: [<span class="type">UInt32</span>] <span class="operator">=</span> [<span class="number">0x5f031f51</span>,<span class="number">0xae732304</span>,<span class="number">0xa6bdef67</span>,<span class="number">0x15c0218b</span>,<span class="number">0x4ec46f64</span>,<span class="number">0x8bfccb46</span>,<span class="number">0x90eebc4a</span>,<span class="number">0xa9aa0c03</span> ]</span><br><span class="line"><span class="keyword">var</span> v0:<span class="type">UInt32</span></span><br><span class="line"><span class="keyword">var</span> v1:<span class="type">UInt32</span></span><br><span class="line"><span class="keyword">var</span> sum:<span class="type">UInt32</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span>pw.count<span class="operator">/</span><span class="number">2</span>&#123;</span><br><span class="line">    v0<span class="operator">=</span>pw[<span class="number">2</span><span class="operator">*</span>i]</span><br><span class="line">    v1<span class="operator">=</span>pw[<span class="number">2</span><span class="operator">*</span>i<span class="operator">+</span><span class="number">1</span>];</span><br><span class="line">    sum<span class="operator">=</span><span class="type">UInt32</span>(<span class="type">UInt64</span>(<span class="number">32</span><span class="operator">*</span><span class="number">0x9E3779B9</span>)<span class="operator">&amp;</span><span class="number">0xFFFFFFFF</span>)</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">_</span> <span class="keyword">in</span> <span class="number">0</span><span class="operator">..&lt;</span><span class="number">32</span> &#123;</span><br><span class="line">        v1 <span class="operator">&amp;-=</span> <span class="type">UInt32</span>((((<span class="type">UInt64</span>(v0) <span class="operator">&lt;&lt;</span> <span class="number">4</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">2</span>])) <span class="operator">^</span> (<span class="type">UInt64</span>(v0) <span class="operator">+</span> <span class="type">UInt64</span>(sum)) <span class="operator">^</span> ((<span class="type">UInt64</span>(v0) <span class="operator">&gt;&gt;</span> <span class="number">5</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">3</span>])))<span class="operator">&amp;</span><span class="number">0xFFFFFFFF</span>)</span><br><span class="line"><span class="comment">//        print(v1)</span></span><br><span class="line">        v0 <span class="operator">&amp;-=</span> <span class="type">UInt32</span>((((<span class="type">UInt64</span>(v1) <span class="operator">&lt;&lt;</span> <span class="number">4</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">0</span>])) <span class="operator">^</span> (<span class="type">UInt64</span>(v1) <span class="operator">+</span> <span class="type">UInt64</span>(sum)) <span class="operator">^</span> ((<span class="type">UInt64</span>(v1) <span class="operator">&gt;&gt;</span> <span class="number">5</span>) <span class="operator">+</span> <span class="type">UInt64</span>(key[<span class="number">1</span>])))<span class="operator">&amp;</span><span class="number">0xFFFFFFFF</span>)</span><br><span class="line"><span class="comment">//        print(v0)</span></span><br><span class="line">        sum <span class="operator">=</span> <span class="type">UInt32</span>((<span class="type">UInt64</span>(sum) <span class="operator">+</span> <span class="type">UInt64</span>(<span class="number">0x61C88647</span>)) <span class="operator">&amp;</span> <span class="number">0xFFFFFFFF</span>)</span><br><span class="line"><span class="comment">//        print(sum)</span></span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">0</span><span class="operator">...</span><span class="number">3</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> v0hex<span class="operator">=</span><span class="type">String</span>(format: <span class="string">&quot;%c&quot;</span>, (v0<span class="operator">&gt;&gt;</span>(j<span class="operator">*</span><span class="number">8</span>))<span class="operator">&amp;</span><span class="number">0xff</span>)</span><br><span class="line">        <span class="built_in">print</span>(v0hex,terminator: <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">0</span><span class="operator">...</span><span class="number">3</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> v1hex<span class="operator">=</span><span class="type">String</span>(format: <span class="string">&quot;%c&quot;</span>, (v1<span class="operator">&gt;&gt;</span>(j<span class="operator">*</span><span class="number">8</span>))<span class="operator">&amp;</span><span class="number">0xff</span>)</span><br><span class="line">        <span class="built_in">print</span>(v1hex,terminator: <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¢«swiftçš„æ£€æµ‹æ¶å¿ƒäº†ï¼Œæ•°æ®æº¢å‡ºæˆ–è€…ç±»å‹ä¸åŒ¹é…ç›´æ¥æŠ¥é”™ï¼Œå¿…é¡»å…¨åŠ ä¸€éç±»å‹ä¿®æ­£ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;swift-reå¸¸è§çš„åŠ å¯†è§£å¯†&quot;&gt;&lt;a href=&quot;#swift-reå¸¸è§çš„åŠ å¯†è§£å¯†&quot; class=&quot;headerlink&quot; title=&quot;swift-reå¸¸è§çš„åŠ å¯†è§£å¯†&quot;&gt;&lt;/a&gt;swift-reå¸¸è§çš„åŠ å¯†è§£å¯†&lt;/h1&gt;&lt;p&gt;åœ¨xcodeé‡Œç”¨swiftå†™äº†ç‚¹åŠ å¯†</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>vm--æ’æ›²</title>
    <link href="https://straw-233.github.io/2024/07/17/vm/"/>
    <id>https://straw-233.github.io/2024/07/17/vm/</id>
    <published>2024-07-17T05:24:15.369Z</published>
    <updated>2024-07-18T07:20:39.509Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VM"><a href="#VM" class="headerlink" title="VM"></a>VM</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä¸€ä¸ªè™šæ‹ŸæœºæŒ‡ä»¤é›†ï¼Œç›¸å½“äºè‡ªå·±å†™äº†ä¸ªè™šæ‹Ÿæœºï¼Œæ‰§è¡Œè‡ªå·±å†™çš„æŒ‡ä»¤ï¼Œæ¥å®ç°ç¨‹åºçš„è¿è¡Œï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹å¥—ä¸­å¥—çš„å‘³é“äº†</p><h2 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h2><p>åˆ†æä»£ç èƒ½åŠ›ï¼Œ<strong>æ‰å®çš„æ±‡ç¼–åŸºç¡€</strong>ï¼Œchatgptçš„ç†Ÿç»ƒä½¿ç”¨</p><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>ç®€å•å­¦ä¹ ä¸€ä¸‹vmï¼Œä»¥WcyVM(nctf2018)ä¸ºä¾‹</p><p><img src="/../img/vm/1.png" alt="1"></p><p>è¿™å°±æ˜¯ä¸€ä¸ªç»å…¸çš„vmé¢˜ç›®ï¼Œä¸‹é¢çš„ä¸€å †caseå°±åˆ†åˆ«ä»£è¡¨ä¸åŒçš„æŒ‡ä»¤é›†ï¼Œä¸Šé¢çš„v4ï¼Œv5å°±ä»£è¡¨ä¸åŒçš„å¯„å­˜å™¨ï¼Œç”¨æ¥å­˜å‚¨å’Œæ“ä½œæ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦åšä»€ä¹ˆå‘¢ï¼Ÿ</p><h3 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h3><p><img src="/../img/vm/2.png" alt="2"></p><p>opcodeä¹Ÿå°±æ˜¯æ“ä½œç ï¼Œç”¨æ¥åˆ¤æ–­è¿™ä¸ªç¨‹åºæ˜¯æ ¹æ®ä»€ä¹ˆé¡ºåºè¿è¡Œçš„ï¼Œæœ‰äº›é¢˜çš„opcodeæ˜¯åªæœ‰æ“ä½œçš„ï¼Œä½†æ˜¯æœ‰äº›é¢˜çš„opcodeè¿˜ä¼šæœ‰å¸¦ä¸Šå‚æ•°ä»€ä¹ˆçš„ï¼Œè¿™é¢˜å°±æ˜¯</p><h3 id="å¯„å­˜å™¨"><a href="#å¯„å­˜å™¨" class="headerlink" title="å¯„å­˜å™¨"></a>å¯„å­˜å™¨</h3><p><img src="/../img/vm/3.png" alt="3"></p><h3 id="æ“ä½œåˆ†æ"><a href="#æ“ä½œåˆ†æ" class="headerlink" title="æ“ä½œåˆ†æ"></a>æ“ä½œåˆ†æ</h3><h4 id="case-0x8"><a href="#case-0x8" class="headerlink" title="case 0x8"></a>case 0x8</h4><p><img src="/../img/vm/4.png" alt="4"></p><p><img src="/../img/vm/5.png" alt="5"></p><p>ä¼ å…¥Rå’Œæ•°æ®ï¼Œa2å€¼ä¼ å…¥a1ï¼Œç›¸å½“äºmovæŒ‡ä»¤</p><h4 id="case-0x9"><a href="#case-0x9" class="headerlink" title="case 0x9"></a>case 0x9</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_40096D(v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], &amp;v4[<span class="number">4</span>], v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_40096D</span><span class="params">(_DWORD *a1, _DWORD **a2, _QWORD *a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = *(*a2)++;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥Rå’Œæ ˆï¼Œa2ä¼ å…¥a1ï¼Œa2++ï¼Œç›¸å½“äºpopæŒ‡ä»¤</p><h4 id="case-0xa"><a href="#case-0xa" class="headerlink" title="case 0xa"></a>case 0xa</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400927(v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], &amp;v4[<span class="number">4</span>], v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_400927</span><span class="params">(_DWORD *a1, _QWORD *a2, _QWORD *a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a2 -= <span class="number">4LL</span>;</span><br><span class="line">  *(_DWORD *)*a2 = *a1;</span><br><span class="line">  result = a3;</span><br><span class="line">  *a3 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥Rå’Œæ ˆï¼Œa2-4ï¼Œa1ä¼ å…¥a2ï¼Œç›¸å½“äºpushæŒ‡ä»¤</p><h4 id="case-0xbï¼Œ0xc"><a href="#case-0xbï¼Œ0xc" class="headerlink" title="case 0xbï¼Œ0xc"></a>case 0xbï¼Œ0xc</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_4009B3(v4[<span class="number">0</span>], v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_4009B3</span><span class="params">(<span class="type">int</span> *a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = getchar();</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 += <span class="number">4LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_4009E5</span><span class="params">(<span class="type">int</span> *a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">putchar</span>(*a1);</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 += <span class="number">4LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥R0ï¼ŒR0&#x3D;getchar()ï¼ŒR0&#x3D;putchar()æ“ä½œ</p><h4 id="case-0xd"><a href="#case-0xd" class="headerlink" title="case 0xd"></a>case 0xd</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400B5D(&amp;v1, v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">8</span>) - <span class="number">1</span>], v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_400B5D</span><span class="params">(_DWORD *a1, _DWORD *a2, _DWORD *a3, _QWORD *a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *a1 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *a2 == *a3 )</span><br><span class="line">    v4 = <span class="number">0x80</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">  *a1 |= v4;</span><br><span class="line">  <span class="keyword">if</span> ( *a3 &gt;= *a2 )</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v5 = <span class="number">64</span>;</span><br><span class="line">  *a1 |= v5;</span><br><span class="line">  <span class="keyword">if</span> ( *a2 &gt;= *a3 )</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v6 = <span class="number">32</span>;</span><br><span class="line">  *a1 |= v6;</span><br><span class="line">  result = a4;</span><br><span class="line">  *a4 += <span class="number">12LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒéš¾çš„éƒ¨åˆ†ï¼Œä½†ä¸æ˜¯å¾ˆå…³é”®çš„éƒ¨åˆ†</p><p>ä¼ å…¥äº†ä¸¤ä¸ªRå’Œv1ï¼Œè¿›è¡Œäº†æ¯”è¾ƒï¼Œåªæœ‰ç›¸ç­‰äº†æ‰èƒ½ä½¿v1&#x3D;80ç„¶åæ¥ä¸‹æ¥ä¸‹é¢çš„æ“ä½œ</p><h4 id="case-0xe"><a href="#case-0xe" class="headerlink" title="case 0xe"></a>case 0xe</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400A34(v5, *(<span class="type">unsigned</span> <span class="type">int</span> *)(v5[<span class="number">0</span>] + <span class="number">4</span>), dest);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_400A34</span><span class="params">(_QWORD *a1, <span class="type">int</span> a2, __int64 a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  result = a1;</span><br><span class="line">  *a1 = a3 + <span class="number">4LL</span> * a2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥äº†æ•°æ®å’Œdestï¼Œä½¿v5å‘ç”Ÿæ”¹å˜ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªè·³è½¬æŒ‡ä»¤ï¼Œjmp</p><h4 id="case-0xfï¼Œ0x10"><a href="#case-0xfï¼Œ0x10" class="headerlink" title="case 0xfï¼Œ0x10"></a>case 0xfï¼Œ0x10</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400AAF(v1, v5, *(<span class="type">unsigned</span> <span class="type">int</span> *)(v5[<span class="number">0</span>] + <span class="number">4</span>), dest);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 *__fastcall <span class="title function_">sub_400AAF</span><span class="params">(<span class="type">char</span> a1, __int64 *a2, <span class="type">unsigned</span> <span class="type">int</span> a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (a1 &amp; <span class="number">0x80</span>) != <span class="number">0</span> )</span><br><span class="line">    v4 = *a2 + <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = a4 + <span class="number">4LL</span> * a3;</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 *__fastcall <span class="title function_">sub_400A61</span><span class="params">(<span class="type">char</span> a1, __int64 *a2, <span class="type">unsigned</span> <span class="type">int</span> a3, __int64 a4)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (a1 &amp; <span class="number">0x80</span>) != <span class="number">0</span> )</span><br><span class="line">    v4 = a4 + <span class="number">4LL</span> * a3;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = *a2 + <span class="number">8</span>;</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥æ•°æ®å’Œdestå’Œv1ï¼Œä¸¤ä¸ªä»£ç çš„ifå’Œelseåä¸€ä¸‹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªæ˜¯jzï¼Œä¸€ä¸ªæ˜¯jnz</p><h4 id="case-0x11ï¼Œ0x12"><a href="#case-0x11ï¼Œ0x12" class="headerlink" title="case 0x11ï¼Œ0x12"></a>case 0x11ï¼Œ0x12</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400AFD(v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_400AFD</span><span class="params">(_DWORD *a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  ++*a1;</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">sub_400B2D</span><span class="params">(_DWORD *a1, _QWORD *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  --*a1;</span><br><span class="line">  result = a2;</span><br><span class="line">  *a2 += <span class="number">8LL</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªä¼ å…¥äº†Rï¼Œå¾ˆç®€å•çš„+1ï¼Œ-1æ“ä½œï¼Œincï¼Œdec</p><h4 id="case-0x13ï¼Œ0x14ï¼Œ0x15ï¼Œ0x16ï¼Œ0x17ï¼Œ0x1D"><a href="#case-0x13ï¼Œ0x14ï¼Œ0x15ï¼Œ0x16ï¼Œ0x17ï¼Œ0x1D" class="headerlink" title="case 0x13ï¼Œ0x14ï¼Œ0x15ï¼Œ0x16ï¼Œ0x17ï¼Œ0x1D"></a>case 0x13ï¼Œ0x14ï¼Œ0x15ï¼Œ0x16ï¼Œ0x17ï¼Œ0x1D</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400C0E((_DWORD *)v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], *(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">8</span>), v5);</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400C43((_DWORD *)v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], (_DWORD *)v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">8</span>) - <span class="number">1</span>], v5);</span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„+ï¼Œ-ï¼Œ&amp;ï¼Œ|ï¼Œ*æ“ä½œï¼Œçœ‹å¥½æ˜¯ä¼ å…¥æ•°æ®è¿˜æ˜¯Rå°±è¡Œ</p><h4 id="case-0x19ï¼Œ0x1Aï¼Œ0x1Bï¼Œ0x1C"><a href="#case-0x19ï¼Œ0x1Aï¼Œ0x1Bï¼Œ0x1C" class="headerlink" title="case 0x19ï¼Œ0x1Aï¼Œ0x1Bï¼Œ0x1C"></a>case 0x19ï¼Œ0x1Aï¼Œ0x1Bï¼Œ0x1C</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_400889((_DWORD *)v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">4</span>) - <span class="number">1</span>], v4[*(_DWORD *)(v5[<span class="number">0</span>] + <span class="number">8</span>) - <span class="number">1</span>], v5);</span><br></pre></td></tr></table></figure><p>å„ç§ç±»å‹çš„movæ“ä½œï¼Œåœ°å€å•¥çš„</p><h3 id="opcodeâ€”â€”æ±‡ç¼–è¿˜åŸ"><a href="#opcodeâ€”â€”æ±‡ç¼–è¿˜åŸ" class="headerlink" title="opcodeâ€”â€”æ±‡ç¼–è¿˜åŸ"></a>opcodeâ€”â€”æ±‡ç¼–è¿˜åŸ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">opcode = [</span><br><span class="line">    <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, </span><br><span class="line">    <span class="number">0x00000008</span>, <span class="number">0x00000003</span>, <span class="number">0x00000046</span>, </span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000015</span>, </span><br><span class="line">    <span class="number">0x0000000A</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x00000009</span>, <span class="number">0x00000002</span>, </span><br><span class="line">    <span class="number">0x0000000B</span>, </span><br><span class="line">    <span class="number">0x0000000A</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x0000000A</span>, <span class="number">0x00000002</span>, </span><br><span class="line">    <span class="number">0x00000009</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x00000011</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x0000000D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, </span><br><span class="line">    <span class="number">0x0000000F</span>, <span class="number">0x00000008</span>, </span><br><span class="line">    <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, </span><br><span class="line">    <span class="number">0x00000008</span>, <span class="number">0x00000003</span>, <span class="number">0x00000047</span>, </span><br><span class="line">    <span class="number">0x0000000E</span>, <span class="number">0x00000046</span>, </span><br><span class="line">    <span class="number">0x0000000A</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x0000001A</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, </span><br><span class="line">    <span class="number">0x0000001D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, </span><br><span class="line">    <span class="number">0x00000014</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x00000019</span>, <span class="number">0x00000001</span>, <span class="number">0x00000002</span>, </span><br><span class="line">    <span class="number">0x0000001B</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x0000001D</span>, <span class="number">0x00000001</span>, <span class="number">0x0000006E</span>, </span><br><span class="line">    <span class="number">0x00000013</span>, <span class="number">0x00000001</span>, <span class="number">0x00000063</span>, </span><br><span class="line">    <span class="number">0x00000015</span>, <span class="number">0x00000001</span>, <span class="number">0x00000074</span>, </span><br><span class="line">    <span class="number">0x00000013</span>, <span class="number">0x00000001</span>, <span class="number">0x00000066</span>, </span><br><span class="line">    <span class="number">0x0000001C</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x00000009</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x00000011</span>, <span class="number">0x00000001</span>, </span><br><span class="line">    <span class="number">0x0000000D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, </span><br><span class="line">    <span class="number">0x0000000F</span>, <span class="number">0x00000022</span>, <span class="number">0x00000064</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">disasm</span>(<span class="params">i, c</span>):</span><br><span class="line">    <span class="keyword">if</span> c == <span class="number">8</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mov R&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">9</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;pop R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xa</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;push R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xb</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;R0=getchar()&quot;</span>)</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xc</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;R0=putchar()&quot;</span>)</span><br><span class="line">        i=i+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xd</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;cmp R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        jnz &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i+<span class="number">3</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        mov a, 80&quot;</span>)</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xe</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;jmp &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]))</span><br><span class="line">        i=i+<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0xf</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i +<span class="string">&quot;and a, 80&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        test a a&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        jnz &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]))</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x10</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i +<span class="string">&quot;and a, 80&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        test a a&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;        jz &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]))</span><br><span class="line">        i+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x11</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;inc R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x12</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;dec R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x13</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;add R&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x14</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;sub R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x15</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;xor R&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x16</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;and R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x17</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;or R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x19</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mov R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x1A</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mov R&#123;&#125; R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x1B</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mov R&#123;&#125; [R&#123;&#125;]&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x1C</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mov [R&#123;&#125;] R&#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]-<span class="number">1</span>))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">0x1D</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;_%02X:\t&quot;</span> % i + <span class="string">&quot;mul R&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(opcode[i+<span class="number">1</span>]-<span class="number">1</span>,opcode[i+<span class="number">2</span>]))</span><br><span class="line">        i=i+<span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="built_in">len</span>(opcode)-<span class="number">1</span>):</span><br><span class="line">    i=disasm(i,opcode[i])</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">_00:    mov R0 0</span><br><span class="line">_03:    mov R2 70</span><br><span class="line">_06:    jmp 21</span><br><span class="line"></span><br><span class="line">_08:    push R0</span><br><span class="line">_0A:    pop R1</span><br><span class="line">_0C:    R0=getchar()</span><br><span class="line">_0D:    push R0</span><br><span class="line">_0F:    push R1</span><br><span class="line">_11:    pop R0</span><br><span class="line">_13:    inc R0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_15:    cmp R0 R2</span><br><span class="line">        jnz 24</span><br><span class="line">        mov a, 80</span><br><span class="line">_18:    and a, 80</span><br><span class="line">        test a a</span><br><span class="line">        jnz 8</span><br><span class="line">_1A:    mov R0 0</span><br><span class="line">_1D:    mov R2 71</span><br><span class="line">_20:    jmp 70</span><br><span class="line"></span><br><span class="line">_22:    push R0</span><br><span class="line">_24:    mov R1 R5</span><br><span class="line">_27:    mul R0 4</span><br><span class="line">_2A:    sub R1 R0</span><br><span class="line">_2D:    mov R0 R1</span><br><span class="line">_30:    mov R0 [R0]</span><br><span class="line">_33:    mul R0 110</span><br><span class="line">_36:    add R0 99</span><br><span class="line">_39:    xor R0 116</span><br><span class="line">_3C:    add R0 102</span><br><span class="line">_3F:    mov [R1] R0</span><br><span class="line">_42:    pop R0</span><br><span class="line">_44:    inc R0</span><br><span class="line"></span><br><span class="line">_46:    cmp R0 R2</span><br><span class="line">        jnz 73</span><br><span class="line">        mov a, 80</span><br><span class="line">_49:    and a, 80</span><br><span class="line">        test a a</span><br><span class="line">        jnz 34</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ¯”è¾ƒé•¿ï¼Œçœ‹ä¸æ‡‚çš„è¯ç›´æ¥äº¤ç»™gptå¤„ç†ï¼Œå½“ç„¶å…¶å®é‡è¦çš„ä»£ç å°±è¿™ä¹ˆç‚¹</p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">R0 = 0         // åˆå§‹åŒ– R0 ä¸º 0</span><br><span class="line">R2 = 70        // åˆå§‹åŒ– R2 ä¸º 70</span><br><span class="line">è·³è½¬åˆ° æ ‡ç­¾1</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾0:</span><br><span class="line">å‹æ ˆ(R0)       // å°† R0 çš„å€¼å‹å…¥æ ˆ</span><br><span class="line">R1 = å¼¹æ ˆ()     // ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ªå€¼åˆ° R1</span><br><span class="line">R0 = è·å–å­—ç¬¦() // ä»è¾“å…¥ä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦åˆ° R0</span><br><span class="line">å‹æ ˆ(R0)       // å°† R0 çš„å€¼å‹å…¥æ ˆ</span><br><span class="line">å‹æ ˆ(R1)       // å°† R1 çš„å€¼å‹å…¥æ ˆ</span><br><span class="line">R0 = å¼¹æ ˆ()     // ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ªå€¼åˆ° R0</span><br><span class="line">R0 = R0 + 1    // å°† R0 å¢åŠ  1</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾1:</span><br><span class="line">å¦‚æœ (R0 != R2) &#123; // æ¯”è¾ƒ R0 å’Œ R2</span><br><span class="line">    a = 80        // å¦‚æœä¸ç›¸ç­‰ï¼Œå°† a è®¾ç½®ä¸º 80</span><br><span class="line">&#125;</span><br><span class="line">a = a &amp; 80      // æ‰§è¡Œ a å’Œ 80 çš„æŒ‰ä½ä¸æ“ä½œ</span><br><span class="line">å¦‚æœ (a != 0) &#123;   // æµ‹è¯• a æ˜¯å¦ä¸ºéé›¶</span><br><span class="line">    è·³è½¬åˆ° æ ‡ç­¾0 // å¦‚æœéé›¶ï¼Œè·³è½¬åˆ° æ ‡ç­¾0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">R0 = 0         // åˆå§‹åŒ– R0 ä¸º 0</span><br><span class="line">R2 = 71        // åˆå§‹åŒ– R2 ä¸º 71</span><br><span class="line">è·³è½¬åˆ° æ ‡ç­¾2</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾3:</span><br><span class="line">å‹æ ˆ(R0)       // å°† R0 çš„å€¼å‹å…¥æ ˆ</span><br><span class="line">R1 = 5         // è®¾ç½® R1 ä¸º 5</span><br><span class="line">R0 = R0 * 4    // å°† R0 ä¹˜ä»¥ 4</span><br><span class="line">R1 = R1 - R0   // å°† R0 ä» R1 ä¸­å‡å»</span><br><span class="line">R0 = R1        // å°†ç»“æœèµ‹ç»™ R0</span><br><span class="line">R0 = å†…å­˜[R0]  // è®¿é—®åœ°å€ä¸º R0 çš„å†…å­˜</span><br><span class="line">R0 = R0 * 110  // å°† R0 ä¹˜ä»¥ 110</span><br><span class="line">R0 = R0 + 99   // å°† R0 åŠ  99</span><br><span class="line">R0 = R0 ^ 116  // å°† R0 ä¸ 116 è¿›è¡Œå¼‚æˆ–æ“ä½œ</span><br><span class="line">R0 = R0 + 102  // å°† R0 åŠ  102</span><br><span class="line">å†…å­˜[R1] = R0  // å°†ç»“æœå­˜å‚¨å›åœ°å€ä¸º R1 çš„å†…å­˜</span><br><span class="line">R0 = å¼¹æ ˆ()     // ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ªå€¼åˆ° R0</span><br><span class="line">R0 = R0 + 1    // å°† R0 å¢åŠ  1</span><br><span class="line"></span><br><span class="line">æ ‡ç­¾2:</span><br><span class="line">å¦‚æœ (R0 != R2) &#123; // æ¯”è¾ƒ R0 å’Œ R2</span><br><span class="line">    a = 80        // å¦‚æœä¸ç›¸ç­‰ï¼Œå°† a è®¾ç½®ä¸º 80</span><br><span class="line">&#125;</span><br><span class="line">a = a &amp; 80      // æ‰§è¡Œ a å’Œ 80 çš„æŒ‰ä½ä¸æ“ä½œ</span><br><span class="line">å¦‚æœ (a != 0) &#123;   // æµ‹è¯• a æ˜¯å¦ä¸ºéé›¶</span><br><span class="line">    è·³è½¬åˆ° æ ‡ç­¾3 // å¦‚æœéé›¶ï¼Œè·³è½¬åˆ° æ ‡ç­¾3</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€é‡è¦çš„åŠ å¯†å°±åœ¨label3é‡Œé¢</p><p>æ‰¾åˆ°å¯†æ–‡å°±å¯ä»¥å†™è§£å¯†è„šæœ¬äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="type">int</span> s[]=&#123;</span><br><span class="line"><span class="number">0x36D3</span>, <span class="number">0x2AFF</span>, <span class="number">0x2ACB</span>, <span class="number">0x2B95</span>, <span class="number">0x2B95</span>, <span class="number">0x2B95</span>, <span class="number">0x169F</span>, <span class="number">0x186D</span>,</span><br><span class="line"><span class="number">0x18D7</span>, <span class="number">0x1611</span>, <span class="number">0x18D7</span>, <span class="number">0x2B95</span>, <span class="number">0x2C23</span>, <span class="number">0x2CA9</span>, <span class="number">0x1611</span>, <span class="number">0x1611</span>,</span><br><span class="line"><span class="number">0x18D7</span>, <span class="number">0x2AFF</span>, <span class="number">0x1849</span>, <span class="number">0x18FB</span>, <span class="number">0x2ACB</span>, <span class="number">0x2A71</span>, <span class="number">0x1735</span>, <span class="number">0x18D7</span>,</span><br><span class="line"><span class="number">0x1611</span>, <span class="number">0x2ACB</span>, <span class="number">0x15DD</span>, <span class="number">0x18D7</span>, <span class="number">0x2C23</span>, <span class="number">0x169F</span>, <span class="number">0x15DD</span>, <span class="number">0x2B95</span>,</span><br><span class="line"><span class="number">0x169F</span>, <span class="number">0x156B</span>, <span class="number">0x186D</span>, <span class="number">0x2AFF</span>, <span class="number">0x1611</span>, <span class="number">0x1611</span>, <span class="number">0x15DD</span>, <span class="number">0x2AFF</span>,</span><br><span class="line"><span class="number">0x2C23</span>, <span class="number">0x2ACB</span>, <span class="number">0x15DD</span>, <span class="number">0x15DD</span>, <span class="number">0x186D</span>, <span class="number">0x1849</span>, <span class="number">0x2B95</span>, <span class="number">0x156B</span>,</span><br><span class="line"><span class="number">0x1735</span>, <span class="number">0x18FB</span>, <span class="number">0x18FB</span>, <span class="number">0x2A71</span>, <span class="number">0x2AFF</span>, <span class="number">0x1735</span>, <span class="number">0x2C23</span>, <span class="number">0x15DD</span>,</span><br><span class="line"><span class="number">0x18D7</span>, <span class="number">0x2A71</span>, <span class="number">0x18D7</span>, <span class="number">0x18D7</span>, <span class="number">0x2C23</span>, <span class="number">0x2AFF</span>, <span class="number">0x156B</span>, <span class="number">0x2C23</span>,</span><br><span class="line"><span class="number">0x169F</span>, <span class="number">0x35AF</span>, <span class="number">0x2CA9</span>, <span class="number">0x32B5</span>, <span class="number">0x2AFF</span>, <span class="number">0x3039</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> c;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">69</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">c=(((s[i]<span class="number">-102</span>)^<span class="number">116</span>)<span class="number">-99</span>)/<span class="number">110</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,c);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//nctf&#123;3e1ce77b70e4cb9941d6800aec022c813d03e70a274ba96c722fed72783dddac&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VM&quot;&gt;&lt;a href=&quot;#VM&quot; class=&quot;headerlink&quot; title=&quot;VM&quot;&gt;&lt;/a&gt;VM&lt;/h1&gt;&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;ä¸€ä¸ªè™š</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ioså­¦ä¹ ç¯‡(3)-ioså¸¸è§åŠ å¯†</title>
    <link href="https://straw-233.github.io/2024/07/04/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(3)-ios%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86/"/>
    <id>https://straw-233.github.io/2024/07/04/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(3)-ios%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86/</id>
    <published>2024-07-04T13:34:00.184Z</published>
    <updated>2024-07-04T15:07:02.398Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ioså¸¸è§åŠ å¯†"><a href="#ioså¸¸è§åŠ å¯†" class="headerlink" title="ioså¸¸è§åŠ å¯†"></a>ioså¸¸è§åŠ å¯†</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>â€‹åœ¨å­¦ä¹ ç¯‡(1)ä¸­æœ‰æåŠè¿‡CCCryptï¼Œæœ€è¿‘åœ¨å­¦ä¹ ç™»å½•åŠ å¯†ç®—æ³•çš„æ—¶å€™å‘ç°iosçš„åŠ å¯†å¤§éƒ¨åˆ†éƒ½æ˜¯è°ƒç”¨å‡½æ•°åº“çš„ï¼Œç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹ç°åœ¨é‡åˆ°çš„æ¯”è¾ƒå¤šè§çš„åŠ å¯†ã€‚</p><h2 id="CC-MD5"><a href="#CC-MD5" class="headerlink" title="CC_MD5"></a>CC_MD5</h2><p>â€‹æœ€ç®€å•ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="built_in">NSString</span> *)stringWithMD5&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="type">char</span> *cStr = [<span class="keyword">self</span> UTF8String];</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> digest[CC_MD5_DIGEST_LENGTH];</span><br><span class="line">    CC_MD5( cStr, strlen(cStr), digest ); <span class="comment">// This is the md5 call</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSMutableString</span> *output = [<span class="built_in">NSMutableString</span> stringWithCapacity:CC_MD5_DIGEST_LENGTH * <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; CC_MD5_DIGEST_LENGTH; i++)</span><br><span class="line">        [output appendFormat:<span class="string">@&quot;%02x&quot;</span>, digest[i]];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>  output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CC-SHA1â€¦"><a href="#CC-SHA1â€¦" class="headerlink" title="CC_SHA1â€¦"></a>CC_SHA1â€¦</h2><p>â€‹ä¸MD5ä¸€æ ·ä¹Ÿæ¯”è¾ƒå¤šè§</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="built_in">NSString</span> *)stringWithSha1Encode&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="type">char</span> *cstr = [<span class="keyword">self</span> cStringUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithBytes:cstr length:<span class="keyword">self</span>.length];</span><br><span class="line">    <span class="comment">//ä½¿ç”¨å¯¹åº”çš„CC_SHA1,CC_SHA256,CC_SHA384,CC_SHA512çš„é•¿åº¦åˆ†åˆ«æ˜¯20,32,48,64</span></span><br><span class="line">    uint8_t digest[CC_SHA1_DIGEST_LENGTH];</span><br><span class="line">    <span class="comment">//ä½¿ç”¨å¯¹åº”çš„CC_SHA256,CC_SHA384,CC_SHA512</span></span><br><span class="line">    CC_SHA1(data.bytes, (CC_LONG)data.length, digest);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSMutableString</span>* output = [<span class="built_in">NSMutableString</span> stringWithCapacity:CC_SHA1_DIGEST_LENGTH * <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; CC_SHA1_DIGEST_LENGTH; i++)</span><br><span class="line">        [output appendFormat:<span class="string">@&quot;%02x&quot;</span>, digest[i]];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹ä¸¤ä¸ªåŠ å¯†æ‰€ç”¨åˆ°çš„å‚æ•°ä¹Ÿåªæœ‰ä¸‰ä¸ªï¼ŒåŸæ–‡ï¼ŒåŸæ–‡é•¿åº¦ï¼Œå¯†æ–‡ï¼Œéå¸¸çš„å¥½è®¤</p><h2 id="CCCrypt"><a href="#CCCrypt" class="headerlink" title="CCCrypt"></a>CCCrypt</h2><p>â€‹è¿™ä¸ªå°±æ¯”è¾ƒéš¾äº†ï¼ŒåŒ…å«äº†è®¸å¤šåˆ†ç»„å¯¹ç§°åŠ å¯†</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CCCryptorStatus CCCrypt(</span><br><span class="line">    CCOperation op,         <span class="comment">/* kCCEncrypt, etc. */</span></span><br><span class="line">    CCAlgorithm alg,        <span class="comment">/* kCCAlgorithmAES128, etc. */</span></span><br><span class="line">    CCOptions options,      <span class="comment">/* kCCOptionPKCS7Padding, etc. */</span></span><br><span class="line">    <span class="keyword">const</span> <span class="type">void</span> *key,</span><br><span class="line">    size_t keyLength,</span><br><span class="line">    <span class="keyword">const</span> <span class="type">void</span> *iv,         <span class="comment">/* optional initialization vector */</span></span><br><span class="line">    <span class="keyword">const</span> <span class="type">void</span> *dataIn,     <span class="comment">/* optional per op and alg */</span></span><br><span class="line">    size_t dataInLength,</span><br><span class="line">    <span class="type">void</span> *dataOut,          <span class="comment">/* data RETURNED here */</span></span><br><span class="line">    size_t dataOutAvailable,</span><br><span class="line">    size_t *dataOutMoved)</span><br></pre></td></tr></table></figure><h3 id="CCOperation-op"><a href="#CCOperation-op" class="headerlink" title="CCOperation op"></a>CCOperation op</h3><p>â€‹å¾ˆç®€å•ï¼ŒåŠ å¯†kCCEncryptï¼Œè§£å¯†kCCDecrypt</p><h3 id="CCAlgorithm-alg"><a href="#CCAlgorithm-alg" class="headerlink" title="CCAlgorithm alg"></a>CCAlgorithm alg</h3><p>â€‹é€‰æ‹©åŠ å¯†ç®—æ³•</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">    kCCAlgorithmAES128 = <span class="number">0</span>,</span><br><span class="line">    kCCAlgorithmAES = <span class="number">0</span>,</span><br><span class="line">    kCCAlgorithmDES,</span><br><span class="line">    kCCAlgorithm3DES,       </span><br><span class="line">    kCCAlgorithmCAST,       </span><br><span class="line">    kCCAlgorithmRC4,</span><br><span class="line">    kCCAlgorithmRC2,   </span><br><span class="line">    kCCAlgorithmBlowfish    </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> uint32_t CCAlgorithm;</span><br></pre></td></tr></table></figure><h3 id="CCOptions-options"><a href="#CCOptions-options" class="headerlink" title="CCOptions options"></a>CCOptions options</h3><p>â€‹é€‰æ‹©æ˜¯å¦å¡«å……ï¼Œé»˜è®¤æ˜¯CBCæ¨¡å¼</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">    <span class="comment">/* options for block ciphers */</span></span><br><span class="line">    kCCOptionPKCS7Padding   = <span class="number">0x0001</span>,</span><br><span class="line">    kCCOptionECBMode        = <span class="number">0x0002</span></span><br><span class="line">    <span class="comment">/* stream ciphers currently have no options */</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> uint32_t CCOptions;</span><br></pre></td></tr></table></figure><h3 id="const-void-key"><a href="#const-void-key" class="headerlink" title="const void *key"></a>const void *key</h3><p>â€‹ä¼ å…¥çš„å¯†é’¥ï¼Œç»è¿‡ä»cstring utf8è½¬æˆå­—èŠ‚ç±»å‹</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> keyPtr[kCCKeySizeAES256 + <span class="number">1</span>];<span class="comment">//é€‰æ‹©aes256åŠ å¯†ï¼Œæ‰€ä»¥keyé•¿åº¦åº”è¯¥æ˜¯kCCKeySizeAES256ï¼Œ32ä½</span></span><br><span class="line">bzero(keyPtr, <span class="keyword">sizeof</span>(keyPtr));<span class="comment">//æ¸…é›¶</span></span><br><span class="line">[key getCString:keyPtr maxLength:<span class="keyword">sizeof</span>(keyPtr) encoding:<span class="built_in">NSUTF8StringEncoding</span>];<span class="comment">//ç§˜é’¥keyè½¬æˆcString</span></span><br></pre></td></tr></table></figure><p>â€‹éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœè¿™é‡Œç”³è¯·çš„ç©ºé—´ä¸å¤Ÿï¼ŒåŠ è§£å¯†ä¼šå‡ºç°é—®é¢˜çš„ï¼Œä¼ å…¥çš„å¯†é’¥è¿‡é•¿ï¼Œä¼šè‡ªåŠ¨æˆªå–ï¼Œå¯†é’¥é•¿åº¦ä¸å¤Ÿï¼Œè‡ªåŠ¨è¡¥å…¨</p><h3 id="size-t-keyLength"><a href="#size-t-keyLength" class="headerlink" title="size_t keyLength"></a>size_t keyLength</h3><p>â€‹è¿™é‡Œæ˜¯çœŸæ­£å†³å®šå¯†é’¥é•¿åº¦çš„åœ°æ–¹ï¼Œå¯é€‰åˆ—è¡¨æ˜¯ä¸‹é¢è¿™äº›</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> &#123;</span><br><span class="line">    kCCKeySizeAES128          = <span class="number">16</span>,</span><br><span class="line">    kCCKeySizeAES192          = <span class="number">24</span>,</span><br><span class="line">    kCCKeySizeAES256          = <span class="number">32</span>,</span><br><span class="line">    kCCKeySizeDES             = <span class="number">8</span>,</span><br><span class="line">    kCCKeySize3DES            = <span class="number">24</span>,</span><br><span class="line">    kCCKeySizeMinCAST         = <span class="number">5</span>,</span><br><span class="line">    kCCKeySizeMaxCAST         = <span class="number">16</span>,</span><br><span class="line">    kCCKeySizeMinRC4          = <span class="number">1</span>,</span><br><span class="line">    kCCKeySizeMaxRC4          = <span class="number">512</span>,</span><br><span class="line">    kCCKeySizeMinRC2          = <span class="number">1</span>,</span><br><span class="line">    kCCKeySizeMaxRC2          = <span class="number">128</span>,</span><br><span class="line">    kCCKeySizeMinBlowfish     = <span class="number">8</span>,</span><br><span class="line">    kCCKeySizeMaxBlowfish     = <span class="number">56</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="const-void-iv"><a href="#const-void-iv" class="headerlink" title="const void *iv"></a>const void *iv</h3><p>â€‹åç§»</p><h3 id="const-void-dataIn-size-t-dataInLength"><a href="#const-void-dataIn-size-t-dataInLength" class="headerlink" title="const void *dataIn,size_t dataInLength"></a>const void *dataIn,size_t dataInLength</h3><p>â€‹æ˜æ–‡å’Œæ˜æ–‡é•¿åº¦</p><h3 id="void-dataOut-size-t-dataOutAvailable-size-t-dataOutMoved"><a href="#void-dataOut-size-t-dataOutAvailable-size-t-dataOutMoved" class="headerlink" title="void *dataOut,size_t dataOutAvailable,size_t *dataOutMoved"></a>void *dataOut,size_t dataOutAvailable,size_t *dataOutMoved</h3><p>â€‹å¯†æ–‡ï¼Œå¯†æ–‡å—ï¼Œè¢«å†™å…¥å¯†æ–‡çš„å¯†æ–‡å—é•¿åº¦</p><h2 id="SecKeyEncrypt"><a href="#SecKeyEncrypt" class="headerlink" title="SecKeyEncrypt"></a>SecKeyEncrypt</h2><p>â€‹ç”¨åœ¨RSAåŠ å¯†ä¸­ä¼šæ¯”è¾ƒå¤š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SecKeyEncrypt(key, kSecPaddingPKCS1,(<span class="keyword">const</span> uint8_t *)[buffer bytes],[buffer length],cipherBuffer,&amp;cipherBufferSize);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>â€‹ä¸»è¦äº†è§£äº†åŠ å¯†å‡½æ•°ï¼Œä»¥åŠå¯¹åº”çš„å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨frida-traceå»è·Ÿè¸ªappç™»å½•æ—¶çš„è°ƒç”¨å‡½æ•°ï¼Œä½¿ç”¨ä¿®æ”¹fridaçš„handlersè„šæœ¬ï¼Œæ¥è·å–æ˜æ–‡å¯†æ–‡ï¼Œæ¥åˆ†æåŠ å¯†è¿‡ç¨‹ã€‚</p><h2 id="ä¾‹å­-å–œæŸæŸé›…çš„ç™»å½•åŠ å¯†ç®—æ³•"><a href="#ä¾‹å­-å–œæŸæŸé›…çš„ç™»å½•åŠ å¯†ç®—æ³•" class="headerlink" title="ä¾‹å­-å–œæŸæŸé›…çš„ç™»å½•åŠ å¯†ç®—æ³•"></a>ä¾‹å­-å–œæŸæŸé›…çš„ç™»å½•åŠ å¯†ç®—æ³•</h2><p>â€‹é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨Charleså¯¹æ‰‹æœºè¿›è¡Œä»£ç†æŠ“åŒ…ï¼ŒæŠ“å–ç™»å½•æ—¶çš„å‘åŒ…ä¸å“åº”</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(3)-ios%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86/%E6%8A%93%E5%8C%85.png" alt="æŠ“åŒ…"></p><p>â€‹ç„¶åæˆ‘ä»¬å°è¯•ä½¿ç”¨ä¿®æ”¹è¿½è¸ªè„šæœ¬çš„æ–¹å¼ï¼ŒæŸ¥æ‰¾æˆ‘ä»¬çš„è¾“å…¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Auto-generated by Frida. Please modify to match the signature of SecKeyEncrypt.</span></span><br><span class="line"><span class="comment"> * This stub is currently auto-generated from manpages when available.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * For full API reference, see: https://frida.re/docs/javascript-api/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Called synchronously when about to call SecKeyEncrypt.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@this</span> &#123;<span class="type">object</span>&#125; - Object allowing you to store state for use in onLeave.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">log</span> - Call this function with a string to be presented to the user.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">array</span>&#125; <span class="variable">args</span> - Function arguments represented as an array of NativePointer objects.</span></span><br><span class="line"><span class="comment">   * For example use args[0].readUtf8String() if the first argument is a pointer to a C string encoded as UTF-8.</span></span><br><span class="line"><span class="comment">   * It is also possible to modify arguments by assigning a NativePointer object to an element of this array.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; <span class="variable">state</span> - Object allowing you to keep state across function calls.</span></span><br><span class="line"><span class="comment">   * Only one JavaScript function will execute at a time, so do not worry about race-conditions.</span></span><br><span class="line"><span class="comment">   * However, do not use this to store function arguments across onEnter/onLeave, but instead</span></span><br><span class="line"><span class="comment">   * use &quot;this&quot; which is an object for keeping state local to an invocation.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">onEnter</span>(<span class="params">log, args, state</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt()&#x27;</span>);</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() key:&#x27;</span> + <span class="title function_">hexdump</span>(args[<span class="number">0</span>]));</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() padding:&#x27;</span> + (args[<span class="number">1</span>]).<span class="title function_">toInt32</span>());</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() plainText:&#x27;</span> + (args[<span class="number">2</span>]).<span class="title function_">readCString</span>());</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() plainTextSize:&#x27;</span> + (args[<span class="number">3</span>]).<span class="title function_">toInt32</span>());</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">args4</span>=args[<span class="number">4</span>];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">args5</span>=args[<span class="number">5</span>];</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Called synchronously when about to return from SecKeyEncrypt.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * See onEnter for details.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@this</span> &#123;<span class="type">object</span>&#125; - Object allowing you to access state stored in onEnter.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">log</span> - Call this function with a string to be presented to the user.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">NativePointer</span>&#125; <span class="variable">retval</span> - Return value represented as a NativePointer object.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; <span class="variable">state</span> - Object allowing you to keep state across function calls.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">onLeave</span>(<span class="params">log, retval, state</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() cipherText:&#x27;</span>+<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">args4</span>));</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;SecKeyEncrypt() cipherTextSize:&#x27;</span>+(<span class="variable language_">this</span>.<span class="property">args5</span>).<span class="title function_">readInt</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Auto-generated by Frida. Please modify to match the signature of CC_SHA1.</span></span><br><span class="line"><span class="comment"> * This stub is currently auto-generated from manpages when available.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * For full API reference, see: https://frida.re/docs/javascript-api/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Called synchronously when about to call CC_SHA1.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@this</span> &#123;<span class="type">object</span>&#125; - Object allowing you to store state for use in onLeave.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">log</span> - Call this function with a string to be presented to the user.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">array</span>&#125; <span class="variable">args</span> - Function arguments represented as an array of NativePointer objects.</span></span><br><span class="line"><span class="comment">   * For example use args[0].readUtf8String() if the first argument is a pointer to a C string encoded as UTF-8.</span></span><br><span class="line"><span class="comment">   * It is also possible to modify arguments by assigning a NativePointer object to an element of this array.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; <span class="variable">state</span> - Object allowing you to keep state across function calls.</span></span><br><span class="line"><span class="comment">   * Only one JavaScript function will execute at a time, so do not worry about race-conditions.</span></span><br><span class="line"><span class="comment">   * However, do not use this to store function arguments across onEnter/onLeave, but instead</span></span><br><span class="line"><span class="comment">   * use &quot;this&quot; which is an object for keeping state local to an invocation.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">onEnter</span>(<span class="params">log, args, state</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;CC_SHA1() onEnter:&#x27;</span> + args[<span class="number">0</span>].<span class="title function_">readCString</span>(args[<span class="number">1</span>].<span class="title function_">toInt32</span>()));</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">args2</span> =args[<span class="number">2</span>];</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Called synchronously when about to return from CC_SHA1.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * See onEnter for details.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@this</span> &#123;<span class="type">object</span>&#125; - Object allowing you to access state stored in onEnter.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">function</span>&#125; <span class="variable">log</span> - Call this function with a string to be presented to the user.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">NativePointer</span>&#125; <span class="variable">retval</span> - Return value represented as a NativePointer object.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">object</span>&#125; <span class="variable">state</span> - Object allowing you to keep state across function calls.</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="title function_">onLeave</span>(<span class="params">log, retval, state</span>) &#123;</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;CC_SHA1() onLeave:&#x27;</span> + <span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">args2</span>,&#123;<span class="attr">length</span>:<span class="number">20</span>&#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨frida-trace -U -i CCCrypt -i CC_MD5 -i  CC_SHA1 -i SecKeyEncrypt -f com.gemd.itingè·Ÿè¸ªï¼Œç™»å½•è´¦å·</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(3)-ios%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86/%E9%AA%8C%E8%AF%81.png" alt="éªŒè¯"></p><p>æˆ‘ä»¬å¯ä»¥è½»æ¾çœ‹å‡ºæˆ‘ä»¬è¾“å…¥çš„è´¦å·ï¼ˆæ‰‹æœºå·ï¼‰ä¸å¯†ç æ•°æ®å…ˆè¿›è¡Œäº†ä¸€æ¬¡RSAåŠ å¯†ï¼Œç„¶åå†è¿›è¡Œäº†ä¸€æ¬¡SHA1åŠ å¯†ï¼Œ</p><p>ç„¶åå‘ç°SHA1çš„æ˜æ–‡æ˜¯å¥½å¤šè¿›è¡Œäº†RSAåŠ å¯†åçš„æ•°æ®ï¼ŒåŒ…æ‹¬è´¦å·å¯†ç ï¼ŒSHA1çš„è¿”å›å€¼å°±æ˜¯æˆ‘ä»¬çš„signatureç­¾åï¼Œè€ŒRSAåŠ å¯†çš„æ•°æ®ä»¥base64çš„æ–¹å¼æ˜¾ç¤ºå‡ºæ¥</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(3)-ios%E5%B8%B8%E8%A7%81%E5%8A%A0%E5%AF%86/base64.png" alt="base64"></p><p>ï¼ˆè¯¥å›¾ä¸ºå‰ä¸€æ¬¡å‘åŒ…ï¼Œæ•°æ®ä¸ä¸€æ ·ï¼Œåªæä¾›åŠ å¯†é€»è¾‘ï¼‰</p><p>è‡³æ­¤æˆ‘ä»¬åªè¦è·å–RSAçš„å¯†é’¥å³å¯ç ´è§£ç™»å½•æ£€éªŒçš„åŠ å¯†ç®—æ³•</p><p><img src="/../img/%E5%B7%B2%E8%80%81%E5%AE%9E.jpg" alt="å·²è€å®"></p><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://www.jianshu.com/p/93466b31f675">https://www.jianshu.com/p/93466b31f675</a></p><p><a href="https://www.cnblogs.com/francisblogs/p/7447330.html">iOSå¸¸ç”¨åŠ å¯†ä¹‹RSAåŠ å¯†è§£å¯† - Francis01 - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ioså¸¸è§åŠ å¯†&quot;&gt;&lt;a href=&quot;#ioså¸¸è§åŠ å¯†&quot; class=&quot;headerlink&quot; title=&quot;ioså¸¸è§åŠ å¯†&quot;&gt;&lt;/a&gt;ioså¸¸è§åŠ å¯†&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶</title>
    <link href="https://straw-233.github.io/2024/06/30/maimaidx%E5%AF%BC%E5%88%86%E6%9F%A5%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/"/>
    <id>https://straw-233.github.io/2024/06/30/maimaidx%E5%AF%BC%E5%88%86%E6%9F%A5%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/</id>
    <published>2024-06-30T07:10:05.866Z</published>
    <updated>2024-06-30T08:31:28.362Z</updated>
    
    <content type="html"><![CDATA[<h1 id="maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶"><a href="#maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶" class="headerlink" title="maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶"></a>maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>â€‹åŸå› æ˜¯ä¸€ä¸ªmaimaièœé¸¡+æ®‹ç–¾äººï¼Œä¹ æƒ¯äº†ä½¿ç”¨breakä¸€é”®å¯¼åˆ†ï¼Œè€Œåœ¨çªç„¶çš„æŸä¸€å¤©breakå¯„äº†ä»¥åï¼Œçªå‘å¥‡æƒ³ï¼Œæƒ³æä¸€ä¸ªæœ¬åœ°çš„breakè¿›è¡Œè‡ªå·±æœ¬åœ°çš„ä¸€é”®å¯¼åˆ†ä¸€é”®æŸ¥åˆ†ã€‚è¿›è¡Œä½œä¸ºä¸€ä¸ªå­¦é€†å‘çš„ï¼Œæè¿™ç§webå’Œçˆ¬è™«çš„ä¸œè¥¿ä»å¤´å­¦èµ·çœŸçš„å¾ˆéš¾ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¸æ˜¯webä»”ï¼Ÿï¼Ÿ</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/0.png" alt="0"></p><h2 id="æ‰‹æœºä¸‹çš„æŠ“åŒ…"><a href="#æ‰‹æœºä¸‹çš„æŠ“åŒ…" class="headerlink" title="æ‰‹æœºä¸‹çš„æŠ“åŒ…"></a>æ‰‹æœºä¸‹çš„æŠ“åŒ…</h2><p>â€‹å› ä¸ºä¹‹å‰æœ‰æŸoçš„å¯¼å…¥æŠ½å¡æ•°æ®çš„ç»éªŒï¼Œè¿™è¾¹å°è¯•ç”¨æ‰‹æœºä¸Šçš„æŠ“åŒ…å·¥å…·streamè¿›è¡Œå¯¹maimaiå®˜æ–¹çš„ç½‘é¡µæŠ“åŒ…çš„ï¼Œç»“æœç›´æ¥å¥½åƒè¢«banäº†ï¼Œå¯èƒ½æ˜¯å¾®ä¿¡æ£€æµ‹å‡ºæ¥äº†ã€‚ã€‚ã€‚</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/1.png" alt="1"></p><h2 id="windowsä¸‹çš„æŠ“åŒ…"><a href="#windowsä¸‹çš„æŠ“åŒ…" class="headerlink" title="windowsä¸‹çš„æŠ“åŒ…"></a>windowsä¸‹çš„æŠ“åŒ…</h2><p>â€‹å› ä¸ºåœ¨å¾®ä¿¡ä¸­è®¿é—®ç½‘é¡µæ˜¯ç”¨å¾®ä¿¡è‡ªå¸¦çš„æµè§ˆå™¨è¿›è¡Œè®¿é—®çš„ï¼Œæ— æ³•è¿›è¡ŒF12æŸ¥çœ‹æºç ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æŠ“åŒ…å·¥å…·è¿›è¡ŒæŠ“åŒ…ï¼Œå†è¿›è¡Œé‡å‘åŒ…è®¿é—®ã€‚</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/2.png" alt="2"></p><p>æœ€æœ‰ç”¨çš„è¿˜æ˜¯è¿™ä¸ªuserid</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/3.png" alt="3"></p><p>ç”¨hackbarè¿›è¡Œé‡å‘åŒ…ï¼Œæ”¹ä¸ªCookieçš„æ•°æ®å°±å¯ä»¥è®©ç½‘é¡µæ­£å¸¸åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºäº†</p><p>ç„¶ååšä¸€ä¸ªç®€å•pythonè„šæœ¬è¿›è¡Œçˆ¬è™«ï¼Œå°†æœ‰ç”¨çš„ç½‘é¡µçš„æºç dumpä¸‹æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">session = requests.Session()</span><br><span class="line">url1 = <span class="string">&#x27;https://maimai.wahlap.com/maimai-mobile/record/musicGenre/search/?genre=99&amp;diff=0&#x27;</span></span><br><span class="line">url2 = <span class="string">&#x27;https://maimai.wahlap.com/maimai-mobile/record/musicGenre/search/?genre=99&amp;diff=1&#x27;</span></span><br><span class="line">url3 = <span class="string">&#x27;https://maimai.wahlap.com/maimai-mobile/record/musicGenre/search/?genre=99&amp;diff=2&#x27;</span></span><br><span class="line">url4 = <span class="string">&#x27;https://maimai.wahlap.com/maimai-mobile/record/musicGenre/search/?genre=99&amp;diff=3&#x27;</span></span><br><span class="line">url5 = <span class="string">&#x27;https://maimai.wahlap.com/maimai-mobile/record/musicGenre/search/?genre=99&amp;diff=4&#x27;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;maimai.wahlap.com&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36 NetType/WIFI MicroMessenger/7.0.20.1781(0x6700143B) WindowsWechat(0x63090b11) XWEB/8555 Flue&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;navigate&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="string">&#x27;?1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;document&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;_t=053aec723085f36dd132b8af227c0658; userId=2352886346959880;&#x27;</span><span class="comment">#æ¯ä¸ªäººçš„éƒ½ä¸ä¸€æ ·</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response_basic = session.get(url=url1, headers=headers)</span><br><span class="line">response_advance = session.get(url=url2, headers=headers)</span><br><span class="line">response_expert = session.get(url=url3, headers=headers)</span><br><span class="line">response_master = session.get(url=url4, headers=headers)</span><br><span class="line">response_rema = session.get(url=url5, headers=headers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response_basic.text:</span><br><span class="line">    <span class="comment"># æ‰“å¼€ä¸€ä¸ªè®°äº‹æœ¬æ–‡ä»¶å¹¶å†™å…¥å“åº”æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_basic.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(response_basic.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;basicè¡¨å·²ä¿å­˜&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚æœªå†™å…¥basicè¡¨ã€‚&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response_advance.text:</span><br><span class="line">    <span class="comment"># æ‰“å¼€ä¸€ä¸ªè®°äº‹æœ¬æ–‡ä»¶å¹¶å†™å…¥å“åº”æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_advance.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(response_advance.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;advanceè¡¨å·²ä¿å­˜&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚æœªå†™å…¥advanceè¡¨ã€‚&quot;</span>)    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response_expert.text:</span><br><span class="line">    <span class="comment"># æ‰“å¼€ä¸€ä¸ªè®°äº‹æœ¬æ–‡ä»¶å¹¶å†™å…¥å“åº”æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_expert.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(response_expert.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;expertè¡¨å·²ä¿å­˜&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚æœªå†™å…¥expertè¡¨ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response_master.text:</span><br><span class="line">    <span class="comment"># æ‰“å¼€ä¸€ä¸ªè®°äº‹æœ¬æ–‡ä»¶å¹¶å†™å…¥å“åº”æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_master.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(response_master.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;masterè¡¨å·²ä¿å­˜&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚æœªå†™å…¥masterè¡¨ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response_rema.text:</span><br><span class="line">    <span class="comment"># æ‰“å¼€ä¸€ä¸ªè®°äº‹æœ¬æ–‡ä»¶å¹¶å†™å…¥å“åº”æ–‡æœ¬</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_rema.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(response_rema.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;remaè¡¨å·²ä¿å­˜&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•ã€‚æœªå†™å…¥remaè¡¨ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/4.png" alt="4"></p><p>dumpä¸‹æ¥5ä¸ªç­‰çº§çš„ç½‘é¡µæºç </p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/5.png" alt="5"></p><p>æ‰¾åˆ°è¦å¤„ç†çš„æ•°æ®ï¼Œå†™ä¸ªè„šæœ¬ç”¨BeautifulSoupæŠ“å–æœ‰ç”¨çš„æ•°æ®å¹¶å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;info_rema.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    data = file.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨BeautifulSoupè§£æHTML</span></span><br><span class="line">soup = BeautifulSoup(data, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥æå–ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_music_info</span>(<span class="params">div</span>):</span><br><span class="line">    level = div.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;music_lv_block&#x27;</span>).text.strip()</span><br><span class="line">    name = div.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;music_name_block&#x27;</span>).text.strip()</span><br><span class="line">    score_block = div.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;music_score_block w_112 t_r f_l f_12&#x27;</span>)</span><br><span class="line">    score = score_block.text.strip() <span class="keyword">if</span> score_block <span class="keyword">else</span> <span class="string">&#x27;æœªè¿›è¡Œæ¸¸ç©&#x27;</span></span><br><span class="line">    details_block = div.find(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;music_score_block w_190 t_r f_l f_12&#x27;</span>)</span><br><span class="line">    details = details_block.text.strip() <span class="keyword">if</span> details_block <span class="keyword">else</span> <span class="string">&#x27;æœªè¿›è¡Œæ¸¸ç©&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">        <span class="string">&#x27;score&#x27;</span>: score,</span><br><span class="line">        <span class="string">&#x27;details&#x27;</span>: details,</span><br><span class="line">        <span class="string">&#x27;level&#x27;</span>: level</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥æ‰¾æ‰€æœ‰ç›¸å…³çš„div</span></span><br><span class="line">divs = soup.find_all(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;w_450 m_15 p_r f_0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–æ¯ä¸ªdivçš„ä¿¡æ¯</span></span><br><span class="line">music_info_list = [extract_music_info(div) <span class="keyword">for</span> div <span class="keyword">in</span> divs]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æå–çš„ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">for</span> info <span class="keyword">in</span> music_info_list:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ­Œæ›²å: <span class="subst">&#123;info[<span class="string">&#x27;name&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç­‰çº§ï¼š<span class="subst">&#123;info[<span class="string">&#x27;level&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æˆç»©: <span class="subst">&#123;info[<span class="string">&#x27;score&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åˆ†æ•°: <span class="subst">&#123;info[<span class="string">&#x27;details&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/6.png" alt="6"></p><p>æ•ˆæœå¦‚å›¾</p><p>å…¶å®åªè¦å°†dumpä¸‹æ¥çš„æºç ç›´æ¥äº¤ç»™æ°´é±¼ï¼Œä»–ä¹Ÿèƒ½å¯¼å…¥ä½ çš„æˆç»©</p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html">https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html</a></p><p>â€‹ç ”ç©¶äº†ä¸€éå¾®ä¿¡å¼€å‘è€…æ–‡æ¡£ï¼Œå› ä¸ºå¾®ä¿¡è‡ªå¸¦çš„æµè§ˆå™¨æœ‰ä¸€ä¸ªè‡ªåŠ¨ç½‘é¡µæˆæƒï¼Œé€šè¿‡OAuth2.0æœºåˆ¶å®ç°çš„ï¼ŒåŸç†å¤§æ¦‚æ˜¯å…ˆå°†ç”¨æˆ·ä¿¡æ¯å‘ç»™maimaiå®˜ç½‘ï¼Œç„¶åè¿”å›ä¸€ä¸ªæš‚æ—¶çš„useridï¼Œç„¶åå†setcookieè¿™ä¸ªuseridè¿›è¡Œè®¿é—®ä½ çš„è´¦å·ç½‘é¡µã€‚</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/7.png" alt="7"></p><p>â€‹å…³é”®å°±åœ¨äºè¿™ä¸ªåŠ¨æ€useridçš„è·å–äº†ï¼Œå¦‚æœèƒ½é€šè¿‡æŸç§æ–¹æ³•èƒ½ç¨³å®šè·å¾—è¿™ä¸ªï¼Œé‚£ä¹ˆä¸€é”®æŸ¥è¯¢æ‰€æœ‰äººçš„è´¦å·åˆ†æ•°å²‚ä¸æ˜¯æ˜“å¦‚åæŒï¼Ÿç„¶è€Œé—®äº†å¥½å¤šäººï¼ŒæŸ¥äº†å¥½å¤šèµ„æ–™ï¼Œè¿˜æ˜¯ä¸çŸ¥é“è¿™ä¸ªæ–¹æ³•æ˜¯ä»€ä¹ˆã€‚ã€‚ã€‚</p><h2 id="ä»£ç†æŠ“åŒ…"><a href="#ä»£ç†æŠ“åŒ…" class="headerlink" title="ä»£ç†æŠ“åŒ…"></a>ä»£ç†æŠ“åŒ…</h2><p>â€‹æœ€åè¿˜æ˜¯å›å½’æœ€åŸå§‹çš„ä»£ç†æŠ“åŒ…æ–¹æ³•ã€‚</p><p>â€‹ä¼ ç»Ÿçš„ä»£ç†çš„åŸç†å¤§æ¦‚æ˜¯:</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/8.png" alt="8"></p><p>â€‹æˆ‘è‡ªå·±ä½¿ç”¨charlesä¸æ‰‹æœºè¿æ¥ï¼Œç„¶åæŠ“å–çš„ç½‘é¡µæºç </p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/9.png" alt="9"></p><p>â€‹å½“ç„¶å…¶ä»–ç©å®¶å·²ç»æœ‰å¾ˆå®Œå–„çš„å¯¼å…¥ç½‘é¡µäº†ï¼Œå¤§å®¶å¯ä»¥å»çœ‹çœ‹<a href="https://maimai.bakapiano.com/">https://maimai.bakapiano.com</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>â€‹å› ä¸ºåœ¨å­¦iosé€†å‘ï¼Œé¦–å…ˆè¦å­¦ç‚¹åŸºç¡€ï¼Œè™½ç„¶æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦å­¦è¿™ä¸ªã€‚ã€‚ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœèƒ½æˆåŠŸææ‡‚useridçš„åŠ å¯†è§£å¯†ä¼ è¾“è¿‡ç¨‹ï¼Œè¯´ä¸å®šå°±å¯ä»¥ä¸éœ€è¦ä»£ç†ï¼Œå®ç°ä¸€é”®å¯¼å…¥ï¼</p><p><img src="/../img/maimaidx%E5%AF%BC%E5%88%86%E5%99%A8%E7%A0%94%E7%A9%B6/%E7%AC%91.jpg" alt="ç¬‘"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶&quot;&gt;&lt;a href=&quot;#maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶&quot; class=&quot;headerlink&quot; title=&quot;maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶&quot;&gt;&lt;/a&gt;maimaidxå¯¼åˆ†æŸ¥åˆ†å™¨ç ”ç©¶&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>åˆ†ç»„åŠ å¯†åŠæ¨¡å¼</title>
    <link href="https://straw-233.github.io/2024/05/27/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F/"/>
    <id>https://straw-233.github.io/2024/05/27/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E6%A8%A1%E5%BC%8F/</id>
    <published>2024-05-27T13:38:45.253Z</published>
    <updated>2024-05-27T13:43:29.284Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆ†ç»„åŠ å¯†åŠæ¨¡å¼"><a href="#åˆ†ç»„åŠ å¯†åŠæ¨¡å¼" class="headerlink" title="åˆ†ç»„åŠ å¯†åŠæ¨¡å¼"></a>åˆ†ç»„åŠ å¯†åŠæ¨¡å¼</h1><p>æœ€è¿‘æ„Ÿè§‰åšäº†å¾ˆå¤šåˆ†ç»„åŠ å¯†çš„é¢˜ï¼Œæ¯æ¬¡è§£å¯†çš„æ¨¡å¼éƒ½æ˜¯èµ›åšå¨å­ä¸€ä¸ªä¸€ä¸ªè¯•è¿‡æ¥çš„ï¼Œé€»è¾‘å•¥çš„ä¹Ÿæœ‰ç‚¹ä¸ç†è§£ï¼Œåœ¨æ¯”èµ›é‡Œæœ€å¤´ç–¼çš„å°±æ˜¯è¿™ç§æ¯”è¾ƒéš¾çš„åŠ å¯†äº†ï¼Œä¸»è¦ä¸çŸ¥é“ä¸ºä»€ä¹ˆé”™ï¼Œæƒ³ä¸€æ­¥ä¸€æ­¥åˆ†ææ­¥éª¤ï¼Œåˆå¾ˆéš¾çœ‹ï¼Œæœ€ç»ˆè¿˜æ˜¯å¾—å½’æ€»ä¸€ä¸‹ã€‚</p><p><img src="/../img/%E9%BE%9F%E9%BE%9F.gif" alt="é¾Ÿé¾Ÿ"></p><h2 id="å¸¸è§åˆ†ç»„åŠ å¯†"><a href="#å¸¸è§åˆ†ç»„åŠ å¯†" class="headerlink" title="å¸¸è§åˆ†ç»„åŠ å¯†"></a>å¸¸è§åˆ†ç»„åŠ å¯†</h2><p>AES,DES,blowfish,sm4â€¦â€¦(æ¯”èµ›é‡Œç°åœ¨åªé‡åˆ°è¿™äº›ï¼Œä»¥åé‡åˆ°äº†ä¼šç»§ç»­è¡¥å……)</p><h2 id="KEY"><a href="#KEY" class="headerlink" title="KEY"></a>KEY</h2><p>å¯†é’¥æ˜¯åŠ å¯†ä¸­æœ€å…³é”®çš„ä¸€ä¸ªä¸œè¥¿ï¼Œä¹Ÿæ˜¯è§£å¯†ä¸­ä¸å¯è·å–çš„ä¸œè¥¿ï¼Œä»¥ä¸‹ä¸ºå„ç§åˆ†ç»„åŠ å¯†çš„è¡¨ï¼š</p><table><thead><tr><th>åŠ å¯†æ–¹å¼</th><th>AES</th><th>DES</th><th>Blowfish</th><th>SM4</th></tr></thead><tbody><tr><td>å¯†é’¥é•¿åº¦(ä½&#x3D;8bits)</td><td>16&#x2F;24&#x2F;32</td><td>8</td><td>4â€”56</td><td>16</td></tr><tr><td>é‡å¤æ¬¡æ•°</td><td>10&#x2F;12&#x2F;14</td><td>16</td><td>16</td><td>32</td></tr><tr><td>åˆ†ç»„é•¿åº¦(ä½)</td><td>16</td><td>8</td><td>8</td><td>16</td></tr></tbody></table><p>ç‰¢è®°è¿™äº›èƒ½æœ‰æ•ˆå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­æˆ–è€…æ˜¯ç¡®è®¤åŠ å¯†ç±»å‹ã€‚</p><h2 id="IV"><a href="#IV" class="headerlink" title="IV"></a>IV</h2><p>IVï¼ˆInitialization Vectorï¼‰æ˜¯è®¸å¤šä»»åŠ¡ä½œæ¨¡å¼ä¸­ç”¨äºå°†åŠ å¯†éšæœºåŒ–çš„ä¸€ä¸ªä½å—ï¼Œç”±æ­¤å³ä½¿åŒæ ·çš„æ˜æ–‡è¢«å¤šæ¬¡åŠ å¯†ä¹Ÿä¼šäº§ç”Ÿä¸åŒçš„å¯†æ–‡ï¼Œé¿å…äº†è¾ƒæ…¢çš„é‡æ–°äº§ç”Ÿå¯†é’¥çš„è¿‡ç¨‹ã€‚æ˜¯åŒºåˆ«ECBæ¨¡å¼å’ŒCBCæ¨¡å¼çš„å…³é”®ã€‚<strong>IVçš„é•¿åº¦ä¸€èˆ¬å’Œåˆ†ç»„é•¿åº¦ç›¸åŒã€‚</strong></p><h2 id="ECBæ¨¡å¼"><a href="#ECBæ¨¡å¼" class="headerlink" title="ECBæ¨¡å¼"></a>ECBæ¨¡å¼</h2><p>æœ€ç®€å•çš„åŠ å¯†æ¨¡å¼å³ä¸ºç”µå­å¯†ç æœ¬ï¼ˆElectronic codebookï¼ŒECBï¼‰æ¨¡å¼ã€‚éœ€è¦åŠ å¯†çš„æ¶ˆæ¯æŒ‰ç…§å—å¯†ç çš„å—å¤§å°è¢«åˆ†ä¸ºæ•°ä¸ªå—ï¼Œå¹¶å¯¹æ¯ä¸ªå—è¿›è¡Œç‹¬ç«‹åŠ å¯†ã€‚</p><p>åœ¨è¿™ç§å·¥ä½œæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªæ˜æ–‡ç»„åªèƒ½å›ºå®šåœ°è¢«åŠ å¯†æˆä¸€ä¸ªå¯¹åº”çš„å¯†æ–‡ç»„ï¼Œä¸€ä¸ªå¯†æ–‡ç»„ä¹Ÿåªèƒ½å›ºå®šåœ°è¢«è§£å¯†æˆå¯¹åº”çš„å¯†æ–‡ç»„ã€‚ä»–ä»¬å½¼æ­¤æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚è®¾æƒ³æˆ‘ä»¬æœ‰ä¸€ä¸ªåšåšçš„å¯†ç æœ¬ï¼Œæ¯æ¬¡åŠ å¯†æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä»å¯†ç æœ¬ä¸­æŸ¥å‡ºæ˜æ–‡æ‰€å¯¹åº”çš„å¯†æ–‡å°±å¯ä»¥ã€‚è¿™ä¹Ÿæ˜¯ç”µç æœ¬æ¨¡å¼åç§°çš„ç”±æ¥ã€‚å¯¹äºçŸ­æ¶ˆæ¯ï¼ŒECBæ¨¡å¼æ˜¯æ¯”è¾ƒé€‚ç”¨çš„ã€‚ä½†å¯¹äºé•¿æ¶ˆæ¯ï¼ŒECBæ¨¡å¼å°±ä¸å¤ªå®‰å…¨äº†ã€‚</p><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/ecb%E6%A8%A1%E5%BC%8F.png" alt="ecbæ¨¡å¼"></p><p>æœ€ç®€å•çš„EBCæ¨¡å¼ï¼Œè§£å¯†åªéœ€æ‰¾å¯†æ–‡å¯†é’¥ã€‚</p><h2 id="CBCæ¨¡å¼"><a href="#CBCæ¨¡å¼" class="headerlink" title="CBCæ¨¡å¼"></a>CBCæ¨¡å¼</h2><p>å¯†ç åˆ†ç»„é“¾æ¥ï¼ˆCBCï¼ŒCipher-block chainingï¼‰æ¨¡å¼ã€‚åœ¨CBCæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªæ˜æ–‡å—å…ˆä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–åï¼Œå†è¿›è¡ŒåŠ å¯†ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªå¯†æ–‡å—éƒ½ä¾èµ–äºå®ƒå‰é¢çš„æ‰€æœ‰æ˜æ–‡å—ã€‚åŒæ—¶ï¼Œä¸ºäº†ä¿è¯æ¯æ¡æ¶ˆæ¯çš„å”¯ä¸€æ€§ï¼Œåœ¨ç¬¬ä¸€ä¸ªå—ä¸­éœ€è¦ä½¿ç”¨åˆå§‹åŒ–å‘é‡ivã€‚</p><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/cbc%E5%8A%A0%E8%A7%A3%E5%AF%86.png" alt="cbcåŠ è§£å¯†"></p><p>å…¶å®æ˜¯EBCæ¨¡å¼çš„å¼‚æˆ–å‡çº§ç‰ˆï¼Œå¼€å±€çš„å¼‚æˆ–äº¤ç»™äº†åˆå§‹åŒ–å‘é‡ï¼Œæ‰€ä»¥ä¸€èˆ¬ivçš„é•¿åº¦è·Ÿåˆ†ç»„é•¿åº¦ç›¸åŒã€‚</p><p><strong>åŠ å¯†æ˜¯å…ˆå¼‚æˆ–å†åŠ å¯†ï¼Œè§£å¯†æ˜¯å…ˆå¼‚æˆ–å†è§£å¯†ã€‚</strong></p><p>è§£å¯†çš„è¯éœ€è¦çŸ¥é“å¯†æ–‡å¯†é’¥è¿˜æœ‰ivã€‚</p><h2 id="Padding"><a href="#Padding" class="headerlink" title="Padding"></a>Padding</h2><p>æœ‰çš„æ¨¡å¼ï¼Œç»å…¸çš„AES-CBCï¼ŒAES-ECBï¼ˆç»å¸¸è¢«å¡«å……æçº¢æ¸©è¿‡ï¼‰ï¼Œæ”¯æŒå¯¹é128æ¯”ç‰¹æ•´çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œæœ‰çš„æ¨¡å¼ä¸æ”¯æŒã€‚å¡«å……æ˜¯ç”¨å„ç§å¯ä»¥æ¢å¤çš„æ–¹æ³•æŠŠæ•°æ®æµå¡«å……ä¸º128bits&#x3D;16ä½ã€‚</p><h2 id="CFBæ¨¡å¼"><a href="#CFBæ¨¡å¼" class="headerlink" title="CFBæ¨¡å¼"></a>CFBæ¨¡å¼</h2><p>å¯†æ–‡åé¦ˆ(CFB,Cipher feedback)æ¨¡å¼ç±»ä¼¼äºCBC,å¯ä»¥å°†å—å¯†ç å˜ä¸ºè‡ªåŒæ­¥çš„æµå¯†ç ï¼Œè¿™ä¸ªæ¨¡å¼å¯ä»¥å¯¹é128æ¯”ç‰¹çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</p><p>åœ¨CFBæ¨¡å¼ä¸­ï¼ŒåŠ å¯†çš„åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>åˆå§‹å‘é‡ï¼ˆIVï¼‰è¢«åŠ å¯†ï¼Œç”Ÿæˆä¸€ä¸ªä¼ªéšæœºçš„åˆ†ç»„è¾“å‡ºã€‚</li><li>è¿™ä¸ªè¾“å‡ºä¸æ˜æ–‡çš„ä¸€éƒ¨åˆ†ï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªæ¯”ç‰¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªæ¯”ç‰¹ï¼‰è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç”Ÿæˆå¯†æ–‡ã€‚</li><li>ç”Ÿæˆçš„å¯†æ–‡éƒ¨åˆ†ä½œä¸ºä¸‹ä¸€ä¸ªåˆ†ç»„çš„è¾“å…¥æ–°IVï¼Œç»§ç»­è¿›è¡ŒåŠ å¯†ã€‚</li></ul><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/cfb%E5%8A%A0%E8%A7%A3%E5%AF%86.png" alt="cfbåŠ è§£å¯†"></p><p>CFBæ¨¡å¼çš„ç»“æ„å’Œä¸€æ¬¡æ€§å¯†ç æœ¬éå¸¸ç›¸ä¼¼ã€‚ä¸€æ¬¡æ€§å¯†ç æœ¬æ˜¯é€šè¿‡â€œæ˜æ–‡â€ä¸â€œéšæœºæ¯”ç‰¹åºåˆ—â€è¿›è¡ŒXORè¿ç®—æ¥ç”Ÿæˆâ€œå¯†æ–‡â€çš„ã€‚è€ŒCFBæ¨¡å¼åˆ™æ˜¯é€šè¿‡å°†â€œæ˜æ–‡åˆ†ç»„â€ä¸â€œå¯†ç ç®—æ³•çš„è¾“å‡ºâ€è¿›è¡ŒXORè¿ç®—æ¥ç”Ÿæˆâ€œå¯†æ–‡åˆ†ç»„â€çš„ã€‚åœ¨é€šè¿‡ XORæ¥è¿›è¡ŒåŠ å¯†è¿™ä¸€ç‚¹ä¸Šï¼Œä¸¤è€…æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚</p><p><strong>CFBæ¨¡å¼ä¸­ç”±å¯†ç ç®—æ³•æ‰€ç”Ÿæˆçš„æ¯”ç‰¹åºåˆ—ç§°ä¸ºå¯†é’¥æµã€‚åœ¨CFBæ¨¡å¼ä¸­ï¼Œå¯†ç ç®—æ³•ç›¸å¯¹äºç”¨æ¥ç”Ÿæˆå¯†é’¥æµçš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œè€Œåˆå§‹åŒ–å‘é‡ç›¸å½“äºä¼ªéšæœºæ•°ç”Ÿæˆå™¨çš„â€œç§å­â€ã€‚</strong></p><p>åœ¨CFBæ¨¡å¼ä¸­ï¼Œæ˜æ–‡æ•°æ®å¯ä»¥è¢«é€æ¯”ç‰¹åŠ å¯†ï¼Œå› æ­¤å¯ä»¥å°†CFBæ¨¡å¼çœ‹ä½œæ˜¯ä¸€ç§ä½¿ç”¨åˆ†ç»„å¯†ç æ¥å®ç°æµå¯†ç çš„æ–¹å¼ã€‚</p><h2 id="OFBæ¨¡å¼"><a href="#OFBæ¨¡å¼" class="headerlink" title="OFBæ¨¡å¼"></a>OFBæ¨¡å¼</h2><p>OFBæ¨¡å¼æ˜¯å…ˆç”¨å—åŠ å¯†å™¨ç”Ÿæˆå¯†é’¥æµï¼Œç„¶åå°†å¯†é’¥æµå’Œæ˜æ–‡æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡æµï¼Œè§£å¯†è¿‡ç¨‹æ˜¯é‡æ–°å¼‚æˆ–ä¸€æ¬¡ã€‚</p><p><strong>å¯ä»¥ä¸€æ¬¡è®¡ç®—å‡ºæ‰€æœ‰çš„å¯†é’¥æµï¼Œæ¯æ¬¡åŠ è§£å¯†åªéœ€è¦åšå¼‚æˆ–æ“ä½œã€‚</strong></p><p>è¿™ä¸ªå°±ç›¸å¯¹ç®€å•ã€‚</p><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/ofb%E5%8A%A0%E8%A7%A3%E5%AF%86.png" alt="ofbåŠ è§£å¯†"></p><h2 id="CTRæ¨¡å¼"><a href="#CTRæ¨¡å¼" class="headerlink" title="CTRæ¨¡å¼"></a>CTRæ¨¡å¼</h2><p>CTRæ¨¡å¼æ˜¯ä½¿ç”¨éšæœºæ•°ç­‰æ–¹å¼äº§ç”Ÿä¸€ä¸ªIVï¼Œç»è¿‡è®¡æ•°å™¨ç´¯åŠ +1åæ‹¼æ¥æˆä¸€ä¸ªä¸²ï¼Œå¯¹è¿™ä¸ªä¸²è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå’Œæ˜æ–‡åšå¼‚æˆ–æ“ä½œã€‚</p><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/ctr%E5%8A%A0%E8%A7%A3%E5%AF%86.png" alt="ctråŠ è§£å¯†"></p><p><strong>ä¸€èˆ¬è¿™ä¸ªéšæœºæ•°äº§ç”Ÿçš„ivä¼šæ”¾åœ¨åŠ å¯†åå¯†æ–‡çš„æœ€å‰é¢16ä½å•ç‹¬æˆä¸€ä¸ªç»„ï¼Œæˆ–è€…æ˜¯å‘Šè¯‰ä½ éšæœºæ•°çš„å€¼ï¼Œä¸ç„¶è§£å¯†çš„è¯æ ¹æœ¬æ— æ³•è§£å¯†ã€‚</strong></p><h2 id="GCMæ¨¡å¼"><a href="#GCMæ¨¡å¼" class="headerlink" title="GCMæ¨¡å¼"></a>GCMæ¨¡å¼</h2><p>GCMæ˜¯<a href="https://link.juejin.cn/?target=https://zh.wikipedia.org/zh-cn/%E8%AE%A4%E8%AF%81%E5%8A%A0%E5%AF%86">è®¤è¯åŠ å¯†</a>æ¨¡å¼ä¸­çš„ä¸€ç§ï¼Œä¸€èˆ¬åªåœ¨AESä¸­è§åˆ°ï¼Œå®ƒç»“åˆäº†ä¸¤è€…çš„ç‰¹ç‚¹(GCMä¸­çš„Gå°±æ˜¯æŒ‡GMACï¼ŒCå°±æ˜¯æŒ‡CTR)ï¼Œèƒ½åŒæ—¶ç¡®ä¿æ•°æ®çš„ä¿å¯†æ€§ã€å®Œæ•´æ€§åŠçœŸå®æ€§ï¼Œå¦å¤–ï¼Œå®ƒè¿˜å¯ä»¥æä¾›é™„åŠ æ¶ˆæ¯çš„å®Œæ•´æ€§æ ¡éªŒï¼ŒåŠ å¯†æµç¨‹å¦‚ä¸‹å›¾:</p><p><img src="/../img/%E5%88%86%E7%BB%84%E5%8A%A0%E5%AF%86%E5%8F%8A%E6%A8%A1%E5%BC%8F/GCM%E5%8A%A0%E5%AF%86.png" alt="GCMåŠ å¯†"></p><p>GCMå¯ä»¥æä¾›å¯¹æ¶ˆæ¯çš„åŠ å¯†å’Œå®Œæ•´æ€§æ ¡éªŒï¼Œå¦å¤–ï¼Œå®ƒè¿˜å¯ä»¥æä¾›é™„åŠ æ¶ˆæ¯çš„å®Œæ•´æ€§æ ¡éªŒã€‚åœ¨å®é™…åº”ç”¨åœºæ™¯ä¸­ï¼Œæœ‰äº›ä¿¡æ¯æ˜¯æˆ‘ä»¬ä¸éœ€è¦ä¿å¯†ï¼Œä½†ä¿¡æ¯çš„æ¥æ”¶è€…éœ€è¦ç¡®è®¤å®ƒçš„çœŸå®æ€§çš„ï¼Œä¾‹å¦‚æºIPï¼Œæºç«¯å£ï¼Œç›®çš„IPï¼ŒIVï¼Œç­‰ç­‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸€éƒ¨åˆ†ä½œä¸ºé™„åŠ æ¶ˆæ¯åŠ å…¥åˆ°MACå€¼çš„è®¡ç®—å½“ä¸­ã€‚ä¸‹å›¾çš„Ekè¡¨ç¤ºç”¨å¯¹ç§°ç§˜é’¥kå¯¹è¾“å…¥åšAESè¿ç®—ã€‚æœ€åï¼Œå¯†æ–‡æ¥æ”¶è€…ä¼šæ”¶åˆ°å¯†æ–‡ã€IVï¼ˆè®¡æ•°å™¨CTRçš„åˆå§‹å€¼ï¼‰ã€MACå€¼ã€‚</p><p>ä¸»è¦å‚è€ƒï¼š</p><p><a href="https://a-little-cat.github.io/2017/12/14/SM4.html">https://a-little-cat.github.io/2017/12/14/SM4.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆ†ç»„åŠ å¯†åŠæ¨¡å¼&quot;&gt;&lt;a href=&quot;#åˆ†ç»„åŠ å¯†åŠæ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;åˆ†ç»„åŠ å¯†åŠæ¨¡å¼&quot;&gt;&lt;/a&gt;åˆ†ç»„åŠ å¯†åŠæ¨¡å¼&lt;/h1&gt;&lt;p&gt;æœ€è¿‘æ„Ÿè§‰åšäº†å¾ˆå¤šåˆ†ç»„åŠ å¯†çš„é¢˜ï¼Œæ¯æ¬¡è§£å¯†çš„æ¨¡å¼éƒ½æ˜¯èµ›åšå¨å­ä¸€ä¸ªä¸€ä¸ªè¯•è¿‡æ¥çš„ï¼Œé€»è¾‘å•¥çš„ä¹Ÿæœ‰ç‚¹ä¸ç†è§£ï¼Œåœ¨æ¯”</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>2024CISCNåˆèµ› Reverseå¤ç°</title>
    <link href="https://straw-233.github.io/2024/05/27/2024%E5%9B%BD%E8%B5%9B%E5%88%9D%E8%B5%9B/"/>
    <id>https://straw-233.github.io/2024/05/27/2024%E5%9B%BD%E8%B5%9B%E5%88%9D%E8%B5%9B/</id>
    <published>2024-05-27T05:11:52.350Z</published>
    <updated>2024-05-27T05:18:32.895Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2024CISCNåˆèµ›-Reverse"><a href="#2024CISCNåˆèµ›-Reverse" class="headerlink" title="2024CISCNåˆèµ› Reverse"></a>2024CISCNåˆèµ› Reverse</h1><p>æœ€è¿‘å¤ªå¿™äº†ï¼Œç»ˆäºç­‰pyccæå®Œï¼Œæœ‰ç‚¹æ—¶é—´ï¼Œè¿›è¡Œèµ›åå¤ç°ä¸€ä¸‹</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526160836214.png" alt="image-20240526160836214"></p><p>å¯æƒœäº†å·®é“Goreverseï¼Œè¿˜éœ€å†ç»ƒç»ƒï¼Œé™¤äº†å®‰å“å…¶ä»–é¢˜éƒ½å‡ºçš„æŒºå¥½çš„</p><h2 id="asm-re"><a href="#asm-re" class="headerlink" title="asm_re"></a>asm_re</h2><p>æ±‡ç¼–çœ‹å¾—å¤ªæ…¢äº†ï¼Œä¸å¤ªç†Ÿç»ƒï¼Œç›´æ¥å–å·§æå–ä¸€ä¸‹æ”¾idaé‡Œè§£æäº†</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240425201336487.png" alt="image-20240425201336487"></p><p>ä¸€ä¸ªç®€å•çš„*+^æ“ä½œï¼Œå½“æ—¶è¿˜å¥‡æ€ªä¸ºä»€ä¹ˆæ˜¯intç±»å‹çš„å¯†æ–‡ï¼Œç°åœ¨çŸ¥é“äº†ï¼Œç¬¬ä¸€å¤©çš„ç­¾åˆ°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">int</span> pw[<span class="number">38</span>]=&#123;<span class="number">0x00001FD7</span>, <span class="number">0x000021B7</span>, <span class="number">0x00001E47</span>, <span class="number">0x00002027</span>, <span class="number">0x000026E7</span>, <span class="number">0x000010D7</span>, <span class="number">0x00001127</span>, <span class="number">0x00002007</span>, </span><br><span class="line"><span class="number">0x000011C7</span>, <span class="number">0x00001E47</span>, <span class="number">0x00001017</span>, <span class="number">0x00001017</span>, <span class="number">0x000011F7</span>, <span class="number">0x00002007</span>, <span class="number">0x00001037</span>, <span class="number">0x00001107</span>, </span><br><span class="line"><span class="number">0x00001F17</span>, <span class="number">0x000010D7</span>, <span class="number">0x00001017</span>, <span class="number">0x00001017</span>, <span class="number">0x00001F67</span>, <span class="number">0x00001017</span>, <span class="number">0x000011C7</span>, <span class="number">0x000011C7</span>, </span><br><span class="line"><span class="number">0x00001017</span>, <span class="number">0x00001FD7</span>, <span class="number">0x00001F17</span>, <span class="number">0x00001107</span>, <span class="number">0x00000F47</span>, <span class="number">0x00001127</span>, <span class="number">0x00001037</span>, <span class="number">0x00001E47</span>, </span><br><span class="line"><span class="number">0x00001037</span>, <span class="number">0x00001FD7</span>, <span class="number">0x00001107</span>, <span class="number">0x00001FD7</span>, <span class="number">0x00001107</span>, <span class="number">0x00002787</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">38</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">38</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">flag[i]=(((pw[i]<span class="number">-30</span>)^<span class="number">0x4D</span>)<span class="number">-20</span>)/<span class="number">80</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,flag[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;67e9a228e45b622c2992fb5174a4f5f5&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™ç§è·Ÿç±»å‹æœ‰å…³çš„é¢˜è¿˜æ˜¯å–œæ¬¢ç”¨cå†™</p><h2 id="android-so"><a href="#android-so" class="headerlink" title="android_so"></a>android_so</h2><p>å“åªå…è®¸çœŸæœºè°ƒè¯•ï¼Œæœ‰ç‚¹å‡ºçš„ä¸å¥½äº†ï¼Œå¯¹äºæˆ‘è¿™ç§æ¨¡æ‹Ÿå™¨ç©å®¶å¾ˆæ˜¯éš¾åšï¼Œå€Ÿäº†ä¸ªå­¦é•¿çš„çœŸæœºç©¿ã€‚</p><p>javaå±‚å°±ä¸€ä¸ªbase+des-CBCï¼Œä¸»è¦ivå’Œkeyéƒ½æ”¾åœ¨äº†soå±‚å¤„ç†ã€‚</p><p>keyèƒ½ç›´æ¥æ–­åœ¨è¿”å›é‚£è¾¹åŠ¨è°ƒå‡º</p><p>ivç”¨ä¸ªfrida hook cypher.initè„šæœ¬å‡º</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526164235188.png" alt="image-20240526164235188"></p><h2 id="rust-baby"><a href="#rust-baby" class="headerlink" title="rust_baby"></a>rust_baby</h2><p>çœ‹ä»£ç çœ‹å¾—æœ€å¤´ç–¼çš„ä¸€é¢˜ï¼Œ</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526164644891.png" alt="image-20240526164644891"></p><p>å…ˆå†™äº†ä¸ªåˆ—è¡¨ï¼Œç„¶åæ…¢æ…¢ä»åˆ—è¡¨ä¸­è°ƒç”¨</p><p>åŠ¨è°ƒçœ‹åŠ å¯†ï¼Œå…ˆæ˜¯ä¸€ä¸ªè¡¥é½ï¼Œä¸€ç›´è¡¥åˆ°104ä½ï¼Œè¿™é‡Œæ˜¯ç¬¬ä¸€æ­¥åŠ å¯†ï¼Œå–8ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªsub_1400028C3ï¼Œä¸€ä¸ªå¼‚æˆ–</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image.png" alt="image"></p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526165504040.png" alt="image-20240526165504040"></p><p>è¿›å»çœ‹ä¸æ‡‚ï¼Œä½†æ˜¯æ ¹æ®è¾“å…¥è¾“å‡ºè¿›è¡Œå¤§æ¦‚çŒœæµ‹å°±çŸ¥é“æ˜¯-1ï¼Œ0ï¼Œ+1ï¼Œ+2æ“ä½œ</p><p>åé¢è¿›è¡Œ16ä¸ªå­—èŠ‚åˆ†ç»„ï¼Œä¸‹ä¸€æ­¥åŠ å¯†æ˜¯åœ¨è¿™é‡Œï¼Œå¼‚æˆ–v96çš„è¡¨ï¼Œè¿™ä¸ªè¡¨æ¯æ¬¡å¾ªç¯éƒ½ä¼šæ¢ä¸€ä¸‹ï¼Œä½†æ˜¯ç›´æ¥åŠ¨è°ƒå–å°±è¡Œ</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526170136833.png" alt="image-20240526170136833"></p><p>ä¸€ç›´åˆ°æ¯”è¾ƒæ®µï¼Œéƒ½æ²¡å’‹åŠ¨ï¼Œä¸‹é¢ä¸€å¤§ä¸²éƒ½æ²¡å•¥ç”¨</p><p><a href="../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526165822823.png">image-20240526165822823</a></p><p>ç„¶åå†™ä¸ªè„šæœ¬å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pw = [<span class="number">0x8a</span>,<span class="number">0x07</span>,<span class="number">0x72</span>,<span class="number">0x76</span>,<span class="number">0x8d</span>,<span class="number">0x7d</span>,<span class="number">0x4d</span>,<span class="number">0x51</span>,<span class="number">0x35</span>,<span class="number">0xde</span>,<span class="number">0x88</span>,<span class="number">0x16</span>,<span class="number">0xd4</span>,<span class="number">0x04</span>,<span class="number">0xf9</span>,<span class="number">0x0e</span>,<span class="number">0x08</span>,<span class="number">0xcf</span>,<span class="number">0xcc</span>,<span class="number">0x7c</span>,<span class="number">0x0f</span>,<span class="number">0x0d</span>,<span class="number">0x09</span>,<span class="number">0x5e</span>,<span class="number">0xd5</span>,<span class="number">0x7e</span>,<span class="number">0xe4</span>,<span class="number">0x4b</span>,<span class="number">0xc4</span>,<span class="number">0xf3</span>,<span class="number">0x1c</span>,<span class="number">0xaf</span>,<span class="number">0x12</span>,<span class="number">0xe4</span>,<span class="number">0xa0</span>,<span class="number">0xae</span>,<span class="number">0xf6</span>,<span class="number">0x69</span>,<span class="number">0xc9</span>,<span class="number">0xd2</span>,<span class="number">0xe0</span>,<span class="number">0xa7</span>,<span class="number">0x01</span>,<span class="number">0x0e</span>,<span class="number">0x1a</span>,<span class="number">0x57</span>,<span class="number">0x70</span>,<span class="number">0x92</span>,<span class="number">0x61</span>,<span class="number">0x49</span>,<span class="number">0x7a</span>,<span class="number">0x43</span>,<span class="number">0x27</span>,<span class="number">0x29</span>,<span class="number">0x89</span>,<span class="number">0xb5</span>,<span class="number">0x92</span>,<span class="number">0x2e</span>,<span class="number">0x6a</span>,<span class="number">0xa6</span>,<span class="number">0xdb</span>,<span class="number">0x2f</span>,<span class="number">0xc6</span>,<span class="number">0xa9</span>,<span class="number">0x6e</span>,<span class="number">0x8f</span>,<span class="number">0x34</span>,<span class="number">0x90</span>,<span class="number">0x59</span>,<span class="number">0xfc</span>,<span class="number">0x2d</span>,<span class="number">0x91</span>,<span class="number">0x66</span>,<span class="number">0xeb</span>,<span class="number">0xbe</span>,<span class="number">0x0d</span>,<span class="number">0xf4</span>,<span class="number">0x05</span>,<span class="number">0x0b</span>,<span class="number">0x1b</span>,<span class="number">0xcb</span>,<span class="number">0x18</span>,<span class="number">0x74</span>,<span class="number">0xf9</span>,<span class="number">0x82</span>,<span class="number">0x81</span>,<span class="number">0xbc</span>,<span class="number">0x04</span>,<span class="number">0xd9</span>,<span class="number">0x75</span>,<span class="number">0x8e</span>,<span class="number">0x2d</span>,<span class="number">0x97</span>,<span class="number">0x07</span>,<span class="number">0x7c</span>,<span class="number">0x7d</span>,<span class="number">0x18</span>,<span class="number">0xc8</span>,<span class="number">0x3d</span>,<span class="number">0x4f</span>,<span class="number">0xc0</span>,<span class="number">0xa5</span>,<span class="number">0x6a</span>,<span class="number">0xd7</span>]</span><br><span class="line">key = [<span class="number">0xDC</span>,<span class="number">0x5F</span>,<span class="number">0x20</span>,<span class="number">0x22</span>,<span class="number">0xC2</span>,<span class="number">0x79</span>,<span class="number">0x19</span>,<span class="number">0x56</span>,<span class="number">0x35</span>,<span class="number">0xDA</span>,<span class="number">0x8B</span>,<span class="number">0x47</span>,<span class="number">0xD3</span>,<span class="number">0x19</span>,<span class="number">0xFC</span>,<span class="number">0x55</span>,<span class="number">0x14</span>,<span class="number">0xCD</span>,<span class="number">0xD2</span>,<span class="number">0x7B</span>,<span class="number">0x58</span>,<span class="number">0x59</span>,<span class="number">0x09</span>,<span class="number">0x42</span>,<span class="number">0xDE</span>,<span class="number">0x2C</span>,<span class="number">0xB4</span>,<span class="number">0x48</span>,<span class="number">0xD9</span>,<span class="number">0xF2</span>,<span class="number">0x1B</span>,<span class="number">0xA9</span>,<span class="number">0x40</span>,<span class="number">0xE1</span>,<span class="number">0xA6</span>,<span class="number">0xFB</span>,<span class="number">0xFF</span>,<span class="number">0x38</span>,<span class="number">0xC1</span>,<span class="number">0xD5</span>,<span class="number">0xE2</span>,<span class="number">0xE8</span>,<span class="number">0x77</span>,<span class="number">0x78</span>,<span class="number">0x6F</span>,<span class="number">0x22</span>,<span class="number">0x04</span>,<span class="number">0xE6</span>,<span class="number">0x16</span>,<span class="number">0x3E</span>,<span class="number">0x0C</span>,<span class="number">0x35</span>,<span class="number">0x52</span>,<span class="number">0x5C</span>,<span class="number">0xFD</span>,<span class="number">0xC1</span>,<span class="number">0xE5</span>,<span class="number">0x59</span>,<span class="number">0x1C</span>,<span class="number">0xD0</span>,<span class="number">0xAE</span>,<span class="number">0x5A</span>,<span class="number">0xB2</span>,<span class="number">0xDD</span>,<span class="number">0x19</span>,<span class="number">0xF8</span>,<span class="number">0x42</span>,<span class="number">0xE6</span>,<span class="number">0x2C</span>,<span class="number">0x89</span>,<span class="number">0x59</span>,<span class="number">0xE5</span>,<span class="number">0x11</span>,<span class="number">0x9C</span>,<span class="number">0xC8</span>,<span class="number">0x7B</span>,<span class="number">0x81</span>,<span class="number">0x70</span>,<span class="number">0x7F</span>,<span class="number">0x6F</span>,<span class="number">0xBC</span>,<span class="number">0x6F</span>,<span class="number">0x02</span>,<span class="number">0x8F</span>,<span class="number">0xF7</span>,<span class="number">0xF4</span>,<span class="number">0xC8</span>,<span class="number">0x70</span>,<span class="number">0xAE</span>,<span class="number">0x02</span>,<span class="number">0xF8</span>,<span class="number">0x5B</span>,<span class="number">0xE2</span>,<span class="number">0x72</span>,<span class="number">0x08</span>,<span class="number">0x09</span>,<span class="number">0x6F</span>,<span class="number">0xBF</span>,<span class="number">0x4B</span>,<span class="number">0x39</span>,<span class="number">0xB5</span>,<span class="number">0xD0</span>,<span class="number">0x1E</span>,<span class="number">0xA3</span>,<span class="number">0x23</span>,<span class="number">0xAB</span>,<span class="number">0x9B</span>,<span class="number">0x43</span>,<span class="number">0xB1</span>,<span class="number">0x15</span>,<span class="number">0xD7</span>,<span class="number">0xBE</span>,]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pw)):</span><br><span class="line">    pw[i] ^= key[i]</span><br><span class="line">    pw[i] ^= <span class="number">0x33</span></span><br><span class="line">    <span class="keyword">if</span> (((i%<span class="number">8</span>)//<span class="number">2</span>)==<span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(pw[i]+<span class="number">1</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (((i%<span class="number">8</span>)//<span class="number">2</span>)==<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(pw[i]),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> (((i%<span class="number">8</span>)//<span class="number">2</span>)==<span class="number">2</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(pw[i]-<span class="number">1</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(pw[i]-<span class="number">2</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">//flag&#123;6e2480b3-4f02-4cf1-9bc0-123b75f9a922&#125;</span><br></pre></td></tr></table></figure><h2 id="whereThe1b"><a href="#whereThe1b" class="headerlink" title="whereThe1b"></a>whereThe1b</h2><p>ä¸€ä¸ªpythonå†™çš„libï¼Œbase32ï¼Œå„ç§éšæœºæ•°å¼‚æˆ–è°ƒç”¨å•¥çš„ï¼Œçœ‹äº†ä¸€ä¼šä¸æƒ³çœ‹äº†ï¼Œå‘ç°æ˜¯åˆ†ç»„åŠ å¯†ï¼Œä¸‰ä½å¯¹åº”å››ä½ï¼Œè€Œä¸”æ˜¯å¯è§å­—ç¬¦ï¼Œç›´æ¥æ”¾åœ¨è™šæ‹Ÿæœº(å› ä¸ºå¥½åƒåªæœ‰linuxèƒ½è°ƒç”¨cpython)é‡Œçˆ†ç ´äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> whereThel1b</span><br><span class="line"></span><br><span class="line">encry = [<span class="number">108</span>, <span class="number">117</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">64</span>, <span class="number">49</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">69</span>, <span class="number">115</span>, <span class="number">94</span>, <span class="number">93</span>, <span class="number">94</span>, <span class="number">115</span>, <span class="number">71</span>, <span class="number">95</span>, <span class="number">84</span>, <span class="number">89</span>, <span class="number">56</span>, <span class="number">101</span>, <span class="number">70</span>, <span class="number">2</span>, <span class="number">84</span>, <span class="number">75</span>, <span class="number">127</span>, <span class="number">68</span>, <span class="number">103</span>, <span class="number">85</span>, <span class="number">105</span>, <span class="number">113</span>, <span class="number">80</span>, <span class="number">103</span>, <span class="number">95</span>, <span class="number">67</span>, <span class="number">81</span>, <span class="number">7</span>, <span class="number">113</span>, <span class="number">70</span>, <span class="number">47</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">124</span>, <span class="number">93</span>, <span class="number">120</span>, <span class="number">104</span>, <span class="number">108</span>, <span class="number">106</span>, <span class="number">17</span>, <span class="number">80</span>, <span class="number">102</span>, <span class="number">101</span>, <span class="number">75</span>, <span class="number">93</span>, <span class="number">68</span>, <span class="number">121</span>, <span class="number">26</span>]</span><br><span class="line">flag = <span class="string">&quot;&#123;&#125;&#123;&#125;&#123;&#125;&quot;</span></span><br><span class="line"><span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                flag=<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">chr</span>(i)&#125;</span><span class="subst">&#123;<span class="built_in">chr</span>(j)&#125;</span><span class="subst">&#123;<span class="built_in">chr</span>(k)&#125;</span>&#x27;</span>*<span class="number">14</span></span><br><span class="line">                flag = flag.encode()</span><br><span class="line">                ret = whereThel1b.trytry(flag)</span><br><span class="line">                <span class="keyword">if</span> ret[(<span class="number">4</span>*o):(<span class="number">4</span>*o+<span class="number">4</span>)]==encry[(<span class="number">4</span>*o):(<span class="number">4</span>*o+<span class="number">4</span>)]:</span><br><span class="line">                    <span class="built_in">print</span>(flag,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Goreverse"><a href="#Goreverse" class="headerlink" title="Goreverse"></a>Goreverse</h2><p>æ€è·¯è¶…çº§æ¸…æ™°ï¼Œå°±æ˜¯åŠ å¯†åµŒå¥—å¤ªå¤šå±‚äº†ï¼Œåªè¦ä¸€å‡ºé”™å°±å¾—è¿˜åŸé‡æ–°çœ‹ï¼Œsm4é‚£é‡Œå°±æ˜¯æ­»æ´»å‡ºä¸æ¥ï¼Œæœ€åæ‰çŸ¥é“æ˜¯ivæé”™äº†ï¼ŒçœŸæ— è¯­äº†ï¼Œè¿™é¢˜è°ƒè¯•è¿˜æ˜¯ä¸€å¨ï¼Œè°ƒä¸€æ­¥å¡ä¸€æ­¥ï¼Œæœ‰ä¸¤ä¸ªåè°ƒè¯•ã€‚æœ€åçœ‹vidar-teamçš„wpå¤ç°çš„ã€‚</p><p>å…ˆç”¨goè„šæœ¬è¿˜åŸä¸€ä¸‹å¤§éƒ¨åˆ†ç¬¦å·å</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526171458703.png" alt="image-20240526171458703"></p><p>mainå‡½æ•°ä¸€ä¸ªåè°ƒè¯•ï¼Œç›´æ¥æŠŠexit()nopæ‰å°±è¡Œï¼Œç»§ç»­è¿è¡Œåˆ°</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526191855425.png" alt="image-20240526191855425"></p><p>å¾ˆæ˜æ˜¾ä¸€ä¸ªopenäº†ä¸€ä¸ªflagæ–‡ä»¶è¯»å…¥ï¼Œç„¶åè¿›è¡Œä»¥ä¸‹å‡ ä¸ªæ“ä½œï¼Œé€æ­¥åˆ†æ</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240526192238258.png" alt="image-20240526192238258"></p><p>å¤§æ¦‚å°±æ˜¯è¿™æ ·ï¼Œæ‰¾åˆ°aesçš„keyå’Œivï¼Œç„¶åæ‰¾åˆ°sm4çš„keyå’Œivï¼Œè¿˜åŸxxteaç®—æ³•å’Œæ‰¾åˆ°xxteaçš„keyï¼Œæ‰¾åˆ°å¼‚æˆ–è¡¨ï¼Œå°±å¯ä»¥ç©¿äº†ã€‚ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> table[]=<span class="string">&quot;D7BJLsOk9@f&amp;1dWIn53IDlJqUS6$^WhkAk2kk*2GaqmLwiLX^bGGE$&amp;dmqR^g5bL3&quot;</span>;</span><br><span class="line"><span class="type">char</span> keyxxtea[]=<span class="string">&quot;Bs^8*wZ4lu8oR&amp;@k&quot;</span>;</span><br><span class="line"><span class="type">char</span> keySm4[]=<span class="string">&quot;pg5g#k6Qo3L&amp;1EzT&quot;</span>;</span><br><span class="line"><span class="type">char</span> keyaes[]=<span class="string">&quot;dPGWgcLpqmxw3uOXhKpKV009Cql@@XE6&quot;</span>;</span><br><span class="line"><span class="type">char</span> ivaes[]=<span class="string">&quot;dPGWgcLpqmxw3uOX&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240527124436315.png" alt="image-20240527124436315"></p><p>è¾“å‡ºçš„å‰16ä¸ªå­—èŠ‚æ˜¯sm4çš„ivï¼Œåé¢çš„éƒ½æ˜¯sm4çš„å¯†æ–‡ï¼Œå› ä¸ºè¿›è¡ŒåŠ å¯†çš„ivæ˜¯éšæœºæ•°ï¼Œåªèƒ½é€šè¿‡è¿™ä¸ªæ–¹æ³•åˆ¤æ–­</p><p><img src="/../img/2024CISCN%E5%88%9D%E8%B5%9B/image-20240527124758410.png" alt="image-20240527124758410"></p><p>æœ€åå†è¿›è¡Œä¸€æ­¥xxteaè§£å¯†å’Œå¼‚æˆ–è¡¨</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> delta 0x7FAB4CAD</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v[<span class="number">20</span>] = &#123;<span class="number">0xa17bd6ac</span>,<span class="number">0x5ec21b5e</span>,<span class="number">0xa42f58b2</span>,<span class="number">0x1f8dcfae</span>,<span class="number">0x17e7d4bb</span>,<span class="number">0x8bb7be13</span>,<span class="number">0xf335137e</span>,<span class="number">0x24eedf2f</span>,<span class="number">0xf57f3e58</span>,<span class="number">0xe246395a</span>,<span class="number">0x1c4f3291</span>&#125;;<span class="comment">//å¯æ”¹</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123;<span class="number">0x385E7342</span>, <span class="number">0x345A772A</span>, <span class="number">0x6F38756C</span>, <span class="number">0x6B402652</span>&#125;;<span class="comment">//å¯æ”¹</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> y,z,p,rounds,e;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> table[<span class="number">100</span>]=&#123;<span class="number">0x44</span>, <span class="number">0x37</span>, <span class="number">0x42</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x73</span>, <span class="number">0x4F</span>, <span class="number">0x6B</span>, <span class="number">0x39</span>, <span class="number">0x40</span>, <span class="number">0x66</span>, <span class="number">0x26</span>, <span class="number">0x31</span>, <span class="number">0x64</span>, <span class="number">0x57</span>, <span class="number">0x49</span>, </span><br><span class="line"><span class="number">0x6E</span>, <span class="number">0x35</span>, <span class="number">0x33</span>, <span class="number">0x49</span>, <span class="number">0x44</span>, <span class="number">0x6C</span>, <span class="number">0x4A</span>, <span class="number">0x71</span>, <span class="number">0x55</span>, <span class="number">0x53</span>, <span class="number">0x36</span>, <span class="number">0x24</span>, <span class="number">0x5E</span>, <span class="number">0x57</span>, <span class="number">0x68</span>, <span class="number">0x6B</span>, </span><br><span class="line"><span class="number">0x41</span>, <span class="number">0x6B</span>, <span class="number">0x32</span>, <span class="number">0x6B</span>, <span class="number">0x6B</span>, <span class="number">0x2A</span>, <span class="number">0x32</span>, <span class="number">0x47</span>, <span class="number">0x61</span>, <span class="number">0x71</span>, <span class="number">0x6D</span>, <span class="number">0x4C</span>, <span class="number">0x77</span>, <span class="number">0x69</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, </span><br><span class="line"><span class="number">0x5E</span>, <span class="number">0x62</span>, <span class="number">0x47</span>, <span class="number">0x47</span>, <span class="number">0x45</span>, <span class="number">0x24</span>, <span class="number">0x26</span>, <span class="number">0x64</span>, <span class="number">0x6D</span>, <span class="number">0x71</span>, <span class="number">0x52</span>, <span class="number">0x5E</span>, <span class="number">0x67</span>, <span class="number">0x35</span>, <span class="number">0x62</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x33</span>, <span class="number">0x6C</span>, <span class="number">0x43</span>, <span class="number">0x41</span>, <span class="number">0x35</span>, <span class="number">0x5E</span>, <span class="number">0x48</span>, <span class="number">0x47</span>, <span class="number">0x4B</span>, <span class="number">0x24</span>, <span class="number">0x39</span>, <span class="number">0x71</span>, <span class="number">0x6F</span>, <span class="number">0x35</span>, <span class="number">0x54</span>, <span class="number">0x40</span>, </span><br><span class="line"><span class="number">0x42</span>, <span class="number">0x77</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x39</span>, <span class="number">0x76</span>, <span class="number">0x45</span>, <span class="number">0x58</span>, <span class="number">0x79</span>, <span class="number">0x61</span>, <span class="number">0x30</span>, <span class="number">0x48</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x33</span>, <span class="number">0x4C</span>, </span><br><span class="line"><span class="number">0x72</span>, <span class="number">0x57</span>, <span class="number">0x57</span>&#125;;</span><br><span class="line"><span class="type">int</span> n = <span class="number">11</span>;<span class="comment">//vçš„ä¸ªæ•°</span></span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">rounds = <span class="number">6</span> + <span class="number">52</span>/n;<span class="comment">//å®¹æ˜“é­”æ”¹</span></span><br><span class="line">y = v[<span class="number">0</span>];</span><br><span class="line">sum = rounds*delta;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">e = sum &gt;&gt; <span class="number">2</span> &amp; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">for</span>(p=n<span class="number">-1</span>;p&gt;<span class="number">0</span>;p--)</span><br><span class="line">&#123;</span><br><span class="line">z = v[p<span class="number">-1</span>];</span><br><span class="line">v[p] -= ((((z&gt;&gt;<span class="number">5</span>)^(y&lt;&lt;<span class="number">2</span>))+((y&gt;&gt;<span class="number">3</span>)^(z&lt;&lt;<span class="number">4</span>))) ^y ^ sum) + (key[(p&amp;<span class="number">3</span>)^e]^z);<span class="comment">//å®¹æ˜“é­”æ”¹</span></span><br><span class="line">y = v[p];</span><br><span class="line">&#125;</span><br><span class="line">z = v[n<span class="number">-1</span>];</span><br><span class="line">v[<span class="number">0</span>] -= ((((z&gt;&gt;<span class="number">5</span>)^(y&lt;&lt;<span class="number">2</span>))+((y&gt;&gt;<span class="number">3</span>)^(z&lt;&lt;<span class="number">4</span>))) ^y ^ sum) + (key[(p&amp;<span class="number">3</span>)^e]^z);<span class="comment">//å®¹æ˜“é­”æ”¹</span></span><br><span class="line">y = v[<span class="number">0</span>];</span><br><span class="line">sum -= delta;</span><br><span class="line">&#125;<span class="keyword">while</span>(--rounds);</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,*((<span class="type">char</span>*)&amp;v[i])^table[i*<span class="number">4</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,*((<span class="type">char</span>*)&amp;v[i]+<span class="number">1</span>)^table[i*<span class="number">4</span>+<span class="number">1</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,*((<span class="type">char</span>*)&amp;v[i]+<span class="number">2</span>)^table[i*<span class="number">4</span>+<span class="number">2</span>]);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,*((<span class="type">char</span>*)&amp;v[i]+<span class="number">3</span>)^table[i*<span class="number">4</span>+<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag&#123;9c2a42ab-b02d-457e-befb-27af6a7fa7bc&#125;</span></span><br></pre></td></tr></table></figure><h2 id="gdb-debug"><a href="#gdb-debug" class="headerlink" title="gdb_debug"></a>gdb_debug</h2><p>å›ºå®šçš„ç§å­ï¼Œä¸€å…±è°ƒç”¨äº†ä¸‰æ¬¡ï¼Œå…ˆæŠŠéœ€è¦ç”¨çš„randå€¼å…¨éƒ¨æ‰“å°å‡ºæ¥æˆä¸ºä¸€ä¸ªè¡¨ï¼Œç„¶ååŠ å¯†å°±æ˜¯ç®€å•çš„å¼‚æˆ–+æ¢è¡¨é¡ºåº+å¼‚æˆ–ï¼Œå†™ä¸ªè„šæœ¬å‡ºäº†ï¼Œç¬¬äºŒå¤©çš„ç­¾åˆ°ã€‚ã€‚ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cstdlib&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cstdio&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;defs.h&quot;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> data2[] = &#123;<span class="number">220</span>, <span class="number">184</span>, <span class="number">64</span>, <span class="number">189</span>, <span class="number">156</span>, <span class="number">201</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">239</span>, <span class="number">18</span>, <span class="number">216</span>, <span class="number">152</span>, <span class="number">105</span>, <span class="number">208</span>, <span class="number">222</span>, <span class="number">252</span>, <span class="number">107</span>, <span class="number">174</span>, <span class="number">125</span>, <span class="number">139</span>, <span class="number">214</span>,</span><br><span class="line">               <span class="number">141</span>, <span class="number">15</span>, <span class="number">208</span>, <span class="number">79</span>, <span class="number">102</span>, <span class="number">62</span>, <span class="number">157</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">233</span>, <span class="number">36</span>, <span class="number">211</span>, <span class="number">239</span>, <span class="number">255</span>, <span class="number">157</span>, <span class="number">231</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> rand_list[]&#123;</span><br><span class="line">        <span class="number">0x1fae43d9</span>, <span class="number">0x14da3e0f</span>, <span class="number">0x29fdc718</span>, <span class="number">0x6b7956bd</span>, <span class="number">0x565247c7</span>, <span class="number">0x118e4e16</span>, <span class="number">0xec41481</span>, <span class="number">0x2853f3be</span>, <span class="number">0x18fe7af8</span>,</span><br><span class="line">        <span class="number">0x637a7d4a</span>, <span class="number">0x4c235f65</span>, <span class="number">0x1a636af2</span>, <span class="number">0xf8e55d</span>, <span class="number">0x3f4562ab</span>, <span class="number">0x910412b</span>, <span class="number">0x57ec233</span>, <span class="number">0x1a9fe4d4</span>, <span class="number">0x321373a5</span>,</span><br><span class="line">        <span class="number">0x5aa40d67</span>, <span class="number">0x7661698</span>, <span class="number">0x7e44749f</span>, <span class="number">0x3c64e7e</span>, <span class="number">0x49be3e2b</span>, <span class="number">0x394c025d</span>, <span class="number">0x6acb9dc2</span>, <span class="number">0x726285af</span>, <span class="number">0x7d6818e</span>,</span><br><span class="line">        <span class="number">0x655c983a</span>, <span class="number">0x7afa9e4c</span>, <span class="number">0x7f7af6a5</span>, <span class="number">0x5b28f175</span>, <span class="number">0x1aa8e225</span>, <span class="number">0x145534b4</span>, <span class="number">0x526b88d</span>, <span class="number">0x62238e3</span>, <span class="number">0x6aa77c7b</span>,</span><br><span class="line">        <span class="number">0x16b506a3</span>, <span class="number">0x14e64d64</span>, <span class="number">0x12fb7039</span>, <span class="number">0x2fb3819c</span>, <span class="number">0x7860caae</span>, <span class="number">0x5f1ecf9e</span>, <span class="number">0x4a16ec8e</span>, <span class="number">0x7959b00b</span>, <span class="number">0x1e64324a</span>,</span><br><span class="line">        <span class="number">0x53272db9</span>, <span class="number">0x7ed8723f</span>, <span class="number">0x3904171e</span>, <span class="number">0x53aa15e</span>, <span class="number">0x597c7fa6</span>, <span class="number">0x406a2db6</span>, <span class="number">0x37f15fd</span>, <span class="number">0x5d42ce25</span>, <span class="number">0xa286be1</span>,</span><br><span class="line">        <span class="number">0x3ccb185a</span>, <span class="number">0x480e6be7</span>, <span class="number">0x7c8af191</span>, <span class="number">0x44a199e8</span>, <span class="number">0x2d6b0421</span>, <span class="number">0x77858fdd</span>, <span class="number">0x441c908d</span>, <span class="number">0x893f596</span>, <span class="number">0x122e7202</span>,</span><br><span class="line">        <span class="number">0x5871c541</span>, <span class="number">0xdbaae23</span>, <span class="number">0x1850aae5</span>, <span class="number">0x431941bc</span>, <span class="number">0x246fb4c7</span>, <span class="number">0x2d36f849</span>, <span class="number">0x5614b1f5</span>, <span class="number">0x54233663</span>, <span class="number">0x2597c2f7</span>,</span><br><span class="line">        <span class="number">0x35338194</span>, <span class="number">0x1e3a22f1</span>, <span class="number">0x1ef17303</span>, <span class="number">0x5397b3de</span>, <span class="number">0x716150aa</span>, <span class="number">0x1dc9e542</span>, <span class="number">0xc9bcafc</span>, <span class="number">0x769bf209</span>, <span class="number">0x774664e8</span>,</span><br><span class="line">        <span class="number">0x4d05f8b2</span>, <span class="number">0x7a1b0806</span>, <span class="number">0x5489330d</span>, <span class="number">0x572e6493</span>, <span class="number">0x36e62061</span>, <span class="number">0x1c979ef4</span>, <span class="number">0x53b95624</span>, <span class="number">0x7b87ba49</span>, <span class="number">0x4a02a315</span>,</span><br><span class="line">        <span class="number">0x4b3ee601</span>, <span class="number">0x3fa44ad7</span>, <span class="number">0x529698ab</span>, <span class="number">0x5d6d5804</span>, <span class="number">0x18161018</span>, <span class="number">0x605146cf</span>, <span class="number">0x75be02e9</span>, <span class="number">0x5b2f51d5</span>, <span class="number">0x4c0fb96</span>,</span><br><span class="line">        <span class="number">0x22f4fb33</span>, <span class="number">0x314403ca</span>, <span class="number">0x58e431f9</span>, <span class="number">0x488cbe2a</span>, <span class="number">0x6677855e</span>, <span class="number">0x771e54ea</span>, <span class="number">0x677e312d</span>, <span class="number">0x3a0f393c</span>, <span class="number">0x687fa594</span>,</span><br><span class="line">        <span class="number">0x548166f</span>, <span class="number">0x46ab0438</span>, <span class="number">0x5f1b979d</span>, <span class="number">0x7c8e7b58</span>, <span class="number">0x13b0fcea</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> unsi[<span class="number">40</span>] = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    srand(<span class="number">1610612736</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i) &#123;</span><br><span class="line">        data2[i] ^= rand_list[<span class="number">38</span> + <span class="number">37</span> + i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">void</span> *ptr = <span class="built_in">malloc</span>(<span class="number">40</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i) ((_BYTE *) ptr)[i] = i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">38</span> - <span class="number">1</span>; k; --k) &#123;</span><br><span class="line">        <span class="type">int</span> v18 = rand_list[<span class="number">38</span> + <span class="number">37</span> - k] % (k + <span class="number">1</span>);</span><br><span class="line">        <span class="type">int</span> v19 = *((_BYTE *) ptr + k);</span><br><span class="line">        *((_BYTE *) ptr + k) = *((_BYTE *) ptr + v18);</span><br><span class="line">        *((_BYTE *) ptr + v18) = v19;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; ++i) &#123;</span><br><span class="line">        _BYTE current = data2[i];</span><br><span class="line">        unsi[((_BYTE *) ptr)[i]] = current;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i) &#123;</span><br><span class="line">        unsi[i] ^= rand_list[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">38</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, unsi[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2024CISCNåˆèµ›-Reverse&quot;&gt;&lt;a href=&quot;#2024CISCNåˆèµ›-Reverse&quot; class=&quot;headerlink&quot; title=&quot;2024CISCNåˆèµ› Reverse&quot;&gt;&lt;/a&gt;2024CISCNåˆèµ› Reverse&lt;/h1&gt;&lt;p&gt;æœ€è¿‘</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ioså­¦ä¹ ç¯‡(2)</title>
    <link href="https://straw-233.github.io/2024/04/18/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/"/>
    <id>https://straw-233.github.io/2024/04/18/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/</id>
    <published>2024-04-18T13:46:25.520Z</published>
    <updated>2024-04-18T13:59:15.265Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ioså­¦ä¹ ç¯‡-2"><a href="#ioså­¦ä¹ ç¯‡-2" class="headerlink" title="ioså­¦ä¹ ç¯‡(2)"></a>ioså­¦ä¹ ç¯‡(2)</h1><h2 id="ipaæ–‡ä»¶ç»“æ„"><a href="#ipaæ–‡ä»¶ç»“æ„" class="headerlink" title="ipaæ–‡ä»¶ç»“æ„"></a>ipaæ–‡ä»¶ç»“æ„</h2><p>â€‹ipaä»¥å‹ç¼©åŒ…çš„å½¢å¼æ‰“å¼€åè¿›å…¥payloadä¸­ä¼šæœ‰å¾ˆå¤šçš„æ–‡ä»¶å­˜åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•è¿›è¡Œæœ‰æ•ˆçš„è¾¨åˆ«æ¯ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œä»¥å¿«é€Ÿæ‰¾åˆ°å¯¹äºé€†å‘æœ€æœ‰ç”¨äºŒè¿›åˆ¶æ–‡ä»¶å‘¢ï¼Œå…ˆä»ipaçš„ç»“æ„å…¥æ‰‹ã€‚</p><p>â€‹æœ¬æ–‡ç« å°†ä»¥ä¸€ä¸ªå¼€æºçš„ç¤¾äº¤appä¸ºä¾‹å­è¿›è¡Œç®€å•ä»‹ç»</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/1.png" alt="1"></p><h3 id="Info-plist"><a href="#Info-plist" class="headerlink" title="Info.plist"></a>Info.plist</h3><p>â€‹Info.plistæ˜¯ä¸€ä¸ªåº”ç”¨çš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼ˆç±»ä¼¼äºandroidçš„AndroidManifest.xmlï¼‰</p><p>â€‹å¯ä»¥ç”¨plist Editoræ¥æŸ¥çœ‹å¤§è‡´çš„ç›¸å…³é…ç½®ä¿¡æ¯ï¼Œå½“ç„¶ç”¨vscodeçœ‹ä¹Ÿè¡Œä¸è¿‡æ¯”è¾ƒéš¾çœ‹</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/2.png" alt="2"></p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/3.png" alt="3"></p><p>â€‹åé¢è¿˜æ¶‰åŠä¸€äº›æƒé™å•¥çš„é…ç½®ï¼Œä¸å±•å¼€ç»†è®²</p><h3 id="CodeSignature"><a href="#CodeSignature" class="headerlink" title="_CodeSignature"></a>_CodeSignature</h3><ul><li>ipaåŒ…ç­¾åæ–‡ä»¶çš„å­˜æ”¾æ–‡ä»¶å¤¹</li></ul><h3 id="Iproj"><a href="#Iproj" class="headerlink" title=".Iproj"></a>.Iproj</h3><ul><li>Appæ‰€æ”¯æŒçš„è¯­è¨€æ–‡ä»¶</li></ul><h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><ul><li>æ’ä»¶</li></ul><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/4.png" alt="4"></p><p>â€‹æ¯ä¸ªæ’ä»¶é‡Œçš„ç»“æ„ä¹Ÿç±»ä¼¼</p><h3 id="Frameworks"><a href="#Frameworks" class="headerlink" title="Frameworks"></a>Frameworks</h3><ul><li><p>å½“å‰åº”ç”¨ä½¿ç”¨çš„ä¸‰æ–¹ Framework æˆ– Swift åŠ¨æ€åº“</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/5.png" alt="5"></p></li></ul><h3 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h3><ul><li>èµ„æºæ–‡ä»¶</li></ul><h3 id="Assets-car"><a href="#Assets-car" class="headerlink" title="Assets.car"></a>Assets.car</h3><ul><li>Assets.xcasstsåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„æœ€ç»ˆå±•ç¤ºæ–‡ä»¶ï¼Œé»˜è®¤é‡Œé¢å­˜æ”¾å„ç§åˆ†è¾¨ç‡å›¾ç‰‡</li></ul><h3 id="bundle"><a href="#bundle" class="headerlink" title=".bundle"></a>.bundle</h3><ul><li>è°ƒç”¨ä¸€äº›å…¶ä»–çš„èµ„æºé¡¹ç›®åŒ…</li></ul><p>è¯¥æ–‡ä»¶å¤šçš„è¯ï¼Œä¼šéå¸¸éš¾é€†</p><h3 id="mach-o"><a href="#mach-o" class="headerlink" title="mach-o"></a>mach-o</h3><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(2)/6.png" alt="6"></p><p>æ ¹æ®Info.plisté‡Œæ‰¾ï¼Œè¿™å°±æ˜¯å°±æ˜¯æˆ‘ä»¬éœ€è¦è¿›è¡Œé€†å‘çš„æ–‡ä»¶</p><h3 id="nib"><a href="#nib" class="headerlink" title=".nib"></a>.nib</h3><p>.nib æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶çš„ plist æ–‡ä»¶ï¼Œå…¶ä¸­ä¿å­˜äº†åº”ç”¨ç¨‹åºä¸­ GUI ç»„ä»¶çš„ä½ç½®ä¿¡æ¯å’Œè®¾ç½®ä¿¡æ¯ã€‚è¿™äº›æ–‡ä»¶æ˜¯é€šè¿‡ Xcode çš„ Interface Builder åˆ›å»ºçš„ã€‚Interface Builder ç¼–è¾‘.xib æ–‡ä»¶çš„æ–‡æœ¬ç‰ˆæœ¬ï¼Œç„¶åå†å°†è¿™äº›æ–‡ä»¶æ‰“åŒ…æˆäºŒè¿›åˆ¶æ ¼å¼ã€‚</p><h3 id="storyboardc"><a href="#storyboardc" class="headerlink" title=".storyboardc"></a>.storyboardc</h3><ul><li>æ¨¡å—åŒ–UIæ–‡ä»¶</li></ul><h3 id="å…¶ä»–èµ„æºæ–‡ä»¶"><a href="#å…¶ä»–èµ„æºæ–‡ä»¶" class="headerlink" title="å…¶ä»–èµ„æºæ–‡ä»¶"></a>å…¶ä»–èµ„æºæ–‡ä»¶</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.xmlã€.json</span><br><span class="line">.plistï¼šé¡¹ç›®ä¸­ä½¿ç”¨èµ„æºçš„.plistæ–‡ä»¶</span><br><span class="line">.confï¼šç›¸å…³çš„é…ç½®æ–‡ä»¶</span><br><span class="line">.cerã€.derã€.p12ï¼šé’¥åŒ™ä¸²æ–‡ä»¶</span><br><span class="line">.wavï¼šéŸ³é¢‘æ–‡ä»¶</span><br><span class="line">.jsã€.html</span><br><span class="line">.nibï¼šXcodeè‡ªå¸¦çš„æ•°æ®æ–‡ä»¶ï¼ŒåŒ…å«ä¸€ä¸ªçª—å£ç¨‹åºå’Œåº”ç”¨ç¨‹åºå§”æ‰˜å¯¹è±¡</span><br><span class="line">.sqliteï¼šæ•°æ®åº“æ–‡ä»¶</span><br><span class="line">.txtï¼šæ–‡æœ¬æ–‡ä»¶</span><br><span class="line">.momï¼šXcodeåˆ›å»ºçš„æ•°æ®æ¨¡å‹æ–‡ä»¶</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ioså­¦ä¹ ç¯‡-2&quot;&gt;&lt;a href=&quot;#ioså­¦ä¹ ç¯‡-2&quot; class=&quot;headerlink&quot; title=&quot;ioså­¦ä¹ ç¯‡(2)&quot;&gt;&lt;/a&gt;ioså­¦ä¹ ç¯‡(2)&lt;/h1&gt;&lt;h2 id=&quot;ipaæ–‡ä»¶ç»“æ„&quot;&gt;&lt;a href=&quot;#ipaæ–‡ä»¶ç»“æ„&quot; class=&quot;head</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ioså­¦ä¹ ç¯‡(1)</title>
    <link href="https://straw-233.github.io/2024/04/13/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/"/>
    <id>https://straw-233.github.io/2024/04/13/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/</id>
    <published>2024-04-13T11:16:58.428Z</published>
    <updated>2024-04-13T13:53:27.911Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ioså­¦ä¹ ç¯‡-1"><a href="#ioså­¦ä¹ ç¯‡-1" class="headerlink" title="ioså­¦ä¹ ç¯‡(1)"></a>ioså­¦ä¹ ç¯‡(1)</h1><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>â€‹å“ï¼Œæ„Ÿè§‰å­¦å®‰å“å¤ªéš¾äº†ï¼Œæ²¡æœ‰ç”¨è¿‡å®‰å“ç³»ç»Ÿï¼Œä½†æ˜¯ä¹‹å‰æœ‰è¿‡iosè¶Šç‹±ç»éªŒï¼Œå¹²è„†ç›´æ¥å­¦iosé€†å‘å¥½äº†ã€‚å­¦äº†ä¸€ä¸ªæ˜ŸæœŸï¼Œæ‰åˆšæŠŠåŸºç¡€é¢˜åšå‡ºæ¥ã€‚ä¸ºäº†çœé’±ä¸ä¹°macï¼Œå°±ç”¨windowsç¡¬æï¼Œåƒå°½äº†è‹¦å¤´å•Šã€‚ã€‚ã€‚</p><h2 id="å·¥å…·-è®¾å¤‡"><a href="#å·¥å…·-è®¾å¤‡" class="headerlink" title="å·¥å…·&#x2F;è®¾å¤‡"></a>å·¥å…·&#x2F;è®¾å¤‡</h2><p>iphone 7ï¼šdopamine(å¤šå·´èƒº)ï¼Œç‰›è›™åŠ©æ‰‹ï¼Œå·¨é­”å•†åº—ï¼Œopen-sshï¼Œdebugserver</p><p>windowsç³»ç»Ÿï¼šsshï¼Œçˆ±æ€åŠ©æ‰‹ï¼Œida</p><h2 id="æ— æ ¹è¶Šç‹±-ä»…é€‚é…ios17ä»¥ä¸‹ç‰ˆæœ¬"><a href="#æ— æ ¹è¶Šç‹±-ä»…é€‚é…ios17ä»¥ä¸‹ç‰ˆæœ¬" class="headerlink" title="æ— æ ¹è¶Šç‹±(ä»…é€‚é…ios17ä»¥ä¸‹ç‰ˆæœ¬)"></a>æ— æ ¹è¶Šç‹±(ä»…é€‚é…ios17ä»¥ä¸‹ç‰ˆæœ¬)</h2><p>çœ‹äº†å¾ˆå¤šæ•™ç¨‹ï¼Œè¯•è¿‡äº†WinRa1nï¼Œç›´æ¥æŠ¥é”™å·®ç‚¹æˆä¸ºè‹¹æœæ¿ç –äº†ã€‚æ„Ÿè§‰è¿˜æ˜¯å¤šå·´èƒºä¸€é”®æœ€ç®€å•</p><h3 id="å‰ç½®æ­¥éª¤"><a href="#å‰ç½®æ­¥éª¤" class="headerlink" title="å‰ç½®æ­¥éª¤"></a>å‰ç½®æ­¥éª¤</h3><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E6%89%80%E9%9C%80%E8%BD%AF%E4%BB%B6.png" alt="æ‰€éœ€è½¯ä»¶"></p><p>â€‹å…ˆå»æŠŠçˆ±æ€åŠ©æ‰‹ä¸‹äº†ï¼Œçˆ±æ€èƒ½å¸®ä½ é…å¥½å¾ˆå¤šç¯å¢ƒï¼Œè¿˜æœ‰å”¯ä¸€å¯è§çš„uiï¼Œåªèƒ½æ‰§è¡Œ&#x2F;var&#x2F;mobile&#x2F;Mediaä¸‹çš„æ–‡ä»¶</p><p>â€‹å†å»ä¸‹ä¸ª<a href="https://ios222.com/">ç‰›è›™åŠ©æ‰‹å®˜ç½‘_è‹¹æœåŠ©æ‰‹</a>ï¼ŒBLFGToolè¿™ä¸ªå¯ä»¥å°†ä½ ä¸‹è½½çš„ipaè¿›è¡Œç­¾åå¹¶ä¸”å®‰è£…</p><p>â€‹ç­¾åè¯¦ç»†æ­¥éª¤å¯ä»¥è·Ÿç€<a href="https://www.bilibili.com/video/BV1jT4y1H7cu/?spm_id_from=333.337.search-card.all.click&vd_source=934266fa049a08cd3a0a9e4ceda56d20">ã€å…è´¹å…è¶Šç‹±ã€‘ç‰›è›™åŠ©æ‰‹iphoneæ‰‹æœº7å¤©è‡ªç­¾åç¥å™¨ æ‰‹æœºä¸Šè‡ªç­¾ ä»æ­¤å‘Šåˆ«ç”µè„‘ç­¾å è‹¹æœåº”ç”¨å¤šå¼€_å“”å“©å“”å“©_bilibili</a>æ¥æ“ä½œ</p><h3 id="ä¸­é—´æ­¥éª¤"><a href="#ä¸­é—´æ­¥éª¤" class="headerlink" title="ä¸­é—´æ­¥éª¤"></a>ä¸­é—´æ­¥éª¤</h3><p>â€‹åœ¨æ‰‹æœºä¸Šçš„safariæµè§ˆå™¨ä¸‹ä¸€ä¸ªdopamine(å¤šå·´èƒº)çš„ipaï¼Œç„¶åä¼ åˆ°ç‰›è›™åŠ©æ‰‹(å¦‚æœä½ æœ‰å·¨é­”å°±ç”¨å·¨é­”ï¼Œå› ä¸ºæˆ‘çš„å·¨é­”æ˜¯è¶Šç‹±åæå¾—)ä¸Šè¿›è¡Œç­¾åå®‰è£…ï¼Œæ‰“å¼€å¤šå·´èƒºåï¼Œå°±ç›´æ¥é»˜è®¤è®¾ç½®ç›´æ¥ä¸€é”®è¶Šç‹±å³å¯ï¼Œåç»­è®¾ç½®çš„å¯†ç è¦è®°ä½ï¼Œè®°å¾—ä½¿ç”¨sileoè¶Šç‹±å•†åº—ã€‚</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E5%A4%9A%E5%B7%B4%E8%83%BA.png" alt="å¤šå·´èƒº"></p><h3 id="åç»­æ­¥éª¤"><a href="#åç»­æ­¥éª¤" class="headerlink" title="åç»­æ­¥éª¤"></a>åç»­æ­¥éª¤</h3><p>æœ‰äº†sileoä»¥åï¼Œå°±å¯ä»¥æ·»åŠ å„ç§è½¯ä»¶æºï¼Œåœ¨æºä¸Šä¸‹è½½å¾ˆå¤šæ’ä»¶ï¼Œå·¥å…·ï¼Œè½¯ä»¶ç­‰ï¼Œæˆ‘çš„å­—ä½“ä¹Ÿæ˜¯è¿™é‡Œæ”¹çš„ã€‚</p><p>å…ˆåœ¨sileoä¸­æœTrollstore helperï¼Œå¯¹å·¨é­”å•†åº—è¿›è¡Œä¸€ä¸ªå®‰è£…(æ„Ÿè§‰æ˜¯é€šè¿‡ä¸€ä¸ªiosçš„æ¼æ´å®‰è£…çš„ï¼Œå› ä¸ºæ²¡è¶Šç‹±ä¹Ÿèƒ½è£…)ï¼Œå·¨é­”å•†åº—æ˜¯ä¸€ä¸ªä¸€ä¸ªipaç›´æ¥å®‰è£…çš„è¶…çº§ç‰›çš„å·¥å…·</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E5%B7%A8%E9%AD%94%E5%95%86%E5%BA%97.png" alt="å·¨é­”å•†åº—"></p><p>åé¢åœ¨sileoä¸Šå†è£…open-sshå’Œdebug-serverï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨windowsç³»ç»Ÿä¸­è¿›è¡Œç»ˆç«¯æ“ä½œï¼Œå’Œidaè¿œç¨‹è°ƒè¯•</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/open-ssh.png" alt="open-ssh"></p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/debugserver.png" alt="debugserver"></p><p>æœ€åæˆ‘å–œæ¬¢æä¸€ä¸ªFilzaï¼Œä¸€ä¸ªiosçš„æ–‡ä»¶ç®¡ç†å™¨ï¼Œè‡ªå¸¦é‚£ä¸ªæƒé™å¤ªä½äº†ï¼Œå•¥æ“ä½œä¹Ÿæ²¡æœ‰ï¼Œè¿™ä¸ªå°±è·Ÿå®‰å“çš„æ–‡ä»¶ç®¡ç†å™¨ç›¸ä¼¼äº†ã€‚</p><h2 id="sshè¿æ¥"><a href="#sshè¿æ¥" class="headerlink" title="sshè¿æ¥"></a>sshè¿æ¥</h2><p>ç¡®ä¿ä¸¤å°è®¾å¤‡åœ¨åŒä¸€ç½‘ç»œä¸‹ï¼Œä½¿ç”¨sshï¼Œè¿›è¡Œè¿æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.x.xxx</span><br></pre></td></tr></table></figure><p>è¾“å…¥å¯†ç ï¼Œä¸€èˆ¬é»˜è®¤æ˜¯alpineæˆ–è€…æ˜¯ä½ ä¹‹å‰è¶Šç‹±è®¾ç½®çš„å¯†ç </p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/ssh%E8%BF%9E%E6%8E%A5.png" alt="sshè¿æ¥"></p><p>è¿™æ ·å°±æˆåŠŸè¿›å…¥äº†ï¼Œiosç³»ç»Ÿæ˜¯åŸºäºunixç³»ç»Ÿçš„ï¼Œæ‰€ä»¥ä¸€äº›å¸¸è§çš„linuxæŒ‡ä»¤ä¹Ÿèƒ½è¿è¡Œ</p><h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><p>ä»¥crack me1è¿™é¢˜ä¸ºä¾‹å­ï¼Œæ¥æ¼”ç¤ºä¸€ä¸‹</p><h3 id="ipa"><a href="#ipa" class="headerlink" title="ipa"></a>ipa</h3><p>ä¸€èˆ¬ç»™ä½ çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªipaçš„æ–‡ä»¶ï¼ˆå¾ˆå¤šæ­£å¼çš„ipaéƒ½ä¼šæœ‰å¸¦å£³ï¼Œéœ€è¦å¯¹å£³è¿›è¡Œç ¸å£³å¤„ç†ï¼Œä½†è¿™é¢˜æ²¡æœ‰ï¼‰ï¼Œç›¸å½“äºå®‰å“é‡Œçš„apkæ–‡ä»¶ï¼Œå…¶å®æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œç”¨å‹ç¼©åŒ…æ‰“å¼€åï¼Œè¿›å…¥&#x2F;Payload&#x2F;crack me1.app&#x2F;</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/ipa%E6%96%87%E4%BB%B6.png" alt="ipaæ–‡ä»¶"></p><p>å°±å¯ä»¥çœ‹åˆ°å…¨éƒ¨çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬ä¸»è¦ç”¨åˆ°çš„æ˜¯ä¸€ä¸ªmach-oçš„æ–‡ä»¶ï¼Œæ˜¯macå’Œiosç³»ç»Ÿä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå°±æ˜¯é‚£ä¸ªcrack me1ï¼Œå…³äºå…¶ä»–æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ipaç»“æ„è¿›è¡Œåˆ†ææŸ¥çœ‹ã€‚</p><p>å°†è¿™ä¸ªipaä¼ åˆ°å·¨é­”å•†åº—é‡Œè¿›è¡Œå®‰è£…ï¼Œæ‰“å¼€</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E9%A2%98%E7%9B%AE.png" alt="é¢˜ç›®"></p><h3 id="mach-o"><a href="#mach-o" class="headerlink" title="mach-o"></a>mach-o</h3><p>å…³äºæ€ä¹ˆåˆ¤æ–­å“ªä¸ªæ–‡ä»¶ä¸ºmach-oæ–‡ä»¶ï¼Œå…¶å®å¯ä»¥ç”¨010ä¸­çš„mach-oçš„æ¨¡æ¿çœ‹ï¼Œå› ä¸ºè¯¥ç±»æ–‡ä»¶çš„æ–‡ä»¶å¤´å’Œjavaçš„.classæ–‡ä»¶ç›¸åŒï¼Œéƒ½æ˜¯CA FE BA BE(å’–å•¡å®è´)</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E5%A4%B4%E6%96%87%E4%BB%B6.png" alt="å¤´æ–‡ä»¶"></p><p>æ¨¡æ¿ä¸­ä¹Ÿèƒ½çœ‹åˆ°å¾ˆå¤šæ–‡ä»¶å¤´ï¼Œå‡½æ•°è¡¨ï¼Œæ•°æ®åº“ä¿¡æ¯ç­‰</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/mach-o%E7%BB%93%E6%9E%84.png" alt="mach-oç»“æ„"></p><p>å½“ç„¶å¦‚æœä½ æœ‰macï¼Œä½¿ç”¨machoviewä¼šæ›´æ–¹ä¾¿</p><p>é€šè¿‡010æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶æŠŠ32ä½å’Œ64ä½æ¶æ„å…¨éƒ¨æ•´åˆè¿›å»äº†ï¼Œæ‰€ä»¥è¿™ä¸ªæ–‡ä»¶æ— è®ºåœ¨å“ªç§armæ¶æ„ä¸‹éƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†æˆ‘ä»¬æ‰‹æœºåŸºæœ¬ç”¨çš„æ˜¯arm64ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ida64å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æã€‚</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/main%E5%87%BD%E6%95%B0.png" alt="mainå‡½æ•°"></p><p>æ‰“å¼€ï¼Œå‘ç°ä¹Ÿèƒ½æ­£å¸¸åç¼–è¯‘ï¼Œæ˜¯ä½¿ç”¨object-cå†™çš„ï¼Œå·¦è¾¹çš„å‡½æ•°è¡¨ä¸­æœ‰ä¸€å †ï¼Œç„¶åmainå‡½æ•°åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ²¡æœ‰å…³é”®å‡½æ•°ï¼Œæ‰€ä»¥ä»AppDelegateï¼ŒViewControllerï¼ŒGTMBase64è¿™å‡ ä¸ªå¤§ç±»ä¸‹æ‰‹ã€‚</p><p><a href="https://juejin.cn/post/6951591401528229895">iOSåº”ç”¨çš„å¯åŠ¨æµç¨‹å’Œä¼˜åŒ–è¯¦è§£ - æ˜é‡‘ (juejin.cn)</a></p><p><a href="https://www.cnblogs.com/hubert-style/p/15408236.html">iOSç¨‹åºå…¥å£ç»“æ„ - èƒŒåŒ…ã®æŠ€æœ¯ - åšå®¢å›­ (cnblogs.com)</a></p><h3 id="idaåˆ†æ"><a href="#idaåˆ†æ" class="headerlink" title="idaåˆ†æ"></a>idaåˆ†æ</h3><p>çœ‹äº†ä¸€å †æ–‡ç« å†åŠ éšä¾¿ä¹±ç‚¹ä»¥åï¼Œå‘ç°äº†å…³é”®å‡½æ•°ä½ç½®ViewController touch</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E5%85%B3%E9%94%AE%E5%87%BD%E6%95%B0.png" alt="å…³é”®å‡½æ•°"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v33[2] = self;//æŒ‡å‘åº”ç”¨ç¨‹åºçš„å§”æ‰˜å¯¹è±¡çš„æŒ‡é’ˆ</span><br><span class="line">v33[1] = (id)a2;//é€‰æ‹©å™¨</span><br><span class="line">v33[0] = objc_retain(&amp;cfstr_Crack);//v33=&quot;crack&quot;</span><br><span class="line">v2 = +[ViewController DES:KEY:](&amp;OBJC_CLASS___ViewController, &quot;DES:KEY:&quot;, string, v33[0]);//DESåŠ å¯†</span><br><span class="line">v32 = objc_retainAutoreleasedReturnValue(v2);//æ¸…ç©ºé‡Šæ”¾</span><br><span class="line">v3 = objc_msgSend((id)textfield, &quot;text&quot;);//ç›¸å½“äºscanfï¼Œè·å–textçª—å£ä¸­çš„æ•°æ®</span><br><span class="line">v25 = objc_retainAutoreleasedReturnValue(v3);//æ¸…ç©ºé‡Šæ”¾</span><br><span class="line">v24 = (unsigned __int8)objc_msgSend(v32, &quot;isEqualToString:&quot;, v25);//æ¯”è¾ƒ</span><br><span class="line">objc_release(v25);</span><br></pre></td></tr></table></figure><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/DES%E5%8A%A0%E5%AF%86.png" alt="DESåŠ å¯†"></p><p>ç»†çœ‹DESåŠ å¯†çš„å‡½æ•°ï¼Œè¦æ˜¯ä¸ç»™å‡½æ•°åï¼Œä¼°è®¡æ›´éš¾çœ‹ï¼Œè¿™è¾¹è°ƒç”¨äº†CommonCrypto åº“ä¸­çš„ CCCrypt å‡½æ•°è¿›è¡ŒåŠ å¯†æˆ–è§£å¯†æ“ä½œ</p><p>è¿›å…¥CCCryptç»†çœ‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CCCryptorStatus __cdecl CCCrypt(</span><br><span class="line">        CCOperation op,</span><br><span class="line">        CCAlgorithm alg,</span><br><span class="line">        CCOptions options,</span><br><span class="line">        const void *key,</span><br><span class="line">        size_t keyLength,</span><br><span class="line">        const void *iv,</span><br><span class="line">        const void *dataIn,</span><br><span class="line">        size_t dataInLength,</span><br><span class="line">        void *dataOut,</span><br><span class="line">        size_t dataOutAvailable,</span><br><span class="line">        size_t *dataOutMoved)</span><br><span class="line">&#123;</span><br><span class="line">  return _CCCrypt(op, alg, options, key, keyLength, iv, dataIn, dataInLength, dataOut, dataOutAvailable, dataOutMoved);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è§£é‡Šä¸€ä¸‹æ¯ä¸ªå‚æ•°çš„ä½œç”¨ï¼š</span><br><span class="line">op: è¡¨ç¤ºè¿›è¡ŒåŠ å¯†è¿˜æ˜¯è§£å¯†æ“ä½œï¼Œå¯ä»¥æ˜¯ kCCEncrypt æˆ– kCCDecryptã€‚</span><br><span class="line">alg: è¡¨ç¤ºä½¿ç”¨çš„åŠ å¯†ç®—æ³•ï¼Œä¾‹å¦‚ kCCAlgorithmAES è¡¨ç¤ºä½¿ç”¨ AES ç®—æ³•ã€‚</span><br><span class="line">options: ç”¨äºæŒ‡å®šåŠ å¯†é€‰é¡¹ï¼Œä¾‹å¦‚å¡«å……æ–¹å¼ç­‰ã€‚</span><br><span class="line">key: è¡¨ç¤ºåŠ å¯†æˆ–è§£å¯†æ‰€ä½¿ç”¨çš„å¯†é’¥ã€‚</span><br><span class="line">keyLength: è¡¨ç¤ºå¯†é’¥çš„é•¿åº¦ã€‚</span><br><span class="line">iv: è¡¨ç¤ºåˆå§‹åŒ–å‘é‡ï¼ˆInitialization Vectorï¼‰ï¼Œåœ¨æŸäº›åŠ å¯†æ¨¡å¼ä¸‹ä¼šä½¿ç”¨åˆ°ã€‚</span><br><span class="line">dataIn: è¡¨ç¤ºå¾…åŠ å¯†æˆ–è§£å¯†çš„æ•°æ®è¾“å…¥ã€‚</span><br><span class="line">dataInLength: è¡¨ç¤ºå¾…åŠ å¯†æˆ–è§£å¯†çš„æ•°æ®è¾“å…¥é•¿åº¦ã€‚</span><br><span class="line">dataOut: è¡¨ç¤ºåŠ å¯†æˆ–è§£å¯†åçš„æ•°æ®è¾“å‡ºã€‚</span><br><span class="line">dataOutAvailable: è¡¨ç¤ºè¾“å‡ºç¼“å†²åŒºçš„å¯ç”¨ç©ºé—´å¤§å°ã€‚</span><br><span class="line">dataOutMoved: è¡¨ç¤ºå®é™…å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºçš„æ•°æ®é•¿åº¦ã€‚</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®å‚æ•°çœ‹å‡ºæ¥æ˜¯DES&#x2F;pkcs7&#x2F;ECBåŠ å¯†ï¼Œå¯†æ–‡æ˜¯1hKgkdbhfbeu6755d8fkï¼Œå¯†é’¥æ˜¯crackï¼Œä½†æ˜¯è‡ªå·±åŠ å¯†å‡ºæ¥ç»“æœæ€ä¹ˆéƒ½æ˜¯æ˜¯é”™çš„ï¼Œæ„Ÿè§‰æ˜¯å¯†é’¥å¡«å……çš„é—®é¢˜ï¼Œå“ï¼Œè¦æ˜¯èƒ½åŠ¨æ€è°ƒè¯•è¿™é¢˜å°±ç§’æ€äº†ã€‚</p><h3 id="åŠ¨æ€è°ƒè¯•-1"><a href="#åŠ¨æ€è°ƒè¯•-1" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h3><p>æœ€ç…ç†¬çš„åœ°æ–¹ï¼Œçœ‹äº†æ— æ•°æ–‡ç« ï¼Œæ— é™ä¸ªæŠ¥é”™ï¼Œç»ˆäºæˆåŠŸåŠ¨è°ƒäº†ã€‚</p><p>å› ä¸ºidaæœ¬èº«ä¸è‡ªå¸¦iphone-serverï¼ˆä¸ºä»€ä¹ˆmacos-serveréƒ½æœ‰ï¼ŒiPhoneæ²¡æœ‰ï¼Ÿæ€’äº†ï¼‰ï¼Œæˆ‘ä»¬è¦ç”¨å…¶ä»–çš„æ–¹æ³•è°ƒè¯•</p><p>æˆ‘å…ˆå°è¯•äº†ç”¨ç½‘ä¸Šä¸‹è½½çš„debug-serverï¼Œä½†æ˜¯å› ä¸ºiphoneè‡ªèº«æé«˜çš„ä¿æŠ¤ï¼Œä¿®æ”¹äº†å„ç§æƒé™åï¼Œè¿˜æ˜¯ä¸€æ‰§è¡Œå°±æŠŠæˆ‘killæ‰ï¼Œä¼°è®¡ä¹Ÿæ˜¯å› ä¸ºç­¾åé—®é¢˜ï¼Œiphone çš„ä¿æŠ¤çœŸæ˜¯å¥½å•Šï¼</p><p>äºæ˜¯åˆæœåˆ°sileoä¸­çš„è‡ªå¸¦çš„debugserverï¼Œåœ¨iphoneä¸­å®‰è£…å®Œdebugserveråï¼Œå°±å·²ç»åœ¨ç¯å¢ƒå˜é‡ä¸­èƒ½ç›´æ¥ä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">debugserver-@(#)PROGRAM:LLDB  PROJECT:lldb-14.0.0</span><br><span class="line"> for arm64.</span><br><span class="line">Usage:</span><br><span class="line">  debugserver host:port [program-name program-arg1 program-arg2 ...]</span><br><span class="line">  debugserver /path/file [program-name program-arg1 program-arg2 ...]</span><br><span class="line">  debugserver host:port --attach=&lt;pid&gt;</span><br><span class="line">  debugserver /path/file --attach=&lt;pid&gt;</span><br><span class="line">  debugserver host:port --attach=&lt;process_name&gt;</span><br><span class="line">  debugserver /path/file --attach=&lt;process_name&gt;</span><br></pre></td></tr></table></figure><p>å°†æˆ‘ä»¬çš„é¢˜ç›®åœ¨æ‰‹æœºä¸­æ‰“å¼€</p><p>å…ˆè¦æŸ¥çœ‹ä½ æ‰€è¿è¡Œçš„ç¨‹åºçš„PIDï¼Œç®€å•çš„grepæŸ¥æ‰¾æŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep crack</span><br></pre></td></tr></table></figure><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/PID%E6%9F%A5%E7%9C%8B.png" alt="PIDæŸ¥çœ‹"></p><p>å¯ä»¥çœ‹åˆ°PIDä¸º37918</p><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">debugserver 192.168.x.xxx:3333</span><br><span class="line">               ç”µè„‘çš„ip  ç«¯å£(é»˜è®¤)</span><br></pre></td></tr></table></figure><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E7%9B%91%E5%90%AC.png" alt="ç›‘å¬"></p><p>æ‰“å¼€ida,è¿œç¨‹è°ƒè¯•å‚æ•°è®¾ç½®</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/ip%E8%AE%BE%E7%BD%AE.png" alt="ipè®¾ç½®"></p><p>é‚£ä¸ªhostnameå¡«çš„æ˜¯ä½ æ‰‹æœºçš„ipåœ°å€ï¼Œè·Ÿä¸Šé¢çš„ç›¸å</p><p>è¿ä¸Šåå†ç”¨attach processè¾“å…¥åˆšæ‰è·å–çš„ç¨‹åºPIDï¼Œè¿›è¡Œé™„åŠ </p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E7%AB%AF%E5%8F%A3%E8%AE%BE%E7%BD%AE.png" alt="ç«¯å£è®¾ç½®"></p><p>è¦æ…¢æ…¢waitï¼Œç­‰å¾…å„ç§å‡½æ•°åŠ è½½å¥½ï¼Œè¿™æ ·å°±å¯ä»¥æ­£å¸¸è°ƒè¯•äº†ï¼Œæˆ‘ä»¬åœ¨åˆšæ‰é‚£ä¸ªåˆ†æçš„åˆ¤æ–­å‡½æ•°ä¸‹æ–­ä¸ªæ–­ç‚¹</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E4%B8%8B%E6%96%AD%E7%82%B9.png" alt="ä¸‹æ–­ç‚¹"></p><p>ç‚¹è¿›v32</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E5%9C%B0%E5%9D%80.png" alt="åœ°å€"></p><p>ä¸€ä¸ªåœ°å€ï¼Œå†è¿›å»</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/flag.png" alt="flag"></p><p>ä¸‹é¢å°±æ˜¯æˆ‘ä»¬çš„flagå•¦</p><p>è¾“å…¥æˆ‘ä»¬çš„appè¿›è¡ŒéªŒè¯</p><p><img src="/../img/ios%E5%AD%A6%E4%B9%A0%E7%AF%87(1)/%E9%AA%8C%E8%AF%81%E6%88%90%E5%8A%9F.png" alt="éªŒè¯æˆåŠŸ"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ioså­¦ä¹ ç¯‡-1&quot;&gt;&lt;a href=&quot;#ioså­¦ä¹ ç¯‡-1&quot; class=&quot;headerlink&quot; title=&quot;ioså­¦ä¹ ç¯‡(1)&quot;&gt;&lt;/a&gt;ioså­¦ä¹ ç¯‡(1)&lt;/h1&gt;&lt;h2 id=&quot;å¼•è¨€&quot;&gt;&lt;a href=&quot;#å¼•è¨€&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡</title>
    <link href="https://straw-233.github.io/2024/03/27/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E7%AF%87/"/>
    <id>https://straw-233.github.io/2024/03/27/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E7%AF%87/</id>
    <published>2024-03-27T13:23:15.049Z</published>
    <updated>2024-03-27T13:43:28.160Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡"><a href="#åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡" class="headerlink" title="åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡"></a>åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡</h1><p>æ„Ÿè§‰åæ··æ·†æ¯”æ··æ·†éš¾å¤šäº†ã€‚ã€‚ã€‚</p><p>ç°åœ¨ä¹Ÿæš‚æ—¶ä¸ä¼šæ€ä¹ˆè‡ªå·±å†™ida-pythonè„šæœ¬æ¥åæ··æ·†</p><p>è¿˜æ˜¯å…ˆå­¦å­¦çœ‹å§</p><h2 id="deflatå·¥å…·ä»‹ç»"><a href="#deflatå·¥å…·ä»‹ç»" class="headerlink" title="deflatå·¥å…·ä»‹ç»"></a>deflatå·¥å…·ä»‹ç»</h2><p>ç½‘ä¸Šå¸¸ç”¨çš„åæ§åˆ¶æµå¹³å¦åŒ–çš„å·¥å…·ï¼Œå¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œå°†ç»è¿‡flaç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶è½¬åŒ–ä¸ºåæ··æ·†è¿‡çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ”¯æŒarmæ¶æ„ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/cq674350529/deflat">deflat: use angr to deobfuscation </a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python deflat.py --file æ–‡ä»¶å --addr åˆå§‹åœ°å€</span><br></pre></td></tr></table></figure><p>éœ€è¦ä¸€ä¸ªpythonçš„angråº“</p><p>å› ä¸ºè¦ç”¨åˆ°åˆå§‹åœ°å€ï¼Œæ‰€ä»¥å°±è¦æ±‚ä½ çš„å¯æ‰§è¡Œæ–‡ä»¶æ²¡å¼€PIEï¼ˆéšæœºåœ°å€ï¼‰ä¿æŠ¤</p><p>ï¼ˆè¦æ±‚è¿˜æŒºè‹›åˆ»çš„ï¼Œä¼°è®¡åªæœ‰æ¯”èµ›å€¼å¾—ä¸€ç”¨ï¼Œå®æˆ˜ä¼°è®¡å…¨æ˜¯ä¿æŠ¤å…¨å¼€ï¼Œä¼˜ç‚¹å°±æ˜¯å¸¸ç”¨æ¶æ„éƒ½èƒ½ç”¨ï¼‰</p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><p>è‡ªå·±å…ˆç”¨ç¼–è¯‘ä¸€ä¸ªä¿æŠ¤å…¨å…³çš„ç»è¿‡flaè¿‡çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">opt -lowerswitch -S IR/TestProgram.ll -o IR/TestProgram_lowerswitch.ll</span><br><span class="line">opt -load ../Build/LLVMObfuscator.so -fla -S -enable-new-pm=0 IR/TestProgram_lowerswitch.ll -o IR/TestProgram_fla.ll</span><br><span class="line">clang IR/TestProgram_fla.ll -o Bin/TestProgram_fla -fno-stack-protector -z execstack -no-pie</span><br></pre></td></tr></table></figure><p><img src="/../img/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%E7%AF%87/image-20240327201723919.png" alt="image-20240327201723919"></p><p>ç”¨idaçœ‹çœ‹ï¼Œå¾ˆå¸¸è§„çš„æ§åˆ¶æµå¹³å¦åŒ–</p><p><img src="/../img/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%E7%AF%87/image-20240327201828945.png" alt="image-20240327201828945"></p><p>ç”¨å·¥å…·è½¬åŒ–ä¸€ä¸‹ï¼Œå¾—åˆ°äº†ä¸ªTestProgram_fla_unprotect_recoveredæ–‡ä»¶</p><p><img src="/../img/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%E7%AF%87/image-20240327202021043.png" alt="image-20240327202021043"></p><p>ç¡®å®åæ··æ·†äº†ï¼Œæ•ˆæœä¸é”™</p><p><img src="/../img/%E5%8F%8D%E6%B7%B7%E6%B7%86%E5%AD%A6%E4%B9%A0-fla%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96%E7%AF%87/image-20240327202141816.png" alt="image-20240327202141816"></p><p>è¿™ä¸‹é¢æœ‰ä¸€å †nopçœ‹æ¥æ˜¯æŠŠä¸€äº›è·³è½¬æŒ‡ä»¤å…¨å»äº†ï¼Œå¹¶è¿›è¡Œäº†è¡¥å…¨</p><h2 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h2><p>è¯¦ç»†å­¦ä¹ å¤ªå¤æ‚ï¼Œç®€å•æ¦‚è¿°ä¸€ä¸‹å¤§æ¦‚æµç¨‹</p><h3 id="ä¸»å‡½æ•°"><a href="#ä¸»å‡½æ•°" class="headerlink" title="ä¸»å‡½æ•°"></a>ä¸»å‡½æ•°</h3><p>å¼•å…¥ï¼š</p><ol><li>å‡½æ•°çš„å¼€å§‹åœ°å€ä¸ºåºè¨€çš„åœ°å€</li><li>åºè¨€çš„åç»§ä¸ºä¸»åˆ†å‘å™¨</li><li>åç»§ä¸ºä¸»åˆ†å‘å™¨çš„å—ä¸ºé¢„å¤„ç†å™¨</li><li>åç»§ä¸ºé¢„å¤„ç†å™¨çš„å—ä¸ºçœŸå®å—</li><li>æ— åç»§çš„å—ä¸ºè¿”å›å—</li><li>å‰©ä¸‹çš„ä¸ºæ— ç”¨å—</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;deflat control flow script&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--file&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;binary to analyze&quot;</span>)</span><br><span class="line">    parser.add_argument(</span><br><span class="line">        <span class="string">&quot;--addr&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;address of target function in hex format&quot;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> args.file <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> args.addr <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    filename = args.file</span><br><span class="line">    start = <span class="built_in">int</span>(args.addr, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    project = angr.Project(filename, load_options=&#123;<span class="string">&#x27;auto_load_libs&#x27;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    <span class="comment"># do normalize to avoid overlapping blocks, disable force_complete_scan to avoid possible &quot;wrong&quot; blocks</span></span><br><span class="line">    <span class="comment"># è·å–æ§åˆ¶æµ</span></span><br><span class="line">    cfg = project.analyses.CFGFast(normalize=<span class="literal">True</span>, force_complete_scan=<span class="literal">False</span>)</span><br><span class="line">    target_function = cfg.functions.get(start)</span><br><span class="line">    <span class="comment"># A super transition graph is a graph that looks like IDA Pro&#x27;s CFG</span></span><br><span class="line">    supergraph = am_graph.to_supergraph(target_function.transition_graph)</span><br><span class="line"></span><br><span class="line">    base_addr = project.loader.main_object.mapped_base &gt;&gt; <span class="number">12</span> &lt;&lt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get prologue_node and retn_node</span></span><br><span class="line">    <span class="comment"># ä»æ§åˆ¶æµä¸­è·å–è¿”å›å—å’Œåºè¨€</span></span><br><span class="line">    prologue_node = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.in_degree(node) == <span class="number">0</span>:</span><br><span class="line">            prologue_node = node</span><br><span class="line">        <span class="keyword">if</span> supergraph.out_degree(node) == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">len</span>(node.out_branches) == <span class="number">0</span>:</span><br><span class="line">            retn_node = node</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> prologue_node <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> prologue_node.addr != start:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Something must be wrong...&quot;</span>)</span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸»åˆ†å‘å™¨ï¼ŒsuccessorsåŒ…æ‹¬äº†æ‰€æœ‰æ­£å¸¸çš„åç»­list</span></span><br><span class="line">    main_dispatcher_node = <span class="built_in">list</span>(supergraph.successors(prologue_node))[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰¾åˆ°é¢„å¤„ç†å™¨</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.predecessors(main_dispatcher_node):</span><br><span class="line">        <span class="keyword">if</span> node.addr != prologue_node.addr:</span><br><span class="line">            pre_dispatcher_node = node</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># æ‰¾åˆ°çœŸå®å—å’Œé¢„å¤„ç†å—ï¼ˆè™šå‡å—ï¼‰</span></span><br><span class="line">    relevant_nodes, nop_nodes = get_relevant_nop_nodes(</span><br><span class="line">        supergraph, pre_dispatcher_node, prologue_node, retn_node)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************relevant blocks************************&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;prologue: %#x&#x27;</span> % start)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;main_dispatcher: %#x&#x27;</span> % main_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;pre_dispatcher: %#x&#x27;</span> % pre_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;retn: %#x&#x27;</span> % retn_node.addr)</span><br><span class="line">    relevant_block_addrs = [node.addr <span class="keyword">for</span> node <span class="keyword">in</span> relevant_nodes]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;relevant_blocks:&#x27;</span>, [<span class="built_in">hex</span>(addr) <span class="keyword">for</span> addr <span class="keyword">in</span> relevant_block_addrs])</span><br><span class="line"><span class="comment"># æ‰“å°ç›¸å…³å—ä¿¡æ¯</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************symbolic execution*********************&#x27;</span>)</span><br><span class="line">    relevants = relevant_nodes</span><br><span class="line">    relevants.append(prologue_node)</span><br><span class="line">    relevants_without_retn = <span class="built_in">list</span>(relevants)</span><br><span class="line">    relevants.append(retn_node)</span><br><span class="line">    relevant_block_addrs.extend([prologue_node.addr, retn_node.addr])</span><br><span class="line"></span><br><span class="line">    flow = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    patch_instrs = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> relevant <span class="keyword">in</span> relevants_without_retn:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-------------------dse %#x---------------------&#x27;</span> % relevant.addr)</span><br><span class="line">        block = project.factory.block(relevant.addr, size=relevant.size)</span><br><span class="line">        has_branches = <span class="literal">False</span></span><br><span class="line">        hook_addrs = <span class="built_in">set</span>([])</span><br><span class="line">        <span class="keyword">for</span> ins <span class="keyword">in</span> block.capstone.insns:</span><br><span class="line">            <span class="comment"># ä¸åŒæ¶æ„çš„åŒºåˆ†</span></span><br><span class="line">            <span class="keyword">if</span> project.arch.name <span class="keyword">in</span> ARCH_X86:</span><br><span class="line">                <span class="comment"># åˆ¤æ–­è¯¥çœŸå®å—æ˜¯å¦å­˜åœ¨åˆ†æ”¯</span></span><br><span class="line">                <span class="keyword">if</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;cmov&#x27;</span>):</span><br><span class="line">                    <span class="comment"># only record the first one</span></span><br><span class="line">                    <span class="keyword">if</span> relevant <span class="keyword">not</span> <span class="keyword">in</span> patch_instrs:</span><br><span class="line">                        patch_instrs[relevant] = ins</span><br><span class="line">                        has_branches = <span class="literal">True</span></span><br><span class="line">                <span class="comment"># callæŒ‡ä»¤å¯¹angræ²¡å½±å“ï¼Œç›´æ¥hook</span></span><br><span class="line">                <span class="keyword">elif</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;call&#x27;</span>):</span><br><span class="line">                    hook_addrs.add(ins.insn.address)</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM:</span><br><span class="line">                <span class="keyword">if</span> ins.insn.mnemonic != <span class="string">&#x27;mov&#x27;</span> <span class="keyword">and</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;mov&#x27;</span>):</span><br><span class="line">                    <span class="keyword">if</span> relevant <span class="keyword">not</span> <span class="keyword">in</span> patch_instrs:</span><br><span class="line">                        patch_instrs[relevant] = ins</span><br><span class="line">                        has_branches = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">elif</span> ins.insn.mnemonic <span class="keyword">in</span> &#123;<span class="string">&#x27;bl&#x27;</span>, <span class="string">&#x27;blx&#x27;</span>&#125;:</span><br><span class="line">                    hook_addrs.add(ins.insn.address)</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM64:</span><br><span class="line">                <span class="keyword">if</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;cset&#x27;</span>):</span><br><span class="line">                    <span class="keyword">if</span> relevant <span class="keyword">not</span> <span class="keyword">in</span> patch_instrs:</span><br><span class="line">                        patch_instrs[relevant] = ins</span><br><span class="line">                        has_branches = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">elif</span> ins.insn.mnemonic <span class="keyword">in</span> &#123;<span class="string">&#x27;bl&#x27;</span>, <span class="string">&#x27;blr&#x27;</span>&#125;:</span><br><span class="line">                    hook_addrs.add(ins.insn.address)</span><br><span class="line">                    </span><br><span class="line">        <span class="comment"># angrç¬¦å·æ‰§è¡Œï¼Œå¯¹äºä¸¤ä¸ªåˆ†æ”¯çš„è¿›è¡Œæ¨¡æ‹Ÿï¼Œè·å–åç»­èŠ‚ç‚¹  </span></span><br><span class="line">        <span class="keyword">if</span> has_branches:</span><br><span class="line">            tmp_addr = symbolic_execution(project, relevant_block_addrs,</span><br><span class="line">                                                     relevant.addr, hook_addrs, claripy.BVV(<span class="number">1</span>, <span class="number">1</span>), <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">if</span> tmp_addr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                flow[relevant].append(tmp_addr)</span><br><span class="line">            tmp_addr = symbolic_execution(project, relevant_block_addrs,</span><br><span class="line">                                                     relevant.addr, hook_addrs, claripy.BVV(<span class="number">0</span>, <span class="number">1</span>), <span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">if</span> tmp_addr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                flow[relevant].append(tmp_addr)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp_addr = symbolic_execution(project, relevant_block_addrs,</span><br><span class="line">                                                     relevant.addr, hook_addrs)</span><br><span class="line">            <span class="keyword">if</span> tmp_addr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                flow[relevant].append(tmp_addr)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************flow******************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % k.addr, [<span class="built_in">hex</span>(child) <span class="keyword">for</span> child <span class="keyword">in</span> v])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % retn_node.addr, [])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************patch*****************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> origin:</span><br><span class="line">        <span class="comment"># Attention: can&#x27;t transform to str by calling decode() directly. so use bytearray instead.</span></span><br><span class="line">        origin_data = <span class="built_in">bytearray</span>(origin.read())</span><br><span class="line">        origin_data_len = <span class="built_in">len</span>(origin_data)</span><br><span class="line">        <span class="comment"># æ‰“å¼€æ–‡ä»¶ï¼Œè®°å½•é•¿åº¦</span></span><br><span class="line"></span><br><span class="line">    recovery_file = filename + <span class="string">&#x27;_recovered&#x27;</span></span><br><span class="line">    recovery = <span class="built_in">open</span>(recovery_file, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    <span class="comment"># é‡å‘½åä¸º_recoveredæ–‡ä»¶å¹¶é‡æ–°æ‰“å¼€</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># patch irrelevant blocks</span></span><br><span class="line">    <span class="keyword">for</span> nop_node <span class="keyword">in</span> nop_nodes:</span><br><span class="line">        fill_nop(origin_data, nop_node.addr-base_addr,</span><br><span class="line">                 nop_node.size, project.arch)</span><br><span class="line">    <span class="comment"># å¦‚æœåœ¨nopåˆ—è¡¨ä¸­å…¨nopäº†</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># remove unnecessary control flows</span></span><br><span class="line">    <span class="keyword">for</span> parent, childs <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(childs) == <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># å­èŠ‚ç‚¹ä¸º1çš„æ“ä½œ</span></span><br><span class="line">            parent_block = project.factory.block(parent.addr, size=parent.size)</span><br><span class="line">            last_instr = parent_block.capstone.insns[-<span class="number">1</span>]</span><br><span class="line">            file_offset = last_instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch the last instruction to jmp</span></span><br><span class="line">            <span class="keyword">if</span> project.arch.name <span class="keyword">in</span> ARCH_X86:</span><br><span class="line">                fill_nop(origin_data, file_offset,</span><br><span class="line">                         last_instr.size, project.arch)</span><br><span class="line">                patch_value = ins_j_jmp_hex_x86(last_instr.address, childs[<span class="number">0</span>], <span class="string">&#x27;jmp&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM:</span><br><span class="line">                patch_value = ins_b_jmp_hex_arm(last_instr.address, childs[<span class="number">0</span>], <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&quot;Iend_BE&quot;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM64:</span><br><span class="line">                <span class="comment"># <span class="doctag">FIXME:</span> For aarch64/arm64, the last instruction of prologue seems useful in some cases, so patch the next instruction instead.</span></span><br><span class="line">                <span class="keyword">if</span> parent.addr == start:</span><br><span class="line">                    file_offset += <span class="number">4</span></span><br><span class="line">                    patch_value = ins_b_jmp_hex_arm64(last_instr.address+<span class="number">4</span>, childs[<span class="number">0</span>], <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    patch_value = ins_b_jmp_hex_arm64(last_instr.address, childs[<span class="number">0</span>], <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&quot;Iend_BE&quot;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">            patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line">            <span class="comment"># é’ˆå¯¹ä¸åŒæ¶æ„å°†çˆ¶èŠ‚ç‚¹çš„æœ€åä¸€æ¡æŒ‡ä»¤ä¿®è¡¥ä¸ºè·³è½¬è‡³å­èŠ‚ç‚¹çš„è·³è½¬æŒ‡ä»¤</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å­èŠ‚ç‚¹å¤šä¸ªçš„æ“ä½œ</span></span><br><span class="line">            instr = patch_instrs[parent]</span><br><span class="line">            file_offset = instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch instructions starting from `cmovx` to the end of block</span></span><br><span class="line">            fill_nop(origin_data, file_offset, parent.addr +</span><br><span class="line">                     parent.size - base_addr - file_offset, project.arch)</span><br><span class="line">            <span class="keyword">if</span> project.arch.name <span class="keyword">in</span> ARCH_X86:</span><br><span class="line">                <span class="comment"># patch the cmovx instruction to jx instruction</span></span><br><span class="line">                patch_value = ins_j_jmp_hex_x86(instr.address, childs[<span class="number">0</span>], instr.mnemonic[<span class="built_in">len</span>(<span class="string">&#x27;cmov&#x27;</span>):])</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line"></span><br><span class="line">                file_offset += <span class="number">6</span></span><br><span class="line">                <span class="comment"># patch the next instruction to jmp instrcution</span></span><br><span class="line">                patch_value = ins_j_jmp_hex_x86(instr.address+<span class="number">6</span>, childs[<span class="number">1</span>], <span class="string">&#x27;jmp&#x27;</span>)</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM:</span><br><span class="line">                <span class="comment"># patch the movx instruction to bx instruction</span></span><br><span class="line">                bx_cond = <span class="string">&#x27;b&#x27;</span> + instr.mnemonic[<span class="built_in">len</span>(<span class="string">&#x27;mov&#x27;</span>):]</span><br><span class="line">                patch_value = ins_b_jmp_hex_arm(instr.address, childs[<span class="number">0</span>], bx_cond)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&#x27;Iend_BE&#x27;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line"></span><br><span class="line">                file_offset += <span class="number">4</span></span><br><span class="line">                <span class="comment"># patch the next instruction to b instrcution</span></span><br><span class="line">                patch_value = ins_b_jmp_hex_arm(instr.address+<span class="number">4</span>, childs[<span class="number">1</span>], <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&#x27;Iend_BE&#x27;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line">            <span class="keyword">elif</span> project.arch.name <span class="keyword">in</span> ARCH_ARM64:</span><br><span class="line">                <span class="comment"># patch the cset.xx instruction to bx instruction</span></span><br><span class="line">                bx_cond = instr.op_str.split(<span class="string">&#x27;,&#x27;</span>)[-<span class="number">1</span>].strip()</span><br><span class="line">                patch_value = ins_b_jmp_hex_arm64(instr.address, childs[<span class="number">0</span>], bx_cond)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&#x27;Iend_BE&#x27;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line"></span><br><span class="line">                file_offset += <span class="number">4</span></span><br><span class="line">                <span class="comment"># patch the next instruction to b instruction</span></span><br><span class="line">                patch_value = ins_b_jmp_hex_arm64(instr.address+<span class="number">4</span>, childs[<span class="number">1</span>], <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> project.arch.memory_endness == <span class="string">&#x27;Iend_BE&#x27;</span>:</span><br><span class="line">                    patch_value = patch_value[::-<span class="number">1</span>]</span><br><span class="line">                patch_instruction(origin_data, file_offset, patch_value)</span><br><span class="line">                <span class="comment">#å¦‚æœå­˜åœ¨å¤šä¸ªå­èŠ‚ç‚¹ï¼Œåˆ™éœ€è¦è¿›è¡Œæ›´å¤æ‚çš„ä¿®è¡¥ã€‚å¯¹äºx86æ¶æ„ï¼Œéœ€è¦ä¿®æ”¹æ¡ä»¶ä¼ é€æŒ‡ä»¤ï¼ˆå¦‚cmovxï¼‰ä¸ºæ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼ˆå¦‚jxï¼‰ã€‚å¯¹äºARMå’ŒARM64æ¶æ„ï¼Œéœ€è¦ä¿®æ”¹æŒ‡ä»¤ä¸ºæ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼ˆå¦‚bxã€bï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(origin_data) == origin_data_len, <span class="string">&quot;Error: size of data changed!!!&quot;</span></span><br><span class="line">    <span class="comment">#ç¡®ä¿ä¿®å¤å‰åé•¿åº¦ç›¸åŒ</span></span><br><span class="line">    recovery.write(origin_data)</span><br><span class="line">    recovery.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successful! The recovered file: %s&#x27;</span> % recovery_file)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è·å–ä¸æ§åˆ¶æµç›¸å…³çš„NOPèŠ‚ç‚¹"><a href="#è·å–ä¸æ§åˆ¶æµç›¸å…³çš„NOPèŠ‚ç‚¹" class="headerlink" title="è·å–ä¸æ§åˆ¶æµç›¸å…³çš„NOPèŠ‚ç‚¹"></a>è·å–ä¸æ§åˆ¶æµç›¸å…³çš„NOPèŠ‚ç‚¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_relevant_nop_nodes</span>(<span class="params">supergraph, pre_dispatcher_node, prologue_node, retn_node</span>):</span><br><span class="line">    <span class="comment"># relevant_nodes = list(supergraph.predecessors(pre_dispatcher_node))</span></span><br><span class="line">    relevant_nodes = []</span><br><span class="line">    nop_nodes = []</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="comment">#ä½¿ç”¨å—å­—èŠ‚å¤§å°ï¼Œæ¥åˆ¤æ–­æ˜¯å¦ä¸ºçœŸå®å—</span></span><br><span class="line">        <span class="keyword">if</span> supergraph.has_edge(node, pre_dispatcher_node) <span class="keyword">and</span> node.size &gt; <span class="number">8</span>:</span><br><span class="line">            <span class="comment"># <span class="doctag">XXX:</span> use node.size is faster than to create a block</span></span><br><span class="line">            relevant_nodes.append(node)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment">#æ’é™¤åºè¨€ï¼Œè¿”å›å—ï¼Œé¢„å¤„ç†å™¨</span></span><br><span class="line">        <span class="keyword">if</span> node.addr <span class="keyword">in</span> (prologue_node.addr, retn_node.addr, pre_dispatcher_node.addr):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nop_nodes.append(node)</span><br><span class="line">        <span class="comment">#å…¶ä½™éƒ½åŠ å…¥nop</span></span><br><span class="line">    <span class="keyword">return</span> relevant_nodes, nop_nodes</span><br></pre></td></tr></table></figure><h3 id="åœ¨ç»™å®šçš„èµ·å§‹åœ°å€å¤„æ‰§è¡Œç¬¦å·æ‰§è¡Œ"><a href="#åœ¨ç»™å®šçš„èµ·å§‹åœ°å€å¤„æ‰§è¡Œç¬¦å·æ‰§è¡Œ" class="headerlink" title="åœ¨ç»™å®šçš„èµ·å§‹åœ°å€å¤„æ‰§è¡Œç¬¦å·æ‰§è¡Œ"></a>åœ¨ç»™å®šçš„èµ·å§‹åœ°å€å¤„æ‰§è¡Œç¬¦å·æ‰§è¡Œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">symbolic_execution</span>(<span class="params">project, relevant_block_addrs, start_addr, hook_addrs=<span class="literal">None</span>, modify_value=<span class="literal">None</span>, inspect=<span class="literal">False</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#ä»çŠ¶æ€ä¸­è·å–å½“å‰æŒ‡ä»¤æŒ‡é’ˆçš„å€¼ï¼Œå¹¶è§£é™¤æŒ‡å®šåœ°å€çš„æŒ‚é’©</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">retn_procedure</span>(<span class="params">state</span>):</span><br><span class="line">        ip = state.solver.<span class="built_in">eval</span>(state.regs.ip)</span><br><span class="line">        project.unhook(ip)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment"># æ£€æŸ¥è¯­å¥</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">statement_inspect</span>(<span class="params">state</span>):</span><br><span class="line">        expressions = <span class="built_in">list</span>(</span><br><span class="line">            state.scratch.irsb.statements[state.inspect.statement].expressions)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(expressions) != <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(expressions[<span class="number">0</span>], pyvex.expr.ITE):</span><br><span class="line">            state.scratch.temps[expressions[<span class="number">0</span>].cond.tmp] = modify_value</span><br><span class="line">            state.inspect._breakpoints[<span class="string">&#x27;statement&#x27;</span>] = []</span><br><span class="line"><span class="comment"># æ£€æŸ¥æŒ‚é’©</span></span><br><span class="line">    <span class="keyword">if</span> hook_addrs <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        skip_length = <span class="number">4</span></span><br><span class="line">        <span class="keyword">if</span> project.arch.name <span class="keyword">in</span> ARCH_X86:</span><br><span class="line">            skip_length = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> hook_addr <span class="keyword">in</span> hook_addrs:</span><br><span class="line">            project.hook(hook_addr, retn_procedure, length=skip_length)</span><br><span class="line"></span><br><span class="line">    state = project.factory.blank_state(addr=start_addr, remove_options=&#123;</span><br><span class="line">                                        angr.sim_options.LAZY_SOLVES&#125;)</span><br><span class="line">    <span class="keyword">if</span> inspect:</span><br><span class="line">        state.inspect.b(</span><br><span class="line">            <span class="string">&#x27;statement&#x27;</span>, when=angr.state_plugins.inspect.BP_BEFORE, action=statement_inspect)</span><br><span class="line">    sm = project.factory.simulation_manager(state)</span><br><span class="line">    sm.step()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(sm.active) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> active_state <span class="keyword">in</span> sm.active:</span><br><span class="line">            <span class="keyword">if</span> active_state.addr <span class="keyword">in</span> relevant_block_addrs:</span><br><span class="line">                <span class="keyword">return</span> active_state.addr</span><br><span class="line">        sm.step()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡&quot;&gt;&lt;a href=&quot;#åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡&quot; class=&quot;headerlink&quot; title=&quot;åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡&quot;&gt;&lt;/a&gt;åæ··æ·†å­¦ä¹ -flaæ§åˆ¶æµå¹³å¦åŒ–ç¯‡&lt;/h1&gt;&lt;p&gt;æ„Ÿè§‰åæ··æ·†æ¯”æ··æ·†éš¾å¤šäº†ã€‚ã€‚ã€‚</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OLLVM-å¸¸é‡æ›¿ä»£</title>
    <link href="https://straw-233.github.io/2024/03/20/OLLVM-%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3/"/>
    <id>https://straw-233.github.io/2024/03/20/OLLVM-%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3/</id>
    <published>2024-03-20T10:43:21.967Z</published>
    <updated>2024-03-20T10:47:12.016Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM-å¸¸é‡æ›¿ä»£"><a href="#OLLVM-å¸¸é‡æ›¿ä»£" class="headerlink" title="OLLVM-å¸¸é‡æ›¿ä»£"></a>OLLVM-å¸¸é‡æ›¿ä»£</h1><p>æ„Ÿè§‰è·ŸæŒ‡ä»¤æ›¿ä»£ç±»ä¼¼ï¼Œä»…æ”¯æŒ32ä½æ•´æ•°æ›¿ä»£</p><p>ï¼ˆå»ºè®®ç»“åˆä»£ç é£Ÿç”¨ï¼‰</p><h2 id="æ›¿æ¢æ–¹æ¡ˆ"><a href="#æ›¿æ¢æ–¹æ¡ˆ" class="headerlink" title="æ›¿æ¢æ–¹æ¡ˆ"></a>æ›¿æ¢æ–¹æ¡ˆ</h2><p><img src="/../img/OLLVM%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3/%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88.png" alt="æ›¿æ¢æ–¹æ¡ˆ"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>ConstantSubstitution.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/IPO/PassManagerBuilder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/CommandLine.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Local.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SplitBasicBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_RAND 32767</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_CONST_SUBST 2</span></span><br><span class="line">using namespace llvm;</span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line"><span class="type">static</span> cl::opt&lt;<span class="type">int</span>&gt; <span class="title function_">obfuTimes</span><span class="params">(<span class="string">&quot;csub_loop&quot;</span>,cl::init(<span class="number">1</span>),cl::desc(<span class="string">&quot;Obfucase a function &lt;obfu_loop&gt; time(s).&quot;</span>))</span>;</span><br><span class="line">namespace&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">ConstantSubstitution</span> :</span>public FunctionPass&#123;</span><br><span class="line">        public :</span><br><span class="line">            <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">            </span><br><span class="line">            ConstantSubstitution():FunctionPass(ID)&#123;</span><br><span class="line">                srand(time(<span class="literal">NULL</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">bool</span> <span class="title function_">runOnFunction</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">substitute</span><span class="params">(BinaryOperator *BI)</span>;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">linearSubstitute</span><span class="params">(BinaryOperator *BI,<span class="type">int</span> i)</span>;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">bitwiseSubstitute</span><span class="params">(BinaryOperator *BI,<span class="type">int</span> i)</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">ConstantSubstitution::runOnFunction</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    INIT_CONTEXT(F);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;obfuTimes;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock &amp;BB:F)&#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;Instruction*&gt;origInst;</span><br><span class="line">            <span class="keyword">for</span>(Instruction &amp;I:BB)&#123;</span><br><span class="line">                origInst.push_back(&amp;I);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(Instruction *I:origInst)&#123; <span class="comment">//éå†æ‰€æœ‰æŒ‡ä»¤</span></span><br><span class="line">                <span class="keyword">if</span>(BinaryOperator *BI=dyn_cast&lt;BinaryOperator&gt;(I))&#123;<span class="comment">//åˆ¤æ–­æ˜¯ä¸æ˜¯äºŒå…ƒè¿ç®—æŒ‡ä»¤</span></span><br><span class="line">                    <span class="keyword">if</span>(BI-&gt;getType()-&gt;isIntegerTy(<span class="number">32</span>))&#123;<span class="comment">//ä»…å¯¹æ•´æ•°è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">                        substitute(BI);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ConstantSubstitution::substitute</span><span class="params">(BinaryOperator *BI)</span>&#123;</span><br><span class="line">    <span class="type">int</span> operandNum =BI -&gt;getNumOperands();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;operandNum;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(isa&lt;ConstantInt&gt;(BI-&gt;getOperand(i)))&#123;</span><br><span class="line">            <span class="type">int</span> choice =rand()%NUMBER_CONST_SUBST;</span><br><span class="line">            <span class="keyword">switch</span> (choice)</span><br><span class="line">            &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                linearSubstitute(BI,i); <span class="comment">// çº¿æ€§æ›¿æ¢</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                bitwiseSubstitute(BI,i);</span><br><span class="line">                <span class="comment">// bitwiseSubstitute(BI,i); // æŒ‰ä½è¿ç®—æ›¿æ¢</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ConstantSubstitution::linearSubstitute</span><span class="params">(BinaryOperator *BI,<span class="type">int</span> i)</span>&#123;</span><br><span class="line">    <span class="comment">//çº¿æ€§æ›¿æ¢ :Val -&gt; ax+by+c</span></span><br><span class="line">    <span class="comment">//å…¶ä¸­ val ä¸ºåŸå¸¸é‡ a, b ä¸ºéšæœºå¸¸é‡ x, y ä¸ºéšæœºå…¨å±€å˜é‡ c = val - (ax + by)</span></span><br><span class="line">    Module *M=BI-&gt;getModule();</span><br><span class="line">    <span class="comment">//æŒ‡å®šæ¨¡å—</span></span><br><span class="line">    ConstantInt *val=cast&lt;ConstantInt&gt;(BI-&gt;getOperand(i));</span><br><span class="line">    <span class="comment">//è·å–åŸæ¥çš„æ“ä½œæ•°</span></span><br><span class="line">    <span class="type">int</span> randx=rand()%MAX_RAND,randy=rand()%MAX_RAND;</span><br><span class="line">    <span class="comment">//åˆ›å»ºéšæœºæ•°x,y</span></span><br><span class="line">    <span class="type">int</span> randa=rand()%MAX_RAND,randb=rand()%MAX_RAND;</span><br><span class="line">    <span class="comment">//åˆ›å»ºéšæœºæ•°a,b</span></span><br><span class="line">    APInt c = val-&gt;getValue()-(randx*randa+randy*randb);</span><br><span class="line">    <span class="comment">//c=val-(ax+by)</span></span><br><span class="line">    GlobalVariable *xptr=new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::PrivateLinkage,CONST_I32(randx),<span class="string">&quot;x&quot;</span>);</span><br><span class="line">    <span class="comment">//åˆ›å»ºxå…¨å±€å˜é‡</span></span><br><span class="line">    <span class="comment">//commonLinkage æ˜¯æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œåˆå§‹å€¼åªèƒ½ä¸º0ï¼Œä¸èƒ½ä¸ºå…¶ä»–å€¼ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„åˆå§‹å€¼xä¸èƒ½æ˜¯0ï¼Œæ‰€ä»¥ä¸èƒ½è®¾ç½®æˆcommonlinkage</span></span><br><span class="line">    GlobalVariable *yptr=new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::PrivateLinkage,CONST_I32(randy),<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    <span class="comment">//åˆ›å»ºyå…¨å±€å˜é‡</span></span><br><span class="line">    LoadInst *x=new LoadInst(TYPE_I32,xptr,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//è¯»å–x</span></span><br><span class="line">    LoadInst *y=new LoadInst(TYPE_I32,yptr,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//è¯»å–y</span></span><br><span class="line">    BinaryOperator *op1=BinaryOperator::CreateMul(CONST_I32(randa),x,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//ax</span></span><br><span class="line">    BinaryOperator *op2=BinaryOperator::CreateMul(CONST_I32(randb),y,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//by</span></span><br><span class="line">    BinaryOperator *op3=BinaryOperator::CreateAdd(op1,op2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//ax+by</span></span><br><span class="line">    BinaryOperator *op4=BinaryOperator::CreateAdd(op3,CONST_I32(c.getSExtValue()),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//ax+by+c</span></span><br><span class="line">    BI-&gt;setOperand(i,op4);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ConstantSubstitution::bitwiseSubstitute</span><span class="params">(BinaryOperator *BI,<span class="type">int</span> i)</span>&#123;</span><br><span class="line">    <span class="comment">//æŒ‰ä½è¿ç®—æ›¿æ¢ï¼šval -&gt; (x &lt;&lt; 5 | y &gt;&gt; 3) ^ c</span></span><br><span class="line">    <span class="comment">//å…¶ä¸­ val ä¸ºåŸå¸¸é‡x, y ä¸ºéšæœºå…¨å±€å˜é‡ c = val ^ (x &lt;&lt; 5 | y &gt;&gt; 3)</span></span><br><span class="line">    Module *M=BI-&gt;getModule();</span><br><span class="line">    <span class="comment">//æŒ‡å®šæ¨¡å—</span></span><br><span class="line">    ConstantInt *val=cast&lt;ConstantInt&gt;(BI-&gt;getOperand(i));</span><br><span class="line">    <span class="comment">//è·å–åŸæ¥çš„æ“ä½œæ•°</span></span><br><span class="line">    <span class="type">int</span> randx=rand()%MAX_RAND,randy=rand()%MAX_RAND;</span><br><span class="line">    <span class="comment">//éšæœºæ•°</span></span><br><span class="line">    APInt c = val-&gt;getValue()^(randx&lt;&lt;<span class="number">5</span>|randy&gt;&gt;<span class="number">3</span>);</span><br><span class="line">    <span class="comment">//c = val ^ (x &lt;&lt; 5 | y &gt;&gt; 3)</span></span><br><span class="line">    GlobalVariable *xptr=new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::PrivateLinkage,CONST_I32(randx),<span class="string">&quot;x&quot;</span>);   </span><br><span class="line">    <span class="comment">//åˆ›å»ºxå…¨å±€å˜é‡</span></span><br><span class="line">    <span class="comment">//commonLinkage æ˜¯æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œåˆå§‹å€¼åªèƒ½ä¸º0ï¼Œä¸èƒ½ä¸ºå…¶ä»–å€¼ã€‚è¿™é‡Œæˆ‘ä»¬è®¾ç½®çš„åˆå§‹å€¼xä¸èƒ½æ˜¯0ï¼Œæ‰€ä»¥ä¸èƒ½è®¾ç½®æˆcommonlinkage</span></span><br><span class="line">    GlobalVariable *yptr=new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::PrivateLinkage,CONST_I32(randy),<span class="string">&quot;y&quot;</span>);</span><br><span class="line">    <span class="comment">//åˆ›å»ºyå…¨å±€å˜é‡ </span></span><br><span class="line">    LoadInst *x=new LoadInst(TYPE_I32,xptr,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//åŠ è½½x</span></span><br><span class="line">    LoadInst *y=new LoadInst(TYPE_I32,yptr,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//åŠ è½½y</span></span><br><span class="line">    BinaryOperator *op1=BinaryOperator::CreateShl(x,CONST_I32(<span class="number">5</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//x&lt;&lt;5</span></span><br><span class="line">    BinaryOperator *op2=BinaryOperator::CreateLShr(y,CONST_I32(<span class="number">3</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//y&gt;&gt;3</span></span><br><span class="line">    BinaryOperator *op3=BinaryOperator::CreateOr(op1,op2,<span class="string">&quot;&quot;</span>,BI);  </span><br><span class="line">    <span class="comment">//x&lt;&lt;5|y&gt;&gt;3</span></span><br><span class="line">    BinaryOperator *op4=BinaryOperator::CreateXor(op3,CONST_I32(c.getSExtValue()),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//c^(x&lt;&lt;5|y&gt;&gt;3)</span></span><br><span class="line">    BI-&gt;setOperand(i,op4);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> ConstantSubstitution::ID=<span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> RegisterPass&lt;ConstantSubstitution&gt; <span class="title function_">X</span><span class="params">(<span class="string">&quot;csub&quot;</span>,<span class="string">&quot;Replace a constant value with equivalent instructions&quot;</span>)</span>; </span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="/../img/OLLVM%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3/%E6%95%88%E6%9E%9C1.png" alt="æ•ˆæœ1"></p><p>ç”¨è‡ªå·±çš„é¢˜ç›®ç¼–è¯‘æ··æ·†äº†ä¸€æ¬¡ï¼Œæ•ˆæœè¿˜è¡Œï¼Œè¯•è¯•ä¸‰æ¬¡çš„</p><p><img src="/../img/OLLVM%E5%B8%B8%E9%87%8F%E6%9B%BF%E4%BB%A3/%E6%95%88%E6%9E%9C2.png" alt="æ•ˆæœ2"></p><p>çˆ½äº†ï¼Œå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘çš„teaåŠ å¯†è¢«ä¸€çœ¼çœ‹å‡ºæ¥äº†</p><p><img src="/../img/%E4%BB%A4%E7%82%B9%E5%A4%B4.gif" alt="ä»¤ç‚¹å¤´"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM-å¸¸é‡æ›¿ä»£&quot;&gt;&lt;a href=&quot;#OLLVM-å¸¸é‡æ›¿ä»£&quot; class=&quot;headerlink&quot; title=&quot;OLLVM-å¸¸é‡æ›¿ä»£&quot;&gt;&lt;/a&gt;OLLVM-å¸¸é‡æ›¿ä»£&lt;/h1&gt;&lt;p&gt;æ„Ÿè§‰è·ŸæŒ‡ä»¤æ›¿ä»£ç±»ä¼¼ï¼Œä»…æ”¯æŒ32ä½æ•´æ•°æ›¿ä»£&lt;/p&gt;
&lt;p&gt;ï¼ˆå»ºè®®ç»“åˆä»£ç é£Ÿç”¨ï¼‰</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OLLVM-éšæœºæ§åˆ¶æµ</title>
    <link href="https://straw-233.github.io/2024/03/19/OLLVM-%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/"/>
    <id>https://straw-233.github.io/2024/03/19/OLLVM-%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/</id>
    <published>2024-03-19T11:45:53.766Z</published>
    <updated>2024-03-19T11:49:56.760Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM-éšæœºæ§åˆ¶æµ"><a href="#OLLVM-éšæœºæ§åˆ¶æµ" class="headerlink" title="OLLVM-éšæœºæ§åˆ¶æµ"></a>OLLVM-éšæœºæ§åˆ¶æµ</h1><p>æ„Ÿè§‰è·Ÿè™šå‡æ§åˆ¶æµå·®ä¸å¤šï¼Œå°±æ˜¯badyBBå’ŒcloneBBçš„å®šå‘è·³è½¬è½¬åˆ°äº†éšæœºè·³è½¬</p><p>(å»ºè®®ç»“åˆä»£ç é£Ÿç”¨)</p><p><img src="/../img/%E5%B0%8F%E9%B8%A1%E8%B5%B0.gif" alt="å°é¸¡èµ°"></p><h2 id="ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—åˆ†å‰²"><a href="#ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—åˆ†å‰²" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—åˆ†å‰²"></a>ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—åˆ†å‰²</h2><p>ä¸è™šå‡æ§åˆ¶æµç›¸åŒ</p><h2 id="ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†"><a href="#ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†"></a>ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†</h2><p><img src="/../img/OLLVM%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/%E9%9A%8F%E6%9C%BA2.png" alt="éšæœº2"></p><h2 id="ç¬¬ä¸‰æ­¥ï¼šæ„é€ éšæœºè·³è½¬ï¼Œæ’å…¥ç”Ÿæˆéšæœºæ•°æŒ‡ä»¤ï¼Œæ’å…¥éšå³è·³è½¬ï¼Œå¯¹éšæœºæ•°è¿›è¡Œæ’ç­‰å˜æ¢"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ„é€ éšæœºè·³è½¬ï¼Œæ’å…¥ç”Ÿæˆéšæœºæ•°æŒ‡ä»¤ï¼Œæ’å…¥éšå³è·³è½¬ï¼Œå¯¹éšæœºæ•°è¿›è¡Œæ’ç­‰å˜æ¢" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ„é€ éšæœºè·³è½¬ï¼Œæ’å…¥ç”Ÿæˆéšæœºæ•°æŒ‡ä»¤ï¼Œæ’å…¥éšå³è·³è½¬ï¼Œå¯¹éšæœºæ•°è¿›è¡Œæ’ç­‰å˜æ¢"></a>ç¬¬ä¸‰æ­¥ï¼šæ„é€ éšæœºè·³è½¬ï¼Œæ’å…¥ç”Ÿæˆéšæœºæ•°æŒ‡ä»¤ï¼Œæ’å…¥éšå³è·³è½¬ï¼Œå¯¹éšæœºæ•°è¿›è¡Œæ’ç­‰å˜æ¢</h2><p><img src="/../img/OLLVM%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/%E9%9A%8F%E6%9C%BA3.png" alt="éšæœº3"></p><h2 id="ç¬¬å››æ­¥ï¼šæ„é€ è™šå‡éšæœºæ•°è·³è½¬"><a href="#ç¬¬å››æ­¥ï¼šæ„é€ è™šå‡éšæœºæ•°è·³è½¬" class="headerlink" title="ç¬¬å››æ­¥ï¼šæ„é€ è™šå‡éšæœºæ•°è·³è½¬"></a>ç¬¬å››æ­¥ï¼šæ„é€ è™šå‡éšæœºæ•°è·³è½¬</h2><p><img src="/../img/OLLVM%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/%E9%9A%8F%E6%9C%BA4.png" alt="éšæœº4"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>RandomControlFlow.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/CommandLine.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/ValueMapper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Cloning.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Module.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SplitBasicBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/IRBuilder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Intrinsics.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/IntrinsicsX86.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;RandomControlFlow.h&quot;</span></span></span><br><span class="line">using namespace llvm;</span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line"><span class="type">static</span> cl::opt&lt;<span class="type">int</span>&gt;obfuTimes(<span class="string">&quot;rcf_loop&quot;</span>,cl::init(<span class="number">1</span>),cl::desc(<span class="string">&quot;Obfuscate a function &lt;bef_loop&gt;time(s).&quot;</span>));</span><br><span class="line">namespace&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">RandomControlFlow</span>:</span> public FunctionPass&#123;</span><br><span class="line">        public:</span><br><span class="line">            <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">            RandomControlFlow():FunctionPass(ID)&#123;</span><br><span class="line">                srand(time(<span class="literal">NULL</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            Value* <span class="title function_">alterVal</span><span class="params">(Value *origVar,BasicBlock *insertAfter)</span>;</span><br><span class="line">            <span class="comment">//å¯¹éšæœºå˜é‡è¿›è¡Œæ’ç­‰å˜æ¢</span></span><br><span class="line">            <span class="type">bool</span> <span class="title function_">runOnFunction</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">insertRandomBranch</span><span class="params">(Value *randVar,BasicBlock *ifTrue,BasicBlock *ifFalse,BasicBlock *insertAfter)</span>;</span><br><span class="line">            <span class="comment">//æ’å…¥éšæœºè·³è½¬</span></span><br><span class="line">            <span class="type">bool</span> <span class="title function_">randcf</span><span class="params">(BasicBlock *entryBB)</span>;</span><br><span class="line">            <span class="comment">//å¯¹åŸºæœ¬å—è¿›è¡Œæ··æ·†</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">RandomControlFlow::runOnFunction</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    INIT_CONTEXT(F);</span><br><span class="line">    FunctionPass *pass=createSplitBasicBlockPass();</span><br><span class="line">    pass-&gt;runOnFunction(F);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;obfuTimes;i++)&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;BasicBlock*&gt;origBB;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock &amp;BB:F)&#123;</span><br><span class="line">            origBB.push_back(&amp;BB);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock *BB:origBB)&#123;</span><br><span class="line">            randcf(BB);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br><span class="line"><span class="comment">//ä»¥åŸºæœ¬å—ä¸ºå•ä½è¿›è¡Œéšæœºæ§åˆ¶æµæ··æ·†</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">RandomControlFlow::randcf</span><span class="params">(BasicBlock *entryBB)</span>&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ å°†åŸºæœ¬å—æ‹†åˆ†</span></span><br><span class="line">    BasicBlock *bodyBB=entryBB-&gt;splitBasicBlock(entryBB-&gt;getFirstNonPHI(),<span class="string">&quot;bodyBB&quot;</span>);</span><br><span class="line">    <span class="comment">//æ‹†åˆ†å‡ºbodyBB</span></span><br><span class="line">    BasicBlock *endBB=bodyBB-&gt;splitBasicBlock(bodyBB-&gt;getTerminator(),<span class="string">&quot;endBB&quot;</span>);</span><br><span class="line">    <span class="comment">//æ‹†åˆ†å‡ºendBB</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥,å¯¹åŸºæœ¬å—è¿›è¡Œå…‹éš†,å¹¶ä¸”ä¿®å¤é€ƒé€¸å˜é‡</span></span><br><span class="line">    BasicBlock *cloneBB=createCloneBasicBlock(bodyBB);</span><br><span class="line">    <span class="comment">//ä¿®å¤å…‹éš†äº§ç”Ÿçš„é€ƒé€¸å˜é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰æ­¥,æ„å»ºéšæœºè·³è½¬</span></span><br><span class="line">    *entryBB-&gt;getTerminator()-&gt;eraseFromParent();</span><br><span class="line">    <span class="comment">//ç§»é™¤entryBBçš„ç»ˆç»“æŒ‡ä»¤</span></span><br><span class="line">    Function *randfunc=Intrinsic::getDeclaration(entryBB-&gt;getModule(),llvm::Intrinsic::x86_rdrand_32); </span><br><span class="line">    <span class="comment">//è·å–32ä½éšæœºæ•°</span></span><br><span class="line">    CallInst *callinst=CallInst::Create(randfunc-&gt;getFunctionType(),randfunc,<span class="string">&quot;&quot;</span>,entryBB);</span><br><span class="line">    <span class="comment">//åˆ›å»ºcallæŒ‡ä»¤æ’å…¥entryBBçš„å°¾éƒ¨</span></span><br><span class="line">    Value *randVar=ExtractValueInst::Create(callinst,<span class="number">0</span>,<span class="string">&quot;&quot;</span>,entryBB);</span><br><span class="line">    <span class="comment">//å°†ç”Ÿæˆçš„éšæœºæ•°æ’å…¥åˆ° entryBBçš„å°¾éƒ¨</span></span><br><span class="line">    insertRandomBranch(randVar,bodyBB,cloneBB,entryBB);</span><br><span class="line">    <span class="comment">//æ·»åŠ éšæœºè·³è½¬</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬å››æ­¥ bodyBBå’ŒcloneBBæ·»åŠ éšæœºè·³è½¬</span></span><br><span class="line">    bodyBB-&gt;getTerminator()-&gt;eraseFromParent();</span><br><span class="line">    <span class="comment">//ç§»é™¤bodyBBçš„ç»ˆç»“æŒ‡ä»¤</span></span><br><span class="line">    cloneBB-&gt;getTerminator()-&gt;eraseFromParent();</span><br><span class="line">    <span class="comment">//ç§»é™¤cloneBBçš„ç»ˆç»“æŒ‡ä»¤</span></span><br><span class="line">    insertRandomBranch(randVar,bodyBB,endBB,cloneBB);</span><br><span class="line">    <span class="comment">//æ·»åŠ cloneBBåˆ°endBBçš„æŒ‡ä»¤ï¼Œåˆ°bodyBBä¸æ‰§è¡Œ</span></span><br><span class="line">    insertRandomBranch(randVar,endBB,cloneBB,bodyBB);</span><br><span class="line">    <span class="comment">//æ·»åŠ bodyBBåˆ°endBBçš„æŒ‡ä»¤ï¼Œåˆ°cloneBBä¸æ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ’å…¥éšæœºè·³è½¬ï¼Œéšæœºæ•°ä¸ºrandvar</span></span><br><span class="line"><span class="comment">//å¦‚æœ randvar %2==1 å°±è·³è½¬åˆ°ifTrue  ï¼Œå¦åˆ™è·³è½¬åˆ°ifFalse;</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">RandomControlFlow::insertRandomBranch</span><span class="params">(Value *randVar,BasicBlock *ifTrue,BasicBlock *ifFalse,BasicBlock *insertAfter)</span>&#123;</span><br><span class="line">    Value *alteredRandVar=alterVal(randVar,insertAfter);</span><br><span class="line">    <span class="comment">//å¯¹éšæœºå˜é‡è¿›è¡Œæ’ç­‰å˜æ¢</span></span><br><span class="line">    Value *randMod2=BinaryOperator::CreateURem(alteredRandVar,CONST_I32(<span class="number">2</span>),<span class="string">&quot;&quot;</span>,insertAfter);</span><br><span class="line">    <span class="comment">//å¯¹éšæœºå˜é‡è¿›è¡Œ%2</span></span><br><span class="line">    CmpInst *cmp1=new ICmpInst(*insertAfter,ICmpInst::ICMP_EQ,randMod2,CONST_I32(<span class="number">0</span>),<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ç»“æœ</span></span><br><span class="line">    BranchInst *branch=BranchInst::Create(ifTrue,ifFalse,cmp1,insertAfter);</span><br><span class="line">    <span class="comment">//è·³è½¬</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯¹å˜é‡è¿›è¡Œæ’ç­‰å˜æ¢</span></span><br><span class="line">Value* <span class="title function_">RandomControlFlow::alterVal</span><span class="params">(Value *startVar,BasicBlock *insertAfter)</span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> code = rand() % <span class="number">3</span>;</span><br><span class="line">  Value *result;</span><br><span class="line">  <span class="keyword">if</span> (code == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// x = x * (x + 1) - x^2</span></span><br><span class="line">    BinaryOperator *op1 = BinaryOperator::Create(Instruction::Add, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">1</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::Create(Instruction::Mul, startVar,</span><br><span class="line">                                                 op1, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op3 = BinaryOperator::Create(Instruction::Mul, startVar,</span><br><span class="line">                                                 startVar, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op4 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Sub, op2, op3, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    result = op4;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// x = 3 * x * (x - 2) - 3 * x^2 + 7 * x</span></span><br><span class="line">    BinaryOperator *op1 = BinaryOperator::Create(Instruction::Mul, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">3</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::Create(Instruction::Sub, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">2</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op3 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Mul, op1, op2, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op4 = BinaryOperator::Create(Instruction::Mul, startVar,</span><br><span class="line">                                                 startVar, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op5 = BinaryOperator::Create(Instruction::Mul, op4,</span><br><span class="line">                                                 CONST_I32(<span class="number">3</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op6 = BinaryOperator::Create(Instruction::Mul, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">7</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op7 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Sub, op3, op5, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op8 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Add, op6, op7, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    result = op8;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (code == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="comment">// x = (x - 1) * (x + 3) - (x + 4) * (x - 3) - 9</span></span><br><span class="line">    BinaryOperator *op1 = BinaryOperator::Create(Instruction::Sub, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">1</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::Create(Instruction::Add, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">3</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op3 = BinaryOperator::Create(Instruction::Add, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">4</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op4 = BinaryOperator::Create(Instruction::Sub, startVar,</span><br><span class="line">                                                 CONST_I32(<span class="number">3</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op5 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Mul, op1, op2, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op6 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Mul, op3, op4, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op7 =</span><br><span class="line">        BinaryOperator::Create(Instruction::Sub, op5, op6, <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    BinaryOperator *op8 = BinaryOperator::Create(Instruction::Sub, op7,</span><br><span class="line">                                                 CONST_I32(<span class="number">9</span>), <span class="string">&quot;&quot;</span>, insertAfter);</span><br><span class="line">    result = op8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">FunctionPass *<span class="title function_">llvm::createRandomControlFlow</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> new RandomControlFlow();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> RandomControlFlow::ID = <span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> RegisterPass&lt;RandomControlFlow&gt; <span class="title function_">X</span><span class="params">(<span class="string">&quot;rcf&quot;</span>,<span class="string">&quot;My Random control flow obfuscation&quot;</span>)</span>;</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="/../img/OLLVM%E9%9A%8F%E6%9C%BA%E6%8E%A7%E5%88%B6%E6%B5%81/%E6%95%88%E6%9E%9C.png" alt="æ•ˆæœ"></p><p>æ„Ÿè§‰æ··æ·†ä¸€æ¬¡éƒ½å·²ç»å¾ˆéš¾çœ‹äº†ï¼Œæ··æ·†ä¸¤æ¬¡æ›´æ˜¯ä¸€å¨ç²‘ç²‘ï¼Œå¼ºåŠ›æ··æ·†(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM-éšæœºæ§åˆ¶æµ&quot;&gt;&lt;a href=&quot;#OLLVM-éšæœºæ§åˆ¶æµ&quot; class=&quot;headerlink&quot; title=&quot;OLLVM-éšæœºæ§åˆ¶æµ&quot;&gt;&lt;/a&gt;OLLVM-éšæœºæ§åˆ¶æµ&lt;/h1&gt;&lt;p&gt;æ„Ÿè§‰è·Ÿè™šå‡æ§åˆ¶æµå·®ä¸å¤šï¼Œå°±æ˜¯badyBBå’ŒcloneBBçš„å®šå‘è·³è½¬è½¬</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OLLVM-æŒ‡ä»¤æ›¿ä»£</title>
    <link href="https://straw-233.github.io/2024/03/18/OLLVM-%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/"/>
    <id>https://straw-233.github.io/2024/03/18/OLLVM-%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/</id>
    <published>2024-03-18T13:28:58.072Z</published>
    <updated>2024-03-18T13:38:29.142Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM-æŒ‡ä»¤æ›¿ä»£"><a href="#OLLVM-æŒ‡ä»¤æ›¿ä»£" class="headerlink" title="OLLVM-æŒ‡ä»¤æ›¿ä»£"></a>OLLVM-æŒ‡ä»¤æ›¿ä»£</h1><p>(å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨!)</p><p>ä¾‹å¦‚a+b&#x3D;a-(-b)ï¼Œa^b&#x3D; ( ~ a&amp;b) | (a&amp; ~ b) ä¸”ä»…æ”¯æŒæ•´æ•°</p><h2 id="åŠ æ³•æ›¿ä»£"><a href="#åŠ æ³•æ›¿ä»£" class="headerlink" title="åŠ æ³•æ›¿ä»£"></a>åŠ æ³•æ›¿ä»£</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%8C%87%E4%BB%A41.png" alt="æŒ‡ä»¤1"></p><h2 id="å‡æ³•æ›¿ä»£"><a href="#å‡æ³•æ›¿ä»£" class="headerlink" title="å‡æ³•æ›¿ä»£"></a>å‡æ³•æ›¿ä»£</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%8C%87%E4%BB%A42.png" alt="æŒ‡ä»¤2"></p><h2 id="ä¸æ›¿æ¢"><a href="#ä¸æ›¿æ¢" class="headerlink" title="ä¸æ›¿æ¢"></a>ä¸æ›¿æ¢</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%8C%87%E4%BB%A43.png" alt="æŒ‡ä»¤3"></p><h2 id="æˆ–æ›¿æ¢"><a href="#æˆ–æ›¿æ¢" class="headerlink" title="æˆ–æ›¿æ¢"></a>æˆ–æ›¿æ¢</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%8C%87%E4%BB%A44.png" alt="æŒ‡ä»¤4"></p><h2 id="å¼‚æˆ–æ›¿æ¢"><a href="#å¼‚æˆ–æ›¿æ¢" class="headerlink" title="å¼‚æˆ–æ›¿æ¢"></a>å¼‚æˆ–æ›¿æ¢</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%8C%87%E4%BB%A45.png" alt="æŒ‡ä»¤5"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>Substitution.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/IRBuilder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/IPO/PassManagerBuilder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/CommandLine.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Local.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SplitBasicBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_ADD_SUBST 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_SUB_SUBST 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_AND_SUBST 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_OR_SUBST 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> NUMBER_XOR_SUBST 2</span></span><br><span class="line">using namespace llvm;</span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line"><span class="type">static</span> cl::opt&lt;<span class="type">int</span>&gt; <span class="title function_">obfuTimes</span><span class="params">(<span class="string">&quot;sub_loop&quot;</span>,cl::init(<span class="number">1</span>),cl::desc(<span class="string">&quot;Obfucase a function &lt;sub_loop&gt; time().&quot;</span>))</span>;</span><br><span class="line">namespace &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Substitution</span>:</span>public FunctionPass&#123;</span><br><span class="line">        public:</span><br><span class="line">        <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">        Substitution():FunctionPass(ID)&#123;</span><br><span class="line">            srand(time(<span class="literal">NULL</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">bool</span> <span class="title function_">runOnFunction</span><span class="params">(Function &amp;F)</span> ;</span><br><span class="line">        <span class="type">void</span> <span class="title function_">substitute</span><span class="params">(BinaryOperator *BI)</span>;</span><br><span class="line">        <span class="comment">// æ›¿æ¢ Add æŒ‡ä»¤</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">substituteAdd</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; a = b - (-c)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">addNeg</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; a = -(-b + (-c))</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">addDoubleNeg</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; r = rand (); a = b + r; a = a + c; a = a - r</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">addRand</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; r = rand (); a = b - r; a = a + b; a = a + r</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">addRand2</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›¿æ¢ Sub æŒ‡ä»¤</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">substituteSub</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; a = b + (-c)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">subNeg</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; r = rand (); a = b + r; a = a - c; a = a - r</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">subRand</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; a = b - r; a = a - c; a = a + r</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">subRand2</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›¿æ¢ And æŒ‡ä»¤</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">substituteAnd</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// ä¸æ›¿æ¢ï¼ša = b &amp; c -&gt; a = (b ^ ~c) &amp; b</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">andSubstitute</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// ä¸æ›¿æ¢ï¼ša = b &amp; c -&gt; a = ~(~b | ~c) &amp; (r | ~r)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">andSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›¿æ¢ Or æŒ‡ä»¤</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">substituteOr</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// æˆ–æ›¿æ¢ï¼ša = b | c -&gt; a = (b &amp; c) | (b ^ c)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">orSubstitute</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// æˆ–æ›¿æ¢ï¼ša = b | c -&gt; a = ~(~b &amp; ~c) &amp; (r | ~r)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">orSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›¿æ¢ Xor æŒ‡ä»¤</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">substituteXor</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// å¼‚æˆ–æ›¿æ¢ï¼ša = b ^ c -&gt; a = ~b &amp; c | b &amp; ~c</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">xorSubstitute</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">        <span class="comment">// å¼‚æˆ–æ›¿æ¢ï¼ša = b ^ c -&gt; (b ^ r) ^ (c ^ r) &lt;=&gt; (~b &amp; r | b &amp; ~r) ^ (~c &amp; r |</span></span><br><span class="line">        <span class="comment">// c &amp; ~r)</span></span><br><span class="line">        <span class="type">void</span> <span class="title function_">xorSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> ;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">Substitution::runOnFunction</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;obfuTimes;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock &amp;BB:F)&#123;</span><br><span class="line">            <span class="built_in">vector</span>&lt;Instruction*&gt;origInst;</span><br><span class="line">            <span class="keyword">for</span>(Instruction &amp;I:BB)&#123;</span><br><span class="line">                origInst.push_back(&amp;I);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(Instruction *I:origInst)&#123; <span class="comment">//éå†æ‰€æœ‰æŒ‡ä»¤</span></span><br><span class="line">                <span class="keyword">if</span>(BinaryOperator *BI=dyn_cast&lt;BinaryOperator&gt;(I))&#123;</span><br><span class="line">                        substitute(BI);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// if(isa&lt;BinaryOperator&gt;(I))&#123;</span></span><br><span class="line">                <span class="comment">//     BinaryOperator *BI=cast&lt;BinaryOperator&gt;(I);</span></span><br><span class="line">                <span class="comment">//     substitute(BI);</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substitute</span><span class="params">(BinaryOperator *BI)</span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (BI-&gt;getOpcode())</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">case</span> BinaryOperator::Add:</span><br><span class="line">        substituteAdd(BI);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> BinaryOperator::Sub:</span><br><span class="line">        substituteSub(BI);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> BinaryOperator::Xor:</span><br><span class="line">        substituteXor(BI);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> BinaryOperator::And:</span><br><span class="line">        substituteAnd(BI);</span><br><span class="line">    <span class="keyword">case</span> BinaryOperator::Or:</span><br><span class="line">        substituteOr(BI);</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//é€‰æ‹©æ›¿æ¢ç±»å‹</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substituteAdd</span><span class="params">(BinaryOperator *BI)</span>&#123;</span><br><span class="line">    <span class="type">int</span> choice=rand()%NUMBER_ADD_SUBST;</span><br><span class="line">    <span class="keyword">switch</span>(choice)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            addNeg(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            addDoubleNeg(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            addRand(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            addRand2(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; a = b - (-c)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::addNeg</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNeg(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-c</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateSub(BI-&gt;getOperand(<span class="number">0</span>),opt1,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b-(-c)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; a = -(-b + (-c))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::addDoubleNeg</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *op1 = BinaryOperator::CreateNeg(BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-b</span></span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::CreateNeg(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-c</span></span><br><span class="line">    BinaryOperator *op3 = BinaryOperator::CreateAdd(op1, op2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-b+(-c)</span></span><br><span class="line">    BinaryOperator *op = BinaryOperator::CreateNeg(op3,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-(-b+(-c))</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; r = rand (); a = b + r; a = a + c; a = a - r</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::addRand</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r =(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator * op1 = BinaryOperator::CreateAdd(BI-&gt;getOperand(<span class="number">0</span>), r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b+r</span></span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::CreateAdd(op1, BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b+r)+c</span></span><br><span class="line">    BinaryOperator *op = BinaryOperator::CreateSub(op2, r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//((b+r)+c)-r</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŠ æ³•æ›¿æ¢ï¼ša = b + c -&gt; r = rand (); a = b - r; a = a + c; a = a + r</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::addRand2</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r =(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator * op1 = BinaryOperator::CreateSub(BI-&gt;getOperand(<span class="number">0</span>), r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b-r</span></span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::CreateAdd(op1, BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b-r)+c</span></span><br><span class="line">    BinaryOperator *op = BinaryOperator::CreateAdd(op2, r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//((b-r)+c)+r</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ›¿æ¢ Sub æŒ‡ä»¤</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substituteSub</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">        <span class="type">int</span> choice=rand()%NUMBER_SUB_SUBST;</span><br><span class="line">    <span class="keyword">switch</span>(choice)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            subNeg(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            subRand(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            subRand2(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; a = b + (-c)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::subNeg</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNeg(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//-c</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateAdd(BI-&gt;getOperand(<span class="number">0</span>),opt1,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b+(-c)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; r = rand (); a = b + r; a = a - c; a = a - r</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::subRand</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r =(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator * op1 = BinaryOperator::CreateAdd(BI-&gt;getOperand(<span class="number">0</span>), r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b+r</span></span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::CreateSub(op1, BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b+r)-c</span></span><br><span class="line">    BinaryOperator *op = BinaryOperator::CreateSub(op2, r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//((b+r)-c)-r</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡æ³•æ›¿æ¢ï¼ša = b - c -&gt; a = b - r; a = a - c; a = a + r</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::subRand2</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r =(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator * op1 = BinaryOperator::CreateSub(BI-&gt;getOperand(<span class="number">0</span>), r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b-r</span></span><br><span class="line">    BinaryOperator *op2 = BinaryOperator::CreateSub(op1, BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b-r)-c</span></span><br><span class="line">    BinaryOperator *op = BinaryOperator::CreateAdd(op2, r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//((b-r)-c)+r</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(op);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ›¿æ¢ And æŒ‡ä»¤</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substituteAnd</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    <span class="type">int</span> choice=rand()%NUMBER_AND_SUBST;</span><br><span class="line">    <span class="keyword">switch</span>(choice)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            andSubstitute(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            andSubstituteRand(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸æ›¿æ¢ï¼ša = b &amp; c -&gt; a = (b ^ ~c) &amp; b</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::andSubstitute</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~c</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateXor(BI-&gt;getOperand(<span class="number">0</span>),opt1,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b^~c</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateAnd(BI-&gt;getOperand(<span class="number">0</span>),opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b^~c)&amp;b</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸æ›¿æ¢ï¼ša = b &amp; c -&gt; a = ~(~b | ~c) &amp; (r | ~r)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::andSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r=(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~c</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateOr(opt1,opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b | ~c</span></span><br><span class="line">    BinaryOperator *opt4=BinaryOperator::CreateNot(opt3,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~(~b | ~c)</span></span><br><span class="line">    BinaryOperator *opt5=BinaryOperator::CreateNot(r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~r</span></span><br><span class="line">    BinaryOperator *opt6=BinaryOperator::CreateOr(r,opt5,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//r | ~r</span></span><br><span class="line">    BinaryOperator *opt7=BinaryOperator::CreateAnd(opt6,opt4,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~(~b | ~c)&amp;(r | ~r)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt7);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›¿æ¢ Or æŒ‡ä»¤</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substituteOr</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    <span class="type">int</span> choice=rand()%NUMBER_OR_SUBST;</span><br><span class="line">    <span class="keyword">switch</span>(choice)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            orSubstitute(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            orSubstituteRand(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æˆ–æ›¿æ¢ï¼ša = b | c -&gt; a = (b &amp; c) | (b ^ c)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::orSubstitute</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateAnd(BI-&gt;getOperand(<span class="number">0</span>),BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b&amp;c</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateXor(BI-&gt;getOperand(<span class="number">0</span>),BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b^c</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateOr(opt1,opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(b&amp;c)|(b^c)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æˆ–æ›¿æ¢ï¼ša = b | c -&gt; a = ~(~b &amp; ~c) &amp; (r | ~r)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::orSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r=(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~c</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateAnd(opt1,opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b&amp;~c</span></span><br><span class="line">    BinaryOperator *opt4=BinaryOperator::CreateNot(opt3,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~(~b&amp;~c)</span></span><br><span class="line">    BinaryOperator *opt5=BinaryOperator::CreateNot(r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~r</span></span><br><span class="line">    BinaryOperator *opt6=BinaryOperator::CreateOr(r,opt5,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//r|~r</span></span><br><span class="line">    BinaryOperator *opt7=BinaryOperator::CreateAnd(opt6,opt4,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~(~b &amp; ~c) &amp; (r | ~r)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt7);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›¿æ¢ Xor æŒ‡ä»¤</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::substituteXor</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    <span class="type">int</span> choice=rand()%NUMBER_XOR_SUBST;</span><br><span class="line">    <span class="keyword">switch</span>(choice)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">            xorSubstitute(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            xorSubstituteRand(BI);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¼‚æˆ–æ›¿æ¢ï¼ša = b ^ c -&gt; a = ~b &amp; c | b &amp; ~c</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::xorSubstitute</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~c</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateAnd(BI-&gt;getOperand(<span class="number">1</span>),opt1,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b&amp;~c</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b</span></span><br><span class="line">    BinaryOperator *opt4=BinaryOperator::CreateAnd(BI-&gt;getOperand(<span class="number">0</span>),opt3,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b&amp;c</span></span><br><span class="line">    BinaryOperator *opt5=BinaryOperator::CreateOr(opt4,opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b&amp;c|b&amp;~c</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt5);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¼‚æˆ–æ›¿æ¢ï¼ša = b ^ c -&gt; (b ^ r) ^ (c ^ r) &lt;=&gt; (~b &amp; r | b &amp; ~r) ^ (~c &amp; r | c &amp; ~r)</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Substitution::xorSubstituteRand</span><span class="params">(BinaryOperator *BI)</span> &#123;</span><br><span class="line">    ConstantInt *r=(ConstantInt*)CONST(BI-&gt;getType(),rand());</span><br><span class="line">    <span class="comment">//r</span></span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b</span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateAnd(r,opt1,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b&amp;r</span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateNot(r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~r</span></span><br><span class="line">    BinaryOperator *opt4=BinaryOperator::CreateAnd(opt3,BI-&gt;getOperand(<span class="number">0</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//b&amp;~r</span></span><br><span class="line">    BinaryOperator *opt5=BinaryOperator::CreateOr(opt4,opt2,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//~b&amp;r|b&amp;r</span></span><br><span class="line">    BinaryOperator *opt6=BinaryOperator::CreateNot(BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    BinaryOperator *opt7=BinaryOperator::CreateAnd(r,opt6,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    BinaryOperator *opt8=BinaryOperator::CreateNot(r,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    BinaryOperator *opt9=BinaryOperator::CreateAnd(opt8,BI-&gt;getOperand(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    BinaryOperator *opt10=BinaryOperator::CreateOr(opt7,opt9,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    BinaryOperator *opt11=BinaryOperator::CreateXor(opt10,opt5,<span class="string">&quot;&quot;</span>,BI);</span><br><span class="line">    <span class="comment">//(~b&amp;r|b&amp;~r)^(~c&amp;r|c&amp;~r)</span></span><br><span class="line">    BI-&gt;replaceAllUsesWith(opt11);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> Substitution::ID=<span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> RegisterPass&lt;Substitution&gt; <span class="title function_">X</span><span class="params">(<span class="string">&quot;sub&quot;</span>,<span class="string">&quot;Replace a operator with equivalent instructions&quot;</span>)</span>; </span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="/../img/OLLVM%E6%8C%87%E4%BB%A4%E6%9B%BF%E4%BB%A3/%E6%95%88%E6%9E%9C.png" alt="æ•ˆæœ"></p><p>æ„Ÿè§‰å°±æ±‡ç¼–å¤šäº†ç‚¹ä¸œè¥¿ï¼Œä¼ªä»£ç ç›´æ¥è¢«idaä¿®æ­£äº†ï¼Œå¯èƒ½æ˜¯æºæ–‡ä»¶çš„é—®é¢˜ã€‚ã€‚ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM-æŒ‡ä»¤æ›¿ä»£&quot;&gt;&lt;a href=&quot;#OLLVM-æŒ‡ä»¤æ›¿ä»£&quot; class=&quot;headerlink&quot; title=&quot;OLLVM-æŒ‡ä»¤æ›¿ä»£&quot;&gt;&lt;/a&gt;OLLVM-æŒ‡ä»¤æ›¿ä»£&lt;/h1&gt;&lt;p&gt;(å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨!)&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚a+b&amp;#x3D;a-(-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OLLVM-è™šå‡æ§åˆ¶æµ</title>
    <link href="https://straw-233.github.io/2024/03/17/OLLVM-%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/"/>
    <id>https://straw-233.github.io/2024/03/17/OLLVM-%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/</id>
    <published>2024-03-17T11:41:18.729Z</published>
    <updated>2024-03-17T11:46:47.153Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM-è™šå‡æ§åˆ¶æµ"><a href="#OLLVM-è™šå‡æ§åˆ¶æµ" class="headerlink" title="OLLVM-è™šå‡æ§åˆ¶æµ"></a>OLLVM-è™šå‡æ§åˆ¶æµ</h1><p>å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨ï¼</p><p><img src="/../img/%E6%81%B6%E5%BF%83%E6%A3%89.gif" alt="æ¶å¿ƒæ£‰"></p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/%E8%99%9A%E6%8E%A70.png" alt="è™šæ§0"></p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—æ‹†åˆ†"><a href="#ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—æ‹†åˆ†" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—æ‹†åˆ†"></a>ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬å—æ‹†åˆ†</h3><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/%E8%99%9A%E6%8E%A71.png" alt="è™šæ§1"></p><h3 id="ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†"><a href="#ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†"></a>ç¬¬äºŒæ­¥ï¼šåŸºæœ¬å—å…‹éš†</h3><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/%E8%99%9A%E6%8E%A72.png" alt="è™šæ§2"></p><h3 id="ç¬¬ä¸‰æ­¥ï¼šæ„é€ è™šå‡è·³è½¬"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ„é€ è™šå‡è·³è½¬" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ„é€ è™šå‡è·³è½¬"></a>ç¬¬ä¸‰æ­¥ï¼šæ„é€ è™šå‡è·³è½¬</h3><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/%E8%99%9A%E6%8E%A73.png" alt="è™šæ§3"></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>BogusControlFlow.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/CommandLine.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/ValueMapper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Cloning.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Module.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SplitBasicBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span> </span></span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>; </span><br><span class="line">using namespace llvm;</span><br><span class="line"><span class="comment">//æ··æ·†æ¬¡æ•°</span></span><br><span class="line"><span class="type">static</span> cl::opt&lt;<span class="type">int</span>&gt; <span class="title function_">obfuTimes</span><span class="params">(<span class="string">&quot;bcf_loop&quot;</span>,cl::init(<span class="number">1</span>),cl::desc(<span class="string">&quot;Obfucase a function &lt;bcf_loop&gt; time().&quot;</span>))</span>;</span><br><span class="line">namespace&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BogusControlFlow</span> :</span> public FunctionPass&#123;</span><br><span class="line">        public:</span><br><span class="line">            <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">            BogusControlFlow():FunctionPass(ID)&#123;</span><br><span class="line">                srand(time(<span class="literal">NULL</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">bool</span> <span class="title function_">runOnFunction</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">bogus</span><span class="params">(BasicBlock *BB)</span>;</span><br><span class="line">            Value * <span class="title function_">createBogusCmp</span><span class="params">(BasicBlock *insertAfter)</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">BogusControlFlow::runOnFunction</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    INIT_CONTEXT(F);</span><br><span class="line">    FunctionPass *pass =createSplitBasicBlockPass();</span><br><span class="line">    pass-&gt;runOnFunction(F);</span><br><span class="line">     <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;obfuTimes;i++)&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;BasicBlock*&gt; origBB;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock&amp; BB:F)&#123;</span><br><span class="line">            origBB.push_back(&amp;BB);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(BasicBlock *BB:origBB)&#123;</span><br><span class="line">            bogus(BB);</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Value *<span class="title function_">BogusControlFlow::createBogusCmp</span><span class="params">(BasicBlock * insertAfter)</span>&#123;</span><br><span class="line">    <span class="comment">//æ„å»ºè™šå‡è·³è½¬</span></span><br><span class="line">    Module *M=insertAfter-&gt;getModule();</span><br><span class="line">    GlobalVariable *xptr= new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::CommonLinkage,CONST_I32(<span class="number">0</span>),<span class="string">&quot;x&quot;</span>);  </span><br><span class="line">    <span class="comment">//è®¾ç½® x åˆå§‹å€¼ä¸º 0;</span></span><br><span class="line">    GlobalVariable *yptr= new GlobalVariable(*M,TYPE_I32,<span class="literal">false</span>,GlobalValue::CommonLinkage,CONST_I32(<span class="number">0</span>),<span class="string">&quot;y&quot;</span>);  </span><br><span class="line">    <span class="comment">//è®¾ç½® y åˆå§‹å€¼ä¸º 0;</span></span><br><span class="line">    LoadInst *x=new LoadInst(TYPE_I32,xptr,<span class="string">&quot;&quot;</span>,insertAfter); </span><br><span class="line">    <span class="comment">//å…¨å±€å˜é‡ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œç”¨loadæ¥è¯»å–</span></span><br><span class="line">    LoadInst *y=new LoadInst(TYPE_I32,yptr,<span class="string">&quot;&quot;</span>,insertAfter); </span><br><span class="line">    ICmpInst *cmp1=new ICmpInst(*insertAfter,CmpInst::ICMP_SLT,y,CONST_I32(<span class="number">10</span>));<span class="comment">//y&lt;10</span></span><br><span class="line">    BinaryOperator *opt1=BinaryOperator::CreateAdd(x,CONST_I32(<span class="number">1</span>),<span class="string">&quot;&quot;</span>,insertAfter);<span class="comment">//x+1   </span></span><br><span class="line">    BinaryOperator *opt2=BinaryOperator::CreateMul(x,opt1,<span class="string">&quot;&quot;</span>,insertAfter); <span class="comment">//x*(x+1)  </span></span><br><span class="line">    BinaryOperator *opt3=BinaryOperator::CreateSRem(opt2,CONST_I32(<span class="number">2</span>),<span class="string">&quot;&quot;</span>,insertAfter);<span class="comment">//x*(x+1)%2   </span></span><br><span class="line">    ICmpInst *cmp2=new ICmpInst(*insertAfter,CmpInst::ICMP_EQ,opt3,CONST_I32(<span class="number">0</span>));<span class="comment">//x*(x+1)%2==0</span></span><br><span class="line">    <span class="keyword">return</span> BinaryOperator::CreateOr(cmp1,cmp2,<span class="string">&quot;&quot;</span>,insertAfter);</span><br><span class="line">    <span class="comment">//åˆ›å»ºäº†if((y&lt;10||x*(x+1)%2==0)) ç­‰ä»·äºif(true)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">BogusControlFlow::bogus</span><span class="params">(BasicBlock *entryBB)</span>&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥ï¼Œå°†åŸºæœ¬å¿«æ‹†åˆ†æˆentryBB,bodyBB,endBB</span></span><br><span class="line">    BasicBlock *bodyBB=entryBB-&gt;splitBasicBlock(entryBB-&gt;getFirstNonPHI(),<span class="string">&quot;BodyBB&quot;</span>);</span><br><span class="line">    BasicBlock *endBB=bodyBB-&gt;splitBasicBlock(bodyBB-&gt;getTerminator(),<span class="string">&quot;endBB&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥ï¼Œå¯¹ä¸­é—´çš„åŸºæœ¬å— BodyBB è¿›è¡Œå…‹éš†ï¼Œå¾—åˆ°cloneBB</span></span><br><span class="line">    BasicBlock *cloneBB=createCloneBasicBlock(bodyBB);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰éƒ¨ æ„å»ºè™šå‡è·³è½¬</span></span><br><span class="line">    <span class="comment">//1.å°†entryBB,bodyBB,cloneBBæœ«å°¾çš„ç»å¯¹è·³è½¬ç§»é™¤</span></span><br><span class="line">    entryBB-&gt;getTerminator()-&gt;eraseFromParent();    </span><br><span class="line">    bodyBB-&gt;getTerminator()-&gt;eraseFromParent();    </span><br><span class="line">    cloneBB-&gt;getTerminator()-&gt;eraseFromParent();</span><br><span class="line">    <span class="comment">//2.åœ¨entryBBå’ŒbodyBBçš„æœ«å°¾æ’å…¥æ¡ä»¶æ’ä¸ºçœŸçš„è™šå‡æ¯”è¾ƒæŒ‡ä»¤</span></span><br><span class="line">    Value *cond1 =createBogusCmp(entryBB);</span><br><span class="line">    Value *cond2 =createBogusCmp(bodyBB); </span><br><span class="line">    <span class="comment">//3.å°†entryBBåˆ°bodyBBçš„ç»å¯¹è·³è½¬æ”¹ä¸ºæ¡ä»¶è·³è½¬</span></span><br><span class="line">    BranchInst::Create(bodyBB,cloneBB,cond1,entryBB);</span><br><span class="line">    <span class="comment">//4.å°†bodyBBåˆ°endBBçš„ç»å¯¹è·³è½¬æ”¹ä¸ºæ¡ä»¶è·³è½¬</span></span><br><span class="line">    BranchInst::Create(endBB,cloneBB,cond2,bodyBB);</span><br><span class="line">    <span class="comment">//5.æ·»åŠ bodyBB.cloneåˆ°bodyBBçš„ç»å¯¹è·³è½¬</span></span><br><span class="line">    BranchInst::Create(bodyBB,cloneBB);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> BogusControlFlow::ID=<span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> RegisterPass&lt;BogusControlFlow&gt; <span class="title function_">X</span><span class="params">(<span class="string">&quot;bcf&quot;</span>,<span class="string">&quot;My control bogus control flattening obfuscation&quot;</span>)</span>;</span><br><span class="line"><span class="comment">//å‘LLVMæ³¨å†Œæˆ‘ä»¬çš„pass    å…¶ä¸­X()ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŒ‡å®šLLVM Passçš„å‚æ•° ï¼Œè¿™æ ·å†ä½¿ç”¨optåŠ è½½è¿™ä¸ªsoæ–‡ä»¶çš„æ—¶å€™ï¼Œç”¨è¿™ä¸ªå‚æ•°æ¥æŒ‡å®šç”¨å“ªä¸ªPassæ¥ä¼˜åŒ–ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯å¯¹Passçš„æè¿°ã€‚</span></span><br></pre></td></tr></table></figure><p>Utils.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Local.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/ValueMapper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Cloning.h&quot;</span></span></span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line">using namespace llvm;</span><br><span class="line">LLVMContext *CONTEXT=nullptr;</span><br><span class="line"><span class="comment">//ç¬¬äº”æ­¥ ä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">llvm::fixStack</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;PHINode*&gt; origPHI;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Instruction*&gt; origReg;</span><br><span class="line">    BasicBlock &amp;entryBB=F.getEntryBlock();</span><br><span class="line">    <span class="keyword">for</span>(BasicBlock &amp;BB:F)&#123;</span><br><span class="line">        <span class="keyword">for</span> (Instruction &amp;I:BB)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(PHINode *PN=dyn_cast&lt;PHINode&gt;(&amp;I))&#123;</span><br><span class="line">                origPHI.push_back(PN);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!(isa&lt;AllocaInst&gt;(&amp;I)&amp;&amp; I.getParent()==&amp;entryBB)&amp;&amp; I.isUsedOutsideOfBlock(&amp;BB))&#123;<span class="comment">//åˆ¤æ–­æ˜¯ä¸æ˜¯é€ƒé€¸å˜é‡(é™¤äº†é€šè¿‡Allocï¼Œå¹¶ä¸”å®šä¹‰åœ¨å…¥å£å—çš„ï¼Œéƒ½è¦å¤„ç†)</span></span><br><span class="line">                origReg.push_back(&amp;I);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(PHINode *PN:origPHI)&#123;</span><br><span class="line">        DemotePHIToStack(PN,entryBB.getTerminator());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(Instruction *I:origReg)&#123;</span><br><span class="line">        DemoteRegToStack(*I,entryBB.getTerminator());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸºæœ¬å—å…‹éš†</span></span><br><span class="line">BasicBlock * <span class="title function_">llvm::createCloneBasicBlock</span><span class="params">(BasicBlock *BB)</span>&#123;</span><br><span class="line">    <span class="comment">//ä¿®å¤é€ƒé€¸å˜é‡</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;Instruction*&gt; origReg;</span><br><span class="line">    BasicBlock &amp;entryBB=BB-&gt;getParent()-&gt;getEntryBlock();</span><br><span class="line">        <span class="keyword">for</span> (Instruction &amp;I:*BB)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!(isa&lt;AllocaInst&gt;(&amp;I)&amp;&amp; I.getParent()==&amp;entryBB)&amp;&amp; I.isUsedOutsideOfBlock(BB))&#123;<span class="comment">//åˆ¤æ–­æ˜¯ä¸æ˜¯é€ƒé€¸å˜é‡(é™¤äº†é€šè¿‡Allocï¼Œå¹¶ä¸”å®šä¹‰åœ¨å…¥å£å—çš„ï¼Œéƒ½è¦å¤„ç†)</span></span><br><span class="line">                origReg.push_back(&amp;I);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(Instruction *I:origReg)&#123;</span><br><span class="line">        DemoteRegToStack(*I,entryBB.getTerminator());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ValueToValueMapTy VMap;  <span class="comment">//å˜é‡çš„æ˜ å°„è¡¨</span></span><br><span class="line">    BasicBlock *cloneBB=CloneBasicBlock(BB,VMap,<span class="string">&quot;cloneBB&quot;</span>,BB-&gt;getParent());</span><br><span class="line">    <span class="keyword">for</span>(Instruction &amp;I:*cloneBB)&#123;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;I.getNumOperands();i++)&#123; <span class="comment">//éå†æ“ä½œæ•°ä¸èƒ½ç”¨for:each ï¼Œè¦ç”¨forå¾ªç¯</span></span><br><span class="line">            Value *V=MapValue(I.getOperand(i),VMap);</span><br><span class="line">            <span class="keyword">if</span>(V)&#123;<span class="comment">//åˆ¤æ–­æ˜ å°„æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">                I.setOperand(i,V);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cloneBB;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">opt -load ../Build/LLVMObfuscator.so -bcf -S -enable-new-pm=0 IR/TestProgram.ll -o IR/TestProgram_bcf.ll</span><br><span class="line"># opt -load ../Build/LLVMObfuscator.so -bcf -bcf_loop 2 -S -enable-new-pm=0 IR/TestProgram.ll -o IR/TestProgram_bcf.ll</span><br><span class="line">#å¤šæ¬¡æ··æ·†</span><br><span class="line">clang  IR/TestProgram_bcf.ll -o Bin/TestProgram_bcf</span><br></pre></td></tr></table></figure><p>ç”¨ä»¥ä¸‹æŒ‡ä»¤å°†å…¶è¿›è¡Œç¼–è¯‘</p><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/dm1.png" alt="dm1"></p><p>å¾—åˆ°ä¸€ä¸ªè¿˜è¡Œçš„173è¡Œçš„ä»£ç ï¼Œç”¨D810è·‘ä¸€ä¸‹è¿˜èƒ½çœ‹</p><p>å†è¯•ç€è¿›è¡Œæ··æ·†2æ¬¡</p><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/dm2.png" alt="dm2"></p><p>å·²ç»å˜æˆäº†ä¸€å¨763è¡Œä»£ç çš„ç²‘ç²‘ï¼Œæ¯”ä¸€æ¬¡æ··æ·†çš„æ–‡ä»¶å¤§äº†ä¸€å€ï¼ˆæ„Ÿè§‰çœŸå®æƒ…å†µä¸ä¼šè¿™ä¹ˆæï¼Œå¤ªå†—é•¿äº†ï¼‰</p><p>æ¬£èµä¸€ä¸‹æµç¨‹å›¾ï¼ˆï¼‰</p><p><img src="/../img/OLLVM%E8%99%9A%E5%81%87%E6%8E%A7%E5%88%B6%E6%B5%81/pic.png" alt="pic"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM-è™šå‡æ§åˆ¶æµ&quot;&gt;&lt;a href=&quot;#OLLVM-è™šå‡æ§åˆ¶æµ&quot; class=&quot;headerlink&quot; title=&quot;OLLVM-è™šå‡æ§åˆ¶æµ&quot;&gt;&lt;/a&gt;OLLVM-è™šå‡æ§åˆ¶æµ&lt;/h1&gt;&lt;p&gt;å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/..</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>OLLVM-æ§åˆ¶æµå¹³å¦åŒ–</title>
    <link href="https://straw-233.github.io/2024/03/15/OLLVM-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/"/>
    <id>https://straw-233.github.io/2024/03/15/OLLVM-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/</id>
    <published>2024-03-15T13:06:43.121Z</published>
    <updated>2024-03-15T13:13:29.829Z</updated>
    
    <content type="html"><![CDATA[<h1 id="OLLVM-æ§åˆ¶æµå¹³å¦åŒ–"><a href="#OLLVM-æ§åˆ¶æµå¹³å¦åŒ–" class="headerlink" title="OLLVM-æ§åˆ¶æµå¹³å¦åŒ–"></a>OLLVM-æ§åˆ¶æµå¹³å¦åŒ–</h1><p>å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨ï¼</p><p><img src="/../img/%E7%82%B8%E6%AF%9B%E8%8A%99.jpg" alt="ç‚¸æ¯›èŠ™"></p><h4 id="ç¬¬ä¸€æ­¥ï¼šä¿å­˜åŸºæœ¬å—"><a href="#ç¬¬ä¸€æ­¥ï¼šä¿å­˜åŸºæœ¬å—" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šä¿å­˜åŸºæœ¬å—"></a>ç¬¬ä¸€æ­¥ï¼šä¿å­˜åŸºæœ¬å—</h4><p><img src="/../img/OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/%E6%8E%A7%E5%88%B6%E6%B5%811.png" alt="æ§åˆ¶æµ1"></p><h4 id="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåˆ†å‘å—å’Œè¿”å›å—"><a href="#ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåˆ†å‘å—å’Œè¿”å›å—" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåˆ†å‘å—å’Œè¿”å›å—"></a>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåˆ†å‘å—å’Œè¿”å›å—</h4><p><img src="/../img/OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/%E6%8E%A7%E5%88%B6%E6%B5%812.png" alt="æ§åˆ¶æµ2"></p><h4 id="ç¬¬ä¸‰æ­¥ï¼šå®ç°åˆ†å‘å—è°ƒåº¦"><a href="#ç¬¬ä¸‰æ­¥ï¼šå®ç°åˆ†å‘å—è°ƒåº¦" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šå®ç°åˆ†å‘å—è°ƒåº¦"></a>ç¬¬ä¸‰æ­¥ï¼šå®ç°åˆ†å‘å—è°ƒåº¦</h4><p><img src="/../img/OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/%E6%8E%A7%E5%88%B6%E6%B5%813.png" alt="æ§åˆ¶æµ3"></p><h4 id="ç¬¬å››æ­¥ï¼šå®ç°è°ƒåº¦å˜é‡çš„è‡ªåŠ¨è°ƒæ•´"><a href="#ç¬¬å››æ­¥ï¼šå®ç°è°ƒåº¦å˜é‡çš„è‡ªåŠ¨è°ƒæ•´" class="headerlink" title="ç¬¬å››æ­¥ï¼šå®ç°è°ƒåº¦å˜é‡çš„è‡ªåŠ¨è°ƒæ•´"></a>ç¬¬å››æ­¥ï¼šå®ç°è°ƒåº¦å˜é‡çš„è‡ªåŠ¨è°ƒæ•´</h4><p><img src="/../img/OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/%E6%8E%A7%E5%88%B6%E6%B5%814.png" alt="æ§åˆ¶æµ4"></p><h4 id="ç¬¬äº”æ­¥ï¼šä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡"><a href="#ç¬¬äº”æ­¥ï¼šä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡" class="headerlink" title="ç¬¬äº”æ­¥ï¼šä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡"></a>ç¬¬äº”æ­¥ï¼šä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡</h4><p><img src="/../img/OLLVM%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/%E6%8E%A7%E5%88%B6%E6%B5%815.png" alt="æ§åˆ¶æµ5"></p><h4 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h4><p>FLattening.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Pass.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/LegacyPassManager.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/IPO/PassManagerBuilder.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/raw_ostream.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Support/CommandLine.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Local.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;SplitBasicBlock.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line">using namespace llvm;</span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line">namespace&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Flattening</span> :</span>public FunctionPass&#123;</span><br><span class="line">        public :</span><br><span class="line">            <span class="type">static</span> <span class="type">char</span> ID;</span><br><span class="line">            </span><br><span class="line">            Flattening():FunctionPass(ID)&#123;</span><br><span class="line">                srand(time(<span class="number">0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">void</span> <span class="title function_">flatten</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line">            <span class="type">bool</span> <span class="title function_">runOnFunction</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="title function_">Flattening::runOnFunction</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    INIT_CONTEXT(F);</span><br><span class="line">    FunctionPass * pass =createSplitBasicBlockPass();</span><br><span class="line">    pass-&gt;runOnFunction(F);</span><br><span class="line">    flatten(F);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Flattening::flatten</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ­¥,ä¿å­˜é™¤äº†å…¥å£å—çš„åŸºæœ¬å—</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;BasicBlock*&gt; origBB;<span class="comment">//åˆ›å»ºä¸€ä¸ªå®¹å™¨</span></span><br><span class="line">    <span class="keyword">for</span>(BasicBlock&amp; BB:F)&#123;</span><br><span class="line">        origBB.push_back(&amp;BB);</span><br><span class="line">    &#125;<span class="comment">//ä¿å­˜æ‰€æœ‰åŸºæœ¬å¿«</span></span><br><span class="line">    origBB.erase(origBB.begin());<span class="comment">//ç§»é™¤ç¬¬ä¸€ä¸ªåŸºæœ¬å—</span></span><br><span class="line">    BasicBlock &amp;entryBlock=F.getEntryBlock();<span class="comment">//è·å–å…¥å£å—</span></span><br><span class="line">    <span class="keyword">if</span>(BranchInst *br=dyn_cast&lt;BranchInst&gt;(entryBlock.getTerminator()))&#123;</span><br><span class="line">        <span class="keyword">if</span>(br-&gt;isConditional())&#123;<span class="comment">//åˆ¤æ–­æ˜¯ä¸æ˜¯æ¡ä»¶è·³è½¬</span></span><br><span class="line">            origBB.insert(origBB.begin(),entryBlock.splitBasicBlock(br));<span class="comment">//æ˜¯æ¡ä»¶è·³è½¬ï¼Œå•ç‹¬æ‹å‡ºæ¥ä½œä¸ºæ–°çš„åŸºæœ¬å—</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºåˆ†å‘å—å’Œè¿”å›å—</span></span><br><span class="line">    BasicBlock *dispatchBB=BasicBlock::Create(*CONTEXT,<span class="string">&quot;dispatchBB&quot;</span>,&amp;F,&amp;entryBlock);<span class="comment">//åˆ›å»ºåˆ†å‘å—</span></span><br><span class="line">    BasicBlock *retBB=BasicBlock::Create(*CONTEXT,<span class="string">&quot;retBB&quot;</span>,&amp;F,&amp;entryBlock);<span class="comment">//åˆ›å»ºè¿”å›å—</span></span><br><span class="line">    entryBlock.moveBefore(dispatchBB);<span class="comment">//ç§»åŠ¨å…¥å£å—åˆ°æœ€å‰é¢</span></span><br><span class="line">    entryBlock.getTerminator()-&gt;eraseFromParent();<span class="comment">//è¸¢æ‰å…¥å£å—åŸæ¥çš„è·³è½¬</span></span><br><span class="line">    BranchInst::Create(dispatchBB,&amp;entryBlock);<span class="comment">//å…¥å£å—ç»å¯¹è·³è½¬åˆ°åˆ†å‘å¿«</span></span><br><span class="line">    BranchInst::Create(dispatchBB,retBB);<span class="comment">//è¿”å›å—åˆ°åˆ†å‘å—</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰éƒ¨ï¼Œå®ç°åˆ†å‘å—çš„è°ƒåº¦åŠŸèƒ½</span></span><br><span class="line">    <span class="type">int</span> randNumcase=rand();<span class="comment">//randå‚æ•°</span></span><br><span class="line">    AllocaInst * swVarPtr =new AllocaInst(TYPE_I32,<span class="number">0</span>,<span class="string">&quot;swVar.ptr&quot;</span>,entryBlock.getTerminator());<span class="comment">//å…¥å£å—åˆ›å»ºallocaæŒ‡ä»¤ï¼Œæ’å…¥åˆ°å…¥å£å—ç»ˆç»“æŒ‡ä»¤å‰</span></span><br><span class="line">    new StoreInst(CONST_I32(randNumcase),swVarPtr,entryBlock.getTerminator());<span class="comment">//å¯¹switchå˜é‡è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">    LoadInst *swVar=new LoadInst(TYPE_I32,swVarPtr,<span class="string">&quot;swVAR&quot;</span>,dispatchBB);<span class="comment">//æ·»åŠ switchæŒ‡ä»¤</span></span><br><span class="line">    BasicBlock *defaultBB = BasicBlock::Create(*CONTEXT,<span class="string">&quot;defaultBB&quot;</span>,&amp;F,retBB);<span class="comment">//åˆ›å»ºä¸€ä¸ªè¿”å›å—å‰çš„åŸºæœ¬å—</span></span><br><span class="line">    BranchInst::Create(retBB,defaultBB);  <span class="comment">//åŸºæœ¬å—è‚¯å®šè¦æœ‰ä¸€æ¡ç»ˆç»“æŒ‡ä»¤ï¼Œæ‰€ä»¥è¿™é‡Œéšä¾¿æ·»åŠ ä¸€æ¡è·³è½¬æŒ‡ä»¤</span></span><br><span class="line">    SwitchInst *swInst=SwitchInst::Create(swVar,defaultBB,<span class="number">0</span>,dispatchBB);<span class="comment">//æ’å…¥åˆ°åˆ†å‘å—çš„åé¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ºæ¯ä¸ªåŸºæœ¬å—åˆ†é…éšæœºçš„caseå€¼</span></span><br><span class="line">    <span class="keyword">for</span>(BasicBlock *BB:origBB)&#123;</span><br><span class="line">        BB-&gt;moveBefore(retBB);<span class="comment">//ç§»åŠ¨åˆ°è¿”å›å—å‰é¢</span></span><br><span class="line">        swInst-&gt;addCase(CONST_I32(randNumcase),BB);<span class="comment">//ä¿å­˜éšæœºæ•°</span></span><br><span class="line">        randNumcase=rand();<span class="comment">//é‡æ–°ç”Ÿæˆéšæœºæ•°</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬å››æ­¥ å®ç°è°ƒåº¦å˜é‡è‡ªåŠ¨è°ƒæ•´</span></span><br><span class="line">    <span class="keyword">for</span>(BasicBlock *BB:origBB)&#123;</span><br><span class="line">        <span class="keyword">if</span>(BB-&gt;getTerminator()-&gt;getNumSuccessors()==<span class="number">0</span>)&#123;<span class="comment">//å¦‚æœè¿™ä¸ªåŸºæœ¬å—çš„æœ€åä¸€æ¡æŒ‡ä»¤æ˜¯è¿”å›æŒ‡ä»¤(æ²¡æœ‰åç»§å¿«)</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(BB-&gt;getTerminator()-&gt;getNumSuccessors()==<span class="number">1</span>)&#123;<span class="comment">//å¦‚æœè¿™ä¸ªåŸºæœ¬å—è¿˜æœ‰ä¸€ä¸ªåç»§å—(å³ä¸ºç»å¯¹è·³è½¬) </span></span><br><span class="line">            ConstantInt *numcase = swInst-&gt;findCaseDest(BB-&gt;getTerminator()-&gt;getSuccessor(<span class="number">0</span>));<span class="comment">//æ‰¾åˆ°å¯¹åº”çš„caseå€¼</span></span><br><span class="line">            new StoreInst(numcase,swVarPtr,BB-&gt;getTerminator());<span class="comment">//ä¿®æ”¹swicthä¸­çš„å‚æ•°ï¼Œä¿®æ”¹ä¸ºå¯¹åº”case</span></span><br><span class="line">            BB-&gt;getTerminator()-&gt;eraseFromParent();<span class="comment">//åŸå…ˆçš„è·³è½¬åˆ é™¤</span></span><br><span class="line">            BranchInst::Create(retBB,BB);<span class="comment">//æ·»åŠ è·³è½¬</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(BB-&gt;getTerminator()-&gt;getNumSuccessors()==<span class="number">2</span>)&#123; <span class="comment">//æœ‰ä¸¤ä¸ªåç»§å—</span></span><br><span class="line">             ConstantInt *numcase1 = swInst-&gt;findCaseDest(BB-&gt;getTerminator()-&gt;getSuccessor(<span class="number">0</span>));</span><br><span class="line">             ConstantInt *numcase2 = swInst-&gt;findCaseDest(BB-&gt;getTerminator()-&gt;getSuccessor(<span class="number">1</span>));<span class="comment">//å…¨æ‰¾äº†</span></span><br><span class="line">             BranchInst *br1=cast&lt;BranchInst&gt;(BB-&gt;getTerminator()); <span class="comment">//ä¸¤ä¸ªåˆ†æ”¯ä¹Ÿæœ‰å¯èƒ½æ˜¯switchæŒ‡ä»¤ï¼Œä½†æ˜¯åœ¨æ··æ·†å‰ï¼Œä½¿ç”¨LLVM IRæŒ‡ä»¤ (ä½¿ç”¨è‡ªå¸¦çš„ LowerSwitchçš„LLVM Pass)ï¼Œå°†switchæ›¿æ¢æˆäº†branchï¼Œæ‰€ä»¥è¿™é‡Œæœ€åä¸€æ¡æŒ‡ä»¤åªèƒ½æ˜¯branch</span></span><br><span class="line">             SelectInst *sel=SelectInst::Create(br1-&gt;getCondition(),numcase1,numcase2,<span class="string">&quot;&quot;</span>,BB-&gt;getTerminator());<span class="comment">//ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œæ‰¾åˆ°å¯¹åº”çš„case</span></span><br><span class="line">             new StoreInst(sel,swVarPtr,BB-&gt;getTerminator());<span class="comment">//ä¿å­˜åœ¨switchå˜é‡</span></span><br><span class="line">            BB-&gt;getTerminator()-&gt;eraseFromParent(); <span class="comment">//åŸå…ˆçš„è·³è½¬åˆ é™¤</span></span><br><span class="line">             BranchInst::Create(retBB,BB);<span class="comment">//æ·»åŠ </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬äº”æ­¥ ä¿®å¤ phiæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡</span></span><br><span class="line">    fixStack(F);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> Flattening::ID=<span class="number">0</span>;</span><br><span class="line"><span class="type">static</span> RegisterPass&lt;Flattening&gt;X(<span class="string">&quot;fla&quot;</span>,<span class="string">&quot;My control flow flattening obfuscation&quot;</span>);</span><br></pre></td></tr></table></figure><p>Utils.cpp</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;Utils.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Instructions.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Local.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/ValueMapper.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/Transforms/Utils/Cloning.h&quot;</span></span></span><br><span class="line">using <span class="built_in">std</span>::<span class="built_in">vector</span>;</span><br><span class="line">using namespace llvm;</span><br><span class="line">LLVMContext *CONTEXT=nullptr;</span><br><span class="line"><span class="comment">//ç¬¬äº”æ­¥ ä¿®å¤PHIæŒ‡ä»¤å’Œé€ƒé€¸å˜é‡</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">llvm::fixStack</span><span class="params">(Function &amp;F)</span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;PHINode*&gt; origPHI;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Instruction*&gt; origReg;</span><br><span class="line">    BasicBlock &amp;entryBB=F.getEntryBlock();</span><br><span class="line">    <span class="keyword">for</span>(BasicBlock &amp;BB:F)&#123;</span><br><span class="line">        <span class="keyword">for</span> (Instruction &amp;I:BB)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(PHINode *PN=dyn_cast&lt;PHINode&gt;(&amp;I))&#123;</span><br><span class="line">                origPHI.push_back(PN);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!(isa&lt;AllocaInst&gt;(&amp;I)&amp;&amp; I.getParent()==&amp;entryBB)&amp;&amp; I.isUsedOutsideOfBlock(&amp;BB))&#123;<span class="comment">//åˆ¤æ–­æ˜¯ä¸æ˜¯é€ƒé€¸å˜é‡(é™¤äº†é€šè¿‡Allocï¼Œå¹¶ä¸”å®šä¹‰åœ¨å…¥å£å—çš„ï¼Œéƒ½è¦å¤„ç†)</span></span><br><span class="line">                origReg.push_back(&amp;I);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(PHINode *PN:origPHI)&#123;</span><br><span class="line">        DemotePHIToStack(PN,entryBB.getTerminator());<span class="comment">//ä¿®å¤PHIæŒ‡ä»¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(Instruction *I:origReg)&#123;</span><br><span class="line">        DemoteRegToStack(*I,entryBB.getTerminator());<span class="comment">//ä¿®å¤é€ƒé€¸å˜é‡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Utils.h</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _UTILS_H_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _UTILS_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;llvm/IR/Function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INIT_CONTEXT(X) CONTEXT = &amp;X.getContext()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TYPE_I64 Type::getInt64Ty(*CONTEXT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TYPE_I32 Type::getInt32Ty(*CONTEXT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TYPE_I8 Type::getInt8Ty(*CONTEXT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GET_TYPE(X) TYPE::getInt(X) Ty(*CONTEXT)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONST_I64(V) ConstantInt::get(TYPE_I64, V, false)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONST_I32(V) ConstantInt::get(TYPE_I32, V, false)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONST_I8(V) ConstantInt::get(TYPE_I8, V, false)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CONST(T, V) ConstantInt::get(T, V)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RANDOM(X) (cryptoutils-&gt;get_uint8_t() % 100 &lt; X)</span></span><br><span class="line"><span class="keyword">extern</span> llvm::LLVMContext *CONTEXT;</span><br><span class="line"></span><br><span class="line">namespace llvm&#123;</span><br><span class="line">    <span class="type">void</span> <span class="title function_">fixStack</span><span class="params">(Function &amp;F)</span>;</span><br><span class="line">    BasicBlock* <span class="title function_">createCloneBasicBlock</span><span class="params">(BasicBlock *BB)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;OLLVM-æ§åˆ¶æµå¹³å¦åŒ–&quot;&gt;&lt;a href=&quot;#OLLVM-æ§åˆ¶æµå¹³å¦åŒ–&quot; class=&quot;headerlink&quot; title=&quot;OLLVM-æ§åˆ¶æµå¹³å¦åŒ–&quot;&gt;&lt;/a&gt;OLLVM-æ§åˆ¶æµå¹³å¦åŒ–&lt;/h1&gt;&lt;p&gt;å»ºè®®ç»“åˆä»£ç åçš„æ³¨é‡Šé£Ÿç”¨ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>llvm IRå¸¸ç”¨æŒ‡ä»¤äºŒ</title>
    <link href="https://straw-233.github.io/2024/02/29/llvm%20IR%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%BA%8C/"/>
    <id>https://straw-233.github.io/2024/02/29/llvm%20IR%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%BA%8C/</id>
    <published>2024-02-29T13:00:58.816Z</published>
    <updated>2024-02-29T13:02:59.516Z</updated>
    
    <content type="html"><![CDATA[<h1 id="llvm-IRå¸¸ç”¨æŒ‡ä»¤äºŒ"><a href="#llvm-IRå¸¸ç”¨æŒ‡ä»¤äºŒ" class="headerlink" title="llvm IRå¸¸ç”¨æŒ‡ä»¤äºŒ"></a>llvm IRå¸¸ç”¨æŒ‡ä»¤äºŒ</h1><h3 id="å†…å­˜è®¿é—®å’Œå¯»å€æ“ä½œ"><a href="#å†…å­˜è®¿é—®å’Œå¯»å€æ“ä½œ" class="headerlink" title="å†…å­˜è®¿é—®å’Œå¯»å€æ“ä½œ"></a>å†…å­˜è®¿é—®å’Œå¯»å€æ“ä½œ</h3><h4 id="allocaæŒ‡ä»¤"><a href="#allocaæŒ‡ä»¤" class="headerlink" title="allocaæŒ‡ä»¤"></a>allocaæŒ‡ä»¤</h4><p>&lt; result&gt;&#x3D;alloca &lt; type&gt; [,&lt; ty&gt; &lt; NumElements&gt;] [, align &lt; alignment&gt;];</p><p>åˆ†é…sizeof(type)*NumElementså­—èŠ‚çš„å†…å­˜ï¼Œåˆ†é…çš„åœ°å€ä¸alignmentå¯¹é½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%ptr = alloca i32                  ;åˆ†é…4å­—èŠ‚çš„å†…å­˜å¹¶è¿”å›i32ç±»å‹çš„æŒ‡é’ˆ</span><br><span class="line">%ptr = alloca i32,i32 4            ;åˆ†é…4*4å­—èŠ‚çš„å†…å­˜å¹¶è¿”å›i32ç±»å‹çš„æŒ‡é’ˆ</span><br><span class="line">%ptr = alloca i32,i32 4,align 1024 ;åˆ†é…4*4å­—èŠ‚çš„å†…å­˜å¹¶è¿”å›i32ç±»å‹çš„æŒ‡é’ˆï¼Œåˆ†é…åœ°å€ä¸1024å¯¹é½</span><br><span class="line">%ptr = alloca i32,align 1024       ;åˆ†é…4å­—èŠ‚çš„å†…å­˜å¹¶è¿”å›i32ç±»å‹çš„æŒ‡é’ˆï¼Œåˆ†é…åœ°å€ä¸1024å¯¹é½</span><br></pre></td></tr></table></figure><h4 id="storeæŒ‡ä»¤"><a href="#storeæŒ‡ä»¤" class="headerlink" title="storeæŒ‡ä»¤"></a>storeæŒ‡ä»¤</h4><p>store &lt; ty&gt; &lt; value&gt;,&lt; ty&gt;* &lt; pointer&gt;;å‘ç‰¹å®šç±»å‹æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å­˜å‚¨ç›¸åŒç±»å‹çš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%ptr = alloca i32</span><br><span class="line">store i32 3, i32* %ptr</span><br></pre></td></tr></table></figure><h4 id="loadæŒ‡ä»¤"><a href="#loadæŒ‡ä»¤" class="headerlink" title="loadæŒ‡ä»¤"></a>loadæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; load &lt; ty&gt;, &lt; ty&gt;* &lt; pointer&gt;;ä»ç‰¹å®šç±»å‹çš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ä¸­è¯»å–ç‰¹å®šç±»å‹çš„æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%ptr = alloca i32</span><br><span class="line">store i32 3, i32* %ptr</span><br><span class="line">%value = load i32,i32* %ptr</span><br></pre></td></tr></table></figure><h3 id="ç±»å‹è½¬æ¢æŒ‡ä»¤"><a href="#ç±»å‹è½¬æ¢æŒ‡ä»¤" class="headerlink" title="ç±»å‹è½¬æ¢æŒ‡ä»¤"></a>ç±»å‹è½¬æ¢æŒ‡ä»¤</h3><h4 id="trunc-toæŒ‡ä»¤"><a href="#trunc-toæŒ‡ä»¤" class="headerlink" title="trunc..toæŒ‡ä»¤"></a>trunc..toæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; trunc &lt; ty&gt; &lt; value&gt; to &lt; ty2&gt;;å°†tyç±»å‹å˜é‡æˆªæ–­ä¸ºty2ç±»å‹çš„å˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%X = trunc i32 257 to i8                      ;i8:1</span><br><span class="line">%Y = trunc i32 123 to i1                      ;i1:true</span><br><span class="line">%Z = trunc i32 122 to i1                      ;i1:false</span><br><span class="line">%W = trunc &lt;2 x i16&gt; &lt;i16 8,i16 7&gt;to&lt;2 x i8&gt;  ;&lt;i8 8,i8 7&gt;</span><br></pre></td></tr></table></figure><h4 id="zext-toæŒ‡ä»¤"><a href="#zext-toæŒ‡ä»¤" class="headerlink" title="zext..toæŒ‡ä»¤"></a>zext..toæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; zext &lt; ty&gt; &lt; value&gt; to &lt; ty2&gt;;å°†tyç±»å‹å˜é‡æ‹“å±•ä¸ºty2ç±»å‹çš„å˜é‡ï¼Œå¼ºåˆ¶è½¬æ¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%X = zext i32 257 to i64                       ;i64:257</span><br><span class="line">%Y = zext i1 true to i32                       ;i32:1</span><br><span class="line">%Z = zext &lt;2 x i16&gt; &lt;i16 8,i16 7&gt; to &lt;2 x i32&gt; ;&lt;i32 8,i32 7&gt;</span><br></pre></td></tr></table></figure><h4 id="sext-toæŒ‡ä»¤"><a href="#sext-toæŒ‡ä»¤" class="headerlink" title="sext..toæŒ‡ä»¤"></a>sext..toæŒ‡ä»¤</h4><p>&lt; result&gt;&#x3D; sext &lt; ty&gt; &lt; value&gt; to &lt; ty2&gt;;å°†tyç±»å‹å˜é‡æ‹“å±•ä¸ºty2ç±»å‹çš„å˜é‡ï¼Œå¤åˆ¶ç¬¦å·ä½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%X = sext i8 -1 to i64                         ;i64:-1</span><br><span class="line">%Y = sext i1 true to i32                       ;i32:-1</span><br><span class="line">%Z = sext &lt;2 x i16&gt; &lt;i16 8,i16 7&gt; to &lt;2 x i32&gt; ;&lt;i32 8,i32 7&gt;</span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–æ“ä½œ"><a href="#å…¶ä»–æ“ä½œ" class="headerlink" title="å…¶ä»–æ“ä½œ"></a>å…¶ä»–æ“ä½œ</h3><h4 id="phiæŒ‡ä»¤"><a href="#phiæŒ‡ä»¤" class="headerlink" title="phiæŒ‡ä»¤"></a>phiæŒ‡ä»¤</h4><p>ç”±é™æ€å•èµ‹å€¼å¼•èµ·çš„SSAé—®é¢˜ï¼Œå¼•å…¥phiå‡½æ•°è§£å†³</p><p><img src="/../img/llvm2.png" alt="llvm2"></p><p>&lt; result&gt; &#x3D; phi &lt; ty&gt; [ &lt; val0&gt;,&lt; label0&gt;], â€¦ ;å¦‚æœå‰é©±å¿«ä¸ºlabel0ï¼Œåˆ™result&#x3D;val0â€¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Loop:     ; Infinite loop that counts from 0 on up...</span><br><span class="line">%indvar = phi i32[ 0, %LoopHeader ],[ %nextindvar, %Loop ]</span><br><span class="line">%nextindvar = add i32 %indvar,1</span><br><span class="line">br label %Loop   ;phiæŒ‡ä»¤å®ç°forå¾ªç¯</span><br></pre></td></tr></table></figure><h4 id="selectæŒ‡ä»¤"><a href="#selectæŒ‡ä»¤" class="headerlink" title="selectæŒ‡ä»¤"></a>selectæŒ‡ä»¤</h4><p>ä¸‰å…ƒè¿ç®—ç¬¦</p><p>&lt; result&gt; &#x3D; select i1 &lt; cond&gt;,&lt; ty&gt; &lt; vall&gt;,&lt; ty&gt; &lt; val2&gt;; å¦‚æœæ¡ä»¶condæˆç«‹</p><p>result&#x3D;vall,å¦åˆ™ result&#x3D;val2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%X = select i1 true,i8 17,i8 42    ;i8:17</span><br><span class="line">%X = select i1 flase,i8 17,i8 42   ;i8:42</span><br></pre></td></tr></table></figure><h4 id="callæŒ‡ä»¤"><a href="#callæŒ‡ä»¤" class="headerlink" title="callæŒ‡ä»¤"></a>callæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; call &lt; ty&gt;|&lt; fnty&gt; &lt; fnptrval&gt;(&lt; function args&gt;); è°ƒç”¨å‡½æ•°,å¯ä»¥ä¼ é€’å‚æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%retval = call i32 @test(i32 %argc)                  ;è°ƒç”¨testå‡½æ•°ï¼Œå‚æ•°ä¸ºi32ç±»å‹ï¼Œè¿”å›å€¼ä¸ºi32ç±»å‹</span><br><span class="line">call i32 (i8*, ...)* @printf(i8* %msg, i32 12,i8 42) ;è°ƒç”¨printfå‡½æ•°ï¼Œå‚æ•°å¯å˜</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;llvm-IRå¸¸ç”¨æŒ‡ä»¤äºŒ&quot;&gt;&lt;a href=&quot;#llvm-IRå¸¸ç”¨æŒ‡ä»¤äºŒ&quot; class=&quot;headerlink&quot; title=&quot;llvm IRå¸¸ç”¨æŒ‡ä»¤äºŒ&quot;&gt;&lt;/a&gt;llvm IRå¸¸ç”¨æŒ‡ä»¤äºŒ&lt;/h1&gt;&lt;h3 id=&quot;å†…å­˜è®¿é—®å’Œå¯»å€æ“ä½œ&quot;&gt;&lt;a href=&quot;#å†…å­˜è®¿é—®</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>llvm IRå¸¸ç”¨æŒ‡ä»¤ä¸€</title>
    <link href="https://straw-233.github.io/2024/02/28/llvm%20IR%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%B8%80/"/>
    <id>https://straw-233.github.io/2024/02/28/llvm%20IR%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E4%B8%80/</id>
    <published>2024-02-28T13:26:52.873Z</published>
    <updated>2024-02-29T06:39:56.814Z</updated>
    
    <content type="html"><![CDATA[<h1 id="llvm-IRå¸¸ç”¨æŒ‡ä»¤ä¸€"><a href="#llvm-IRå¸¸ç”¨æŒ‡ä»¤ä¸€" class="headerlink" title="llvm IRå¸¸ç”¨æŒ‡ä»¤ä¸€"></a>llvm IRå¸¸ç”¨æŒ‡ä»¤ä¸€</h1><h3 id="ç»ˆç»“æŒ‡ä»¤"><a href="#ç»ˆç»“æŒ‡ä»¤" class="headerlink" title="ç»ˆç»“æŒ‡ä»¤"></a>ç»ˆç»“æŒ‡ä»¤</h3><h4 id="retæŒ‡ä»¤"><a href="#retæŒ‡ä»¤" class="headerlink" title="retæŒ‡ä»¤"></a>retæŒ‡ä»¤</h4><p>ret &lt; type&gt;  &lt; value&gt;;è¿”å›ç‰¹å®šç±»å‹è¿”å›å€¼çš„returnæŒ‡ä»¤</p><p>ret void;æ— è¿”å›å€¼çš„returnæŒ‡ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Test:</span><br><span class="line">ret i32 5;è¿”å›æ•´æ•°5</span><br><span class="line">ret void;è¿”å›æ— ç¬¦å·</span><br><span class="line">ret &#123; i32 , i8 &#125; &#123; i32 4 , i8 2 &#125;;è¿”å›ç»“æ„ä½“</span><br></pre></td></tr></table></figure><h4 id="bræŒ‡ä»¤"><a href="#bræŒ‡ä»¤" class="headerlink" title="bræŒ‡ä»¤"></a>bræŒ‡ä»¤</h4><p>br i1 &lt; cond&gt;,label &lt; iftrue&gt;,label &lt; iffalse&gt;;æœ‰æ¡ä»¶è·³è½¬</p><p>br label &lt; dest&gt;;æ— æ¡ä»¶åˆ†æ”¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Test:</span><br><span class="line">%cond = icmp eq i32 %al,%b</span><br><span class="line">br il %cond,label %IfEqual,label %IfUnequal</span><br><span class="line">IfEqual:</span><br><span class="line">ret i32 1</span><br><span class="line">IfUnequal:</span><br><span class="line">ret i32 0</span><br></pre></td></tr></table></figure><h4 id="icmpæŒ‡ä»¤"><a href="#icmpæŒ‡ä»¤" class="headerlink" title="icmpæŒ‡ä»¤"></a>icmpæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; icmp  &lt; cond&gt;  &lt; ty&gt;  &lt; op1&gt;  &lt; op2&gt;;æ¯”è¾ƒä¸¤ä¸ªtyç±»å‹çš„æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶cond</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Test:</span><br><span class="line">&lt;result&gt; = icmp eq i32 4,5      ;false eq=equal</span><br><span class="line">&lt;result&gt; = icmp ne float* %X %X ;false ne=not equal</span><br><span class="line">&lt;result&gt; = icmp ult i16 4, 5    ;true ult=unsigned less than</span><br><span class="line">&lt;result&gt; = icmp sgt i16 4, 5    ;false sgt=signed greater than</span><br><span class="line">&lt;result&gt; = icmp ule i16 -4, 5   ;false ule=unsigned less or equal</span><br><span class="line">&lt;result&gt; = icmp sge i16 4, 5    ;false sge=signed greater or equal</span><br></pre></td></tr></table></figure><h4 id="fcmpæŒ‡ä»¤"><a href="#fcmpæŒ‡ä»¤" class="headerlink" title="fcmpæŒ‡ä»¤"></a>fcmpæŒ‡ä»¤</h4><p>&lt; result&gt;&#x3D; fcmp &lt; cond&gt;  &lt; ty&gt;  &lt; op1&gt;  &lt; op2&gt;;æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶cond</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Test:</span><br><span class="line">&lt;result&gt; = fcmp oeq float 4.0,5.0   ;false oeq=order and equal</span><br><span class="line">&lt;result&gt; = fcmp one float 4.0,5.0   ;true </span><br><span class="line">&lt;result&gt; = fcmp olt float 4.0,5.0   ;true</span><br><span class="line">&lt;result&gt; = fcmp ueq double 1.0,2.0  ;false</span><br></pre></td></tr></table></figure><h4 id="switchæŒ‡ä»¤"><a href="#switchæŒ‡ä»¤" class="headerlink" title="switchæŒ‡ä»¤"></a>switchæŒ‡ä»¤</h4><p>switch &lt; intty&gt; &lt; value&gt;, label &lt; defaultdest&gt; [ &lt; intty&gt;  &lt; val&gt;,label  &lt; dest&gt;â€¦]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Test:</span><br><span class="line">%Val = zext i1 %value to i32</span><br><span class="line">switch i32 %Val,label %truedest[ i32 0,label %falsedest ];ä¸æ¡ä»¶è·³è½¬ç­‰æ•ˆ</span><br><span class="line">switch i32 0,label %dest[ ];ä¸éæ¡ä»¶è·³è½¬ç­‰æ•ˆ</span><br><span class="line">switch i32 %Val,label %otherwise [ i32 0, label %onzero</span><br><span class="line">                                   i32 1, label %onone</span><br><span class="line">                                   i32 2, label %ontwo];ä¸‰æ¡è·³è½¬</span><br></pre></td></tr></table></figure><h3 id="äºŒå…ƒè¿ç®—"><a href="#äºŒå…ƒè¿ç®—" class="headerlink" title="äºŒå…ƒè¿ç®—"></a>äºŒå…ƒè¿ç®—</h3><h4 id="addæŒ‡ä»¤"><a href="#addæŒ‡ä»¤" class="headerlink" title="addæŒ‡ä»¤"></a>addæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; add &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;result&gt;=add i32 4,%var;4+%var</span><br></pre></td></tr></table></figure><h4 id="subæŒ‡ä»¤"><a href="#subæŒ‡ä»¤" class="headerlink" title="subæŒ‡ä»¤"></a>subæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; sub &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;</p><h4 id="mulæŒ‡ä»¤"><a href="#mulæŒ‡ä»¤" class="headerlink" title="mulæŒ‡ä»¤"></a>mulæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; mul &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;</p><h4 id="udivæŒ‡ä»¤"><a href="#udivæŒ‡ä»¤" class="headerlink" title="udivæŒ‡ä»¤"></a>udivæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; udiv &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;;æ— ç¬¦å·æ•´é™¤</p><p>&lt; result&gt; &#x3D; udiv exact  &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;;å¦‚æœç»“æœä¸æ˜¯æ•´æ•°ä¼šæŠ¥é”™</p><h4 id="sdivæŒ‡ä»¤"><a href="#sdivæŒ‡ä»¤" class="headerlink" title="sdivæŒ‡ä»¤"></a>sdivæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; sdiv &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;;æœ‰ç¬¦å·æ•´é™¤</p><p>&lt; result&gt; &#x3D; sdiv exact  &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;;å¦‚æœç»“æœä¸æ˜¯æ•´æ•°ä¼šæŠ¥é”™</p><h4 id="uremæŒ‡ä»¤"><a href="#uremæŒ‡ä»¤" class="headerlink" title="uremæŒ‡ä»¤"></a>uremæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; urem &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ— ç¬¦å·å–ä½™</p><h4 id="sremæŒ‡ä»¤"><a href="#sremæŒ‡ä»¤" class="headerlink" title="sremæŒ‡ä»¤"></a>sremæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; srem &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æœ‰ ç¬¦å·å–ä½™</p><h3 id="æŒ‰ä½äºŒå…ƒè¿ç®—"><a href="#æŒ‰ä½äºŒå…ƒè¿ç®—" class="headerlink" title="æŒ‰ä½äºŒå…ƒè¿ç®—"></a>æŒ‰ä½äºŒå…ƒè¿ç®—</h3><h4 id="shlæŒ‡ä»¤"><a href="#shlæŒ‡ä»¤" class="headerlink" title="shlæŒ‡ä»¤"></a>shlæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; shl &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°å·¦ç§»op1&lt;&lt;op2</p><h4 id="lshræŒ‡ä»¤"><a href="#lshræŒ‡ä»¤" class="headerlink" title="lshræŒ‡ä»¤"></a>lshræŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; lshr &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°é€»è¾‘å³ç§»ï¼Œä¼šå˜ä¸ºæ— ç¬¦å·ç±»å‹</p><h4 id="ashræŒ‡ä»¤"><a href="#ashræŒ‡ä»¤" class="headerlink" title="ashræŒ‡ä»¤"></a>ashræŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; ashr &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°ç®—æ•°å³ç§»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Difference:</span><br><span class="line">&lt;result&gt;=lshr i8 -2,1  ;result=0x7F</span><br><span class="line">&lt;result&gt;=ashr i8 -2,1  ;result=-1</span><br></pre></td></tr></table></figure><h4 id="andæŒ‡ä»¤"><a href="#andæŒ‡ä»¤" class="headerlink" title="andæŒ‡ä»¤"></a>andæŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; and &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°æŒ‰ä½ä¸</p><h4 id="oræŒ‡ä»¤"><a href="#oræŒ‡ä»¤" class="headerlink" title="oræŒ‡ä»¤"></a>oræŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; or &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°æŒ‰ä½æˆ–</p><h4 id="xoræŒ‡ä»¤"><a href="#xoræŒ‡ä»¤" class="headerlink" title="xoræŒ‡ä»¤"></a>xoræŒ‡ä»¤</h4><p>&lt; result&gt; &#x3D; ashr &lt; ty&gt;  &lt; op1&gt;, &lt; op2&gt;ï¼›æ•´æ•°æŒ‰ä½å¼‚æˆ–</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;llvm-IRå¸¸ç”¨æŒ‡ä»¤ä¸€&quot;&gt;&lt;a href=&quot;#llvm-IRå¸¸ç”¨æŒ‡ä»¤ä¸€&quot; class=&quot;headerlink&quot; title=&quot;llvm IRå¸¸ç”¨æŒ‡ä»¤ä¸€&quot;&gt;&lt;/a&gt;llvm IRå¸¸ç”¨æŒ‡ä»¤ä¸€&lt;/h1&gt;&lt;h3 id=&quot;ç»ˆç»“æŒ‡ä»¤&quot;&gt;&lt;a href=&quot;#ç»ˆç»“æŒ‡ä»¤&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>javaå­¦ä¹ ï¼ˆ2ï¼‰</title>
    <link href="https://straw-233.github.io/2023/12/19/java%E5%AD%A6%E4%B9%A0%EF%BC%882%EF%BC%89/"/>
    <id>https://straw-233.github.io/2023/12/19/java%E5%AD%A6%E4%B9%A0%EF%BC%882%EF%BC%89/</id>
    <published>2023-12-19T13:19:08.557Z</published>
    <updated>2023-12-19T13:18:39.716Z</updated>
    
    <content type="html"><![CDATA[<h1 id="javaå­¦ä¹ ï¼ˆ2ï¼‰"><a href="#javaå­¦ä¹ ï¼ˆ2ï¼‰" class="headerlink" title="javaå­¦ä¹ ï¼ˆ2ï¼‰"></a>javaå­¦ä¹ ï¼ˆ2ï¼‰</h1><h5 id="å¤–ç½®ç±»"><a href="#å¤–ç½®ç±»" class="headerlink" title="å¤–ç½®ç±»"></a>å¤–ç½®ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> </span><br><span class="line">    &#123;</span><br><span class="line">    Student s=<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;straw&quot;</span>,<span class="number">20</span>);</span><br><span class="line">    System.out.println(s.getAge());</span><br><span class="line">    System.out.println(s.getName());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        System.out.println(age);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name,<span class="type">int</span> age)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">        <span class="built_in">this</span>.age=age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">20</span><br><span class="line">straw</span><br></pre></td></tr></table></figure><h5 id="å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="å­—ç¬¦ä¸²æ‹¼æ¥"></a>å­—ç¬¦ä¸²æ‹¼æ¥</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123; </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span>[] arr=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">        String str=arrToString(arr);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">arrToString</span><span class="params">(<span class="type">int</span>[] arr)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(arr==<span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(arr.length==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;[]&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String result= <span class="string">&quot;[&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length-<span class="number">1</span>; i++) </span><br><span class="line">        &#123;</span><br><span class="line">            result+=arr[i]+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        result=result+arr[arr.length-<span class="number">1</span>]+<span class="string">&quot;]&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1,2,3]</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;javaå­¦ä¹ ï¼ˆ2ï¼‰&quot;&gt;&lt;a href=&quot;#javaå­¦ä¹ ï¼ˆ2ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;javaå­¦ä¹ ï¼ˆ2ï¼‰&quot;&gt;&lt;/a&gt;javaå­¦ä¹ ï¼ˆ2ï¼‰&lt;/h1&gt;&lt;h5 id=&quot;å¤–ç½®ç±»&quot;&gt;&lt;a href=&quot;#å¤–ç½®ç±»&quot; class=&quot;headerlink</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>javaå­¦ä¹ ï¼ˆ1ï¼‰</title>
    <link href="https://straw-233.github.io/2023/12/07/java%E5%AD%A6%E4%B9%A0%EF%BC%881%EF%BC%89/"/>
    <id>https://straw-233.github.io/2023/12/07/java%E5%AD%A6%E4%B9%A0%EF%BC%881%EF%BC%89/</id>
    <published>2023-12-07T12:56:00.738Z</published>
    <updated>2023-12-07T13:07:44.640Z</updated>
    
    <content type="html"><![CDATA[<h1 id="javaå­¦ä¹ ï¼ˆ1ï¼‰"><a href="#javaå­¦ä¹ ï¼ˆ1ï¼‰" class="headerlink" title="javaå­¦ä¹ ï¼ˆ1ï¼‰"></a>javaå­¦ä¹ ï¼ˆ1ï¼‰</h1><h3 id="éšæœºæ•°"><a href="#éšæœºæ•°" class="headerlink" title="éšæœºæ•°"></a>éšæœºæ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Root1</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] arr=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">        Random r=<span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt; arr.length ;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> index=r.nextInt(arr.length);</span><br><span class="line">            <span class="type">int</span> temp= arr[i];</span><br><span class="line">            arr[i]=arr[index];</span><br><span class="line">            arr[index]=temp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;arr.length;i++)</span><br><span class="line">        &#123;</span><br><span class="line">           System.out.print(arr[i]+<span class="string">&quot; &quot;</span>); </span><br><span class="line">        &#125;        </span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 3 5 2 4//éšæœº</span><br></pre></td></tr></table></figure><h3 id="scanfè¯»å…¥-æ–¹æ³•"><a href="#scanfè¯»å…¥-æ–¹æ³•" class="headerlink" title="scanfè¯»å…¥+æ–¹æ³•"></a>scanfè¯»å…¥+æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Root2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(getSum1(<span class="number">1</span>, <span class="number">2</span>));</span><br><span class="line">        Scanner sc=<span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">int</span> put=sc.nextInt();</span><br><span class="line">        System.out.println(put);</span><br><span class="line">        sc.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getSum</span><span class="params">(<span class="type">int</span> num1,<span class="type">int</span> num2)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> result=num1+num2;</span><br><span class="line">        System.out.println(result);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getSum1</span><span class="params">(<span class="type">int</span> num1,<span class="type">int</span> num2)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> result=num1+num2;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">114514</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">114514</span><br></pre></td></tr></table></figure><h3 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Root3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Girlfriend gf1=<span class="keyword">new</span> <span class="title class_">Girlfriend</span>();</span><br><span class="line">        gf1.name=<span class="string">&quot;ç¥é‡Œç»«å&quot;</span>;</span><br><span class="line">        gf1.age=<span class="number">21</span>;</span><br><span class="line">        gf1.gender=<span class="string">&quot;ç¥é‡Œå®¶çš„å¤§å°å§&quot;</span>;</span><br><span class="line">        System.out.println(gf1.name+<span class="string">&quot; &quot;</span>+gf1.age+<span class="string">&quot; &quot;</span>+gf1.gender);</span><br><span class="line">        gf1.eat();</span><br><span class="line">        gf1.sleep();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Girlfriend</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    String gender;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥³æœ‹å‹åœ¨ç¡è§‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥³æœ‹å‹åœ¨åƒé¥­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¥é‡Œç»«å 21 ç¥é‡Œå®¶çš„å¤§å°å§</span><br><span class="line">å¥³æœ‹å‹åœ¨åƒé¥­</span><br><span class="line">å¥³æœ‹å‹åœ¨ç¡è§‰</span><br></pre></td></tr></table></figure><p><img src="/../img/%E7%8E%A9%E5%8E%9F%E7%A5%9E.jpg" alt="ç©åŸç¥"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;javaå­¦ä¹ ï¼ˆ1ï¼‰&quot;&gt;&lt;a href=&quot;#javaå­¦ä¹ ï¼ˆ1ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;javaå­¦ä¹ ï¼ˆ1ï¼‰&quot;&gt;&lt;/a&gt;javaå­¦ä¹ ï¼ˆ1ï¼‰&lt;/h1&gt;&lt;h3 id=&quot;éšæœºæ•°&quot;&gt;&lt;a href=&quot;#éšæœºæ•°&quot; class=&quot;headerlink</summary>
      
    
    
    
    
  </entry>
  
</feed>
